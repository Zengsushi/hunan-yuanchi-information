{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, reactive, computed, watch, nextTick, onMounted } from 'vue';\nimport { message } from 'ant-design-vue';\nimport dayjs from 'dayjs';\nimport { hardwareAssetApi } from '@/api/hardwareAsset';\nimport { supplierApi } from '@/api/supplier';\nimport { userApi } from '@/api/user';\n// 移除了大量不必要的图标导入\n\n// Props\n\nexport default {\n  __name: 'SoftwareAssetForm',\n  props: {\n    visible: {\n      type: Boolean,\n      default: false\n    },\n    assetData: {\n      type: Object,\n      default: null\n    },\n    isEdit: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: ['update:visible', 'success'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n\n    // Emits\n    const emit = __emit;\n\n    // 响应式数据\n    const formRef = ref();\n    const submitLoading = ref(false);\n    const userLoading = ref(false);\n    const supplierLoading = ref(false);\n    const supplierOptions = ref([]);\n    const supplierContacts = ref([]);\n    const specifications = ref([{\n      key: '',\n      value: ''\n    }]);\n\n    // 表单数据\n    const formData = reactive({\n      asset_tag: '',\n      model: '',\n      asset_owner: '',\n      project_source: '',\n      purchase_date: '',\n      manufacturer: '',\n      specification_parameter: '',\n      serial_number: '',\n      warranty_type: '',\n      warranty_date_range: null\n    });\n\n    // 选项数据\n    const projectSource = ref([{\n      label: '内部项目',\n      value: 'internal'\n    }, {\n      label: '外部项目',\n      value: 'external'\n    }, {\n      label: '研发项目',\n      value: 'research'\n    }, {\n      label: '其他',\n      value: 'other'\n    }]);\n\n    // 资产责任人选项\n    const userOptions = ref([{\n      id: 1,\n      label: '张三',\n      value: 'zhangsan'\n    }, {\n      id: 2,\n      label: '李四',\n      value: 'lisi'\n    }, {\n      id: 3,\n      label: '王五',\n      value: 'wangwu'\n    }, {\n      id: 4,\n      label: '赵六',\n      value: 'zhaoliu'\n    }]);\n\n    // 供应商责任人选项\n    const supplierManagerOptions = ref([]);\n\n    // 供应商机构名变化处理\n    const onSupplierOrgChange = value => {\n      formData.value.supplier_manager = '';\n      // 根据供应商机构名获取对应的责任人列表\n      if (value === '华为技术有限公司') {\n        supplierManagerOptions.value = [{\n          label: '华为-张经理',\n          value: 'huawei-zhang'\n        }, {\n          label: '华为-李经理',\n          value: 'huawei-li'\n        }];\n      } else if (value === '浪潮集团有限公司') {\n        supplierManagerOptions.value = [{\n          label: '浪潮-王经理',\n          value: 'inspur-wang'\n        }, {\n          label: '浪潮-赵经理',\n          value: 'inspur-zhao'\n        }];\n      } else {\n        supplierManagerOptions.value = [];\n      }\n    };\n    const assetStatusOptions = ref([{\n      label: '在用',\n      value: 'in_use'\n    }, {\n      label: '报废',\n      value: 'scrapped'\n    }]);\n\n    // 计算属性\n    const dialogVisible = computed({\n      get: () => props.visible,\n      set: value => emit('update:visible', value)\n    });\n    const formTitle = computed(() => {\n      return props.isEdit ? '编辑硬件设施' : '新增硬件设施';\n    });\n\n    // 移除了不必要的副标题计算属性\n\n    const supplierContactOptions = computed(() => {\n      return supplierContacts.value.map(contact => ({\n        label: contact.name,\n        value: contact.name\n      }));\n    });\n\n    // 表单验证状态\n    const isFormValid = computed(() => {\n      return formData.asset_tag && formData.model && formData.manufacturer && formData.serial_number && formData.asset_owner && formData.purchase_date;\n    });\n\n    // 表单验证规则\n    const formRules = {\n      asset_tag: [{\n        required: true,\n        message: '请输入资产编号',\n        trigger: 'blur'\n      }, {\n        min: 2,\n        max: 50,\n        message: '资产编号长度在 2 到 50 个字符',\n        trigger: 'blur'\n      }],\n      model: [{\n        required: true,\n        message: '请输入设备型号',\n        trigger: 'blur'\n      }, {\n        min: 2,\n        max: 100,\n        message: '设备型号长度在 2 到 100 个字符',\n        trigger: 'blur'\n      }],\n      manufacturer: [{\n        required: true,\n        message: '请选择制造商',\n        trigger: 'change'\n      }],\n      serial_number: [{\n        required: true,\n        message: '请输入序列号',\n        trigger: 'blur'\n      }, {\n        min: 2,\n        max: 100,\n        message: '序列号长度在 2 到 100 个字符',\n        trigger: 'blur'\n      }],\n      asset_owner: [{\n        required: true,\n        message: '请选择资产责任人',\n        trigger: 'change'\n      }],\n      purchase_date: [{\n        required: true,\n        message: '请选择采购日期',\n        trigger: 'change'\n      }],\n      warranty_type: [{\n        required: true,\n        message: '请选择保修类型',\n        trigger: 'change'\n      }],\n      warranty_date_range: [{\n        required: true,\n        message: '请选择保修日期',\n        trigger: 'change'\n      }]\n    };\n\n    // 方法\n    const resetForm = () => {\n      Object.keys(formData).forEach(key => {\n        if (key === 'monitoring_status') {\n          formData[key] = false;\n        } else if (key === 'warranty_type') {\n          formData[key] = 'original';\n        } else if (key === 'asset_status') {\n          formData[key] = 'in_use';\n        } else if (key === 'warranty_date_range') {\n          formData[key] = [];\n        } else {\n          formData[key] = '';\n        }\n      });\n      specifications.value = [{\n        key: '',\n        value: ''\n      }];\n      formRef.value?.resetFields();\n    };\n    const loadFormData = () => {\n      if (props.assetData && props.isEdit) {\n        Object.keys(formData).forEach(key => {\n          if (props.assetData[key] !== undefined) {\n            formData[key] = props.assetData[key];\n          }\n        });\n\n        // 处理规格参数\n        if (props.assetData.specifications && typeof props.assetData.specifications === 'object') {\n          const specs = Object.entries(props.assetData.specifications).map(([key, value]) => ({\n            key,\n            value\n          }));\n          specifications.value = specs.length > 0 ? specs : [{\n            key: '',\n            value: ''\n          }];\n        }\n      }\n    };\n    const loadUsers = async () => {\n      if (userOptions.value.length > 0) return;\n      userLoading.value = true;\n      try {\n        const response = await userApi.search({\n          page_size: 100\n        });\n        userOptions.value = response.data.results || [];\n      } catch (error) {\n        console.error('Load users error:', error);\n        message.error('加载用户列表失败');\n      } finally {\n        userLoading.value = false;\n      }\n    };\n    const searchUsers = async query => {\n      if (!query) return;\n      userLoading.value = true;\n      try {\n        const response = await userApi.search({\n          search: query,\n          page_size: 50\n        });\n        userOptions.value = response.data.results || [];\n      } catch (error) {\n        console.error('Search users error:', error);\n        message.error('搜索用户失败');\n      } finally {\n        userLoading.value = false;\n      }\n    };\n    const loadSuppliers = async () => {\n      if (supplierOptions.value.length > 0) return;\n      supplierLoading.value = true;\n      try {\n        const response = await supplierApi.getSimpleList({\n          page_size: 100\n        });\n        supplierOptions.value = response.data || [];\n      } catch (error) {\n        console.error('Load suppliers error:', error);\n        message.error('加载供应商列表失败');\n      } finally {\n        supplierLoading.value = false;\n      }\n    };\n    const searchSuppliers = async query => {\n      supplierLoading.value = true;\n      try {\n        const params = query ? {\n          search: query,\n          page_size: 50\n        } : {\n          page_size: 100\n        };\n        const response = await supplierApi.getSimpleList(params);\n        supplierOptions.value = response.data || [];\n      } catch (error) {\n        console.error('Search suppliers error:', error);\n        message.error('搜索供应商失败');\n      } finally {\n        supplierLoading.value = false;\n      }\n    };\n    const handleSupplierChange = async supplierId => {\n      supplierContacts.value = [];\n      if (!supplierId) return;\n      try {\n        const response = await supplierApi.getContacts(supplierId);\n        supplierContacts.value = response.data || [];\n      } catch (error) {\n        console.error('Get supplier contacts error:', error);\n        message.error('获取供应商联系人失败');\n      }\n    };\n    const addSpec = () => {\n      specifications.value.push({\n        key: '',\n        value: ''\n      });\n    };\n    const removeSpec = index => {\n      if (specifications.value.length > 1) {\n        specifications.value.splice(index, 1);\n      }\n    };\n    const filterOption = (input, option) => {\n      return option.label.toLowerCase().includes(input.toLowerCase());\n    };\n    const disabledDate = current => {\n      // 禁用未来日期\n      return current && current > dayjs().endOf('day');\n    };\n    const validateSpecifications = () => {\n      // 新增模式下不需要验证规格参数\n      if (!props.isEdit) {\n        return true;\n      }\n      const validSpecs = specifications.value.filter(spec => spec.key && spec.value);\n      if (validSpecs.length === 0) {\n        message.warning('请至少添加一个有效的规格参数');\n        return false;\n      }\n      return true;\n    };\n    const handleSubmit = async () => {\n      try {\n        await formRef.value.validate();\n        if (!validateSpecifications()) {\n          return;\n        }\n        submitLoading.value = true;\n\n        // 显示加载提示\n        const loadingMessage = message.loading(props.isEdit ? '正在更新设备信息...' : '正在创建设备...', 0);\n\n        // 处理规格参数（仅在编辑模式下）\n        const submitData = {\n          ...formData\n        };\n        if (props.isEdit) {\n          const specs = {};\n          specifications.value.forEach(spec => {\n            if (spec.key && spec.value) {\n              specs[spec.key] = spec.value;\n            }\n          });\n          submitData.specifications = specs;\n        }\n        if (props.isEdit && props.assetData?.id) {\n          await hardwareAssetApi.update(props.assetData.id, submitData);\n          loadingMessage();\n          message.success('设备信息更新成功！');\n        } else {\n          await hardwareAssetApi.create(submitData);\n          loadingMessage();\n          message.success('设备创建成功！');\n        }\n        emit('success');\n        handleClose();\n      } catch (error) {\n        console.error('Submit error:', error);\n\n        // 详细的错误处理\n        let errorMessage = '操作失败，请重试';\n        if (error.response) {\n          const {\n            status,\n            data\n          } = error.response;\n          if (status === 400) {\n            if (data && typeof data === 'object') {\n              const errorMessages = [];\n              Object.entries(data).forEach(([field, messages]) => {\n                if (Array.isArray(messages)) {\n                  errorMessages.push(...messages);\n                } else {\n                  errorMessages.push(messages);\n                }\n              });\n              errorMessage = errorMessages.join(', ') || '请检查输入的数据格式';\n            } else {\n              errorMessage = data?.message || '请检查输入的数据格式';\n            }\n          } else if (status === 409) {\n            errorMessage = '资产编号或序列号已存在，请使用其他值';\n          } else if (status === 500) {\n            errorMessage = '服务器内部错误，请稍后重试';\n          }\n        } else if (error.message) {\n          errorMessage = error.message;\n        }\n        message.error(errorMessage);\n      } finally {\n        submitLoading.value = false;\n      }\n    };\n    const handleSubmitFailed = errorInfo => {\n      console.log('Form validation failed:', errorInfo);\n      message.error('请检查表单填写是否正确');\n    };\n    const handleClose = () => {\n      dialogVisible.value = false;\n      nextTick(() => {\n        resetForm();\n      });\n    };\n\n    // 监听器\n    watch(() => props.visible, newVal => {\n      if (newVal) {\n        nextTick(() => {\n          if (props.isEdit) {\n            loadFormData();\n          } else {\n            resetForm();\n          }\n        });\n      }\n    });\n\n    // 生命周期\n    onMounted(() => {\n      loadUsers();\n      loadSuppliers();\n    });\n    const __returned__ = {\n      props,\n      emit,\n      formRef,\n      submitLoading,\n      userLoading,\n      supplierLoading,\n      supplierOptions,\n      supplierContacts,\n      specifications,\n      formData,\n      projectSource,\n      userOptions,\n      supplierManagerOptions,\n      onSupplierOrgChange,\n      assetStatusOptions,\n      dialogVisible,\n      formTitle,\n      supplierContactOptions,\n      isFormValid,\n      formRules,\n      resetForm,\n      loadFormData,\n      loadUsers,\n      searchUsers,\n      loadSuppliers,\n      searchSuppliers,\n      handleSupplierChange,\n      addSpec,\n      removeSpec,\n      filterOption,\n      disabledDate,\n      validateSpecifications,\n      handleSubmit,\n      handleSubmitFailed,\n      handleClose,\n      ref,\n      reactive,\n      computed,\n      watch,\n      nextTick,\n      onMounted,\n      get message() {\n        return message;\n      },\n      get dayjs() {\n        return dayjs;\n      },\n      get hardwareAssetApi() {\n        return hardwareAssetApi;\n      },\n      get supplierApi() {\n        return supplierApi;\n      },\n      get userApi() {\n        return userApi;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","computed","watch","nextTick","onMounted","message","dayjs","hardwareAssetApi","supplierApi","userApi","props","__props","emit","__emit","formRef","submitLoading","userLoading","supplierLoading","supplierOptions","supplierContacts","specifications","key","value","formData","asset_tag","model","asset_owner","project_source","purchase_date","manufacturer","specification_parameter","serial_number","warranty_type","warranty_date_range","projectSource","label","userOptions","id","supplierManagerOptions","onSupplierOrgChange","supplier_manager","assetStatusOptions","dialogVisible","get","visible","set","formTitle","isEdit","supplierContactOptions","map","contact","name","isFormValid","formRules","required","trigger","min","max","resetForm","Object","keys","forEach","resetFields","loadFormData","assetData","undefined","specs","entries","length","loadUsers","response","search","page_size","data","results","error","console","searchUsers","query","loadSuppliers","getSimpleList","searchSuppliers","params","handleSupplierChange","supplierId","getContacts","addSpec","push","removeSpec","index","splice","filterOption","input","option","toLowerCase","includes","disabledDate","current","endOf","validateSpecifications","validSpecs","filter","spec","warning","handleSubmit","validate","loadingMessage","loading","submitData","update","success","create","handleClose","errorMessage","status","errorMessages","field","messages","Array","isArray","join","handleSubmitFailed","errorInfo","log","newVal"],"sources":["E:/A_project/yuanchi/AIops/frontend/src/components/business/SoftwareAssetForm.vue"],"sourcesContent":["<template>\r\n  <a-drawer\r\n    v-model:open=\"dialogVisible\"\r\n    :title=\"formTitle\"\r\n    width=\"800px\"\r\n    placement=\"right\"\r\n    :closable=\"true\"\r\n    :mask-closable=\"false\"\r\n    @close=\"handleClose\"\r\n  >\r\n    \r\n    <a-form\r\n      ref=\"formRef\"\r\n      :model=\"formData\"\r\n      :rules=\"formRules\"\r\n      :label-col=\"{ span: 6 }\"\r\n      :wrapper-col=\"{ span: 18 }\"\r\n      @finish=\"handleSubmit\"\r\n      @finishFailed=\"handleSubmitFailed\"\r\n    >\r\n      <!-- 基本信息 -->\r\n      <div class=\"form-section basic-info\">\r\n        <h4 class=\"section-title\">基本信息</h4>\r\n          \r\n          <a-row :gutter=\"16\">\r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"资产标签\" name=\"asset_tag\" class=\"form-item\" :label-col=\"{ span: 6 }\" :wrapper-col=\"{ span: 18 }\">\r\n                <a-input\r\n                  v-model:value=\"formData.asset_tag\"\r\n                  placeholder=\"请输入资产标签\"\r\n                  :maxlength=\"50\"\r\n                  show-count\r\n                />\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"型号\" name=\"model\" class=\"form-item\">\r\n                <a-input \r\n                  v-model:value=\"formData.model\" \r\n                  placeholder=\"请输入设施型号\"\r\n                  :maxlength=\"100\"\r\n                  show-count\r\n                />\r\n              </a-form-item>\r\n            </a-col>\r\n          </a-row>\r\n          \r\n          <a-row :gutter=\"16\">\r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"资产责任人\" name=\"asset_owner\" class=\"form-item\">\r\n                <a-select\r\n                  v-model:value=\"formData.asset_owner\"\r\n                  placeholder=\"请选择资产责任人\"\r\n                  show-search\r\n                  :filter-option=\"false\"\r\n                  :loading=\"userLoading\"\r\n                  @search=\"searchUsers\"\r\n                  @focus=\"loadUsers\"\r\n                >\r\n                  <a-select-option\r\n                    v-for=\"user in userOptions\"\r\n                    :key=\"user.id\"\r\n                    :value=\"user.value\"\r\n                    :label=\"user.label\"\r\n                  >\r\n                    {{ user.label }}\r\n                  </a-select-option>\r\n                </a-select>\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"项目来源\" name=\"asset_owner\" class=\"form-item\">\r\n                <a-select\r\n                  v-model:value=\"formData.projectSource\"\r\n                  placeholder=\"请选择项目来源\"\r\n                  show-search\r\n                  :filter-option=\"false\"\r\n                  :loading=\"userLoading\"\r\n                  @search=\"searchUsers\"\r\n                  @focus=\"loadUsers\"\r\n                >\r\n                  <a-select-option\r\n                    v-for=\"user in projectSource\"\r\n                    :key=\"user.id\"\r\n                    :value=\"user.value\"\r\n                    :label=\"user.label\"\r\n                  >\r\n                    {{ user.label }}\r\n                  </a-select-option>\r\n                </a-select>\r\n              </a-form-item>\r\n            </a-col>\r\n          </a-row>\r\n          \r\n          <a-row :gutter=\"16\">\r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"采购日期\" name=\"purchase_date\" class=\"form-item\">\r\n                <a-date-picker\r\n                  v-model:value=\"formData.purchase_date\"\r\n                  placeholder=\"请选择采购日期\"\r\n                  format=\"YYYY-MM-DD\"\r\n                  value-format=\"YYYY-MM-DD\"\r\n                  :disabled-date=\"disabledDate\"\r\n                  style=\"width: 100%\"\r\n                />\r\n              </a-form-item>\r\n            </a-col>\r\n\r\n          </a-row>\r\n        \r\n        </div>\r\n        \r\n      <!-- 产品信息 -->\r\n      <div class=\"form-section product-info\">\r\n        <h4 class=\"section-title\">产品信息</h4>\r\n          \r\n          <a-row :gutter=\"24\">            \r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"制造商\" name=\"serial_number\" class=\"form-item\">\r\n                <a-input \r\n                  v-model:value=\"formData.serial_number\" \r\n                  placeholder=\"请选择制造商\"\r\n                />\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"规格参数\" name=\"serial_number\" class=\"form-item\">\r\n                <a-input \r\n                  v-model:value=\"formData.serial_number\" \r\n                  placeholder=\"请输入规格参数\"\r\n                />\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"序列号\" name=\"serial_number\" class=\"form-item\">\r\n                <a-input \r\n                  v-model:value=\"formData.serial_number\" \r\n                  placeholder=\"请输入序列号\"\r\n                  :maxlength=\"100\"\r\n                  show-count\r\n                />\r\n              </a-form-item>\r\n            </a-col>\r\n\r\n            <a-col :span=\"12\">\r\n              <a-form-item label=\"保修类型\" name=\"serial_number\" class=\"form-item\">\r\n                <a-input \r\n                  v-model:value=\"formData.serial_number\" \r\n                  placeholder=\"请输入规格参数\"\r\n                />\r\n              </a-form-item>\r\n            </a-col>\r\n\r\n            <a-col :span=\"24\">\r\n              <a-form-item label=\"保修日期\" name=\"warranty_date_range\" class=\"form-item\" :label-col=\"{ span: 3 }\" :wrapper-col=\"{ span: 21 }\">\r\n                <a-range-picker\r\n                  v-model:value=\"formData.warranty_date_range\"\r\n                  :placeholder=\"['开始日期', '结束日期']\"\r\n                  format=\"YYYY-MM-DD\"\r\n                  value-format=\"YYYY-MM-DD\"\r\n                  style=\"width: 100%\"\r\n                />\r\n              </a-form-item>\r\n            </a-col>\r\n          </a-row>\r\n        </div>\r\n    </a-form>\r\n    \r\n    <!-- 底部按钮 -->\r\n    <template #footer>\r\n      <div class=\"dialog-footer\">\r\n        <a-button @click=\"handleClose\" :disabled=\"submitLoading\">取消</a-button>\r\n        <a-button \r\n          type=\"primary\" \r\n          @click=\"handleSubmit\" \r\n          :loading=\"submitLoading\"\r\n          :disabled=\"!isFormValid\"\r\n        >\r\n          {{ isEdit ? '更新设备' : '新增设备' }}\r\n        </a-button>\r\n      </div>\r\n    </template>\r\n  </a-drawer>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, watch, nextTick, onMounted } from 'vue'\r\nimport { message } from 'ant-design-vue'\r\nimport dayjs from 'dayjs'\r\nimport { hardwareAssetApi } from '@/api/hardwareAsset'\r\nimport { supplierApi } from '@/api/supplier'\r\nimport { userApi } from '@/api/user'\r\n// 移除了大量不必要的图标导入\r\n\r\n// Props\r\nconst props = defineProps({\r\n  visible: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  assetData: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  isEdit: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\n// Emits\r\nconst emit = defineEmits(['update:visible', 'success'])\r\n\r\n// 响应式数据\r\nconst formRef = ref()\r\nconst submitLoading = ref(false)\r\nconst userLoading = ref(false)\r\nconst supplierLoading = ref(false)\r\nconst supplierOptions = ref([])\r\nconst supplierContacts = ref([])\r\nconst specifications = ref([{ key: '', value: '' }])\r\n\r\n// 表单数据\r\nconst formData = reactive({\r\n  asset_tag: '',\r\n  model: '',\r\n  asset_owner: '',\r\n  project_source: '',\r\n  purchase_date: '',\r\n  manufacturer: '',\r\n  specification_parameter: '',\r\n  serial_number: '',\r\n  warranty_type: '',\r\n  warranty_date_range: null\r\n})\r\n\r\n// 选项数据\r\nconst projectSource = ref([\r\n  { label: '内部项目', value: 'internal' },\r\n  { label: '外部项目', value: 'external' },\r\n  { label: '研发项目', value: 'research' },\r\n  { label: '其他', value: 'other' }\r\n])\r\n \r\n // 资产责任人选项\r\n const userOptions = ref([\r\n   { id:1,label: '张三', value: 'zhangsan' },\r\n   { id:2,label: '李四', value: 'lisi' },\r\n   { id:3,label: '王五', value: 'wangwu' },\r\n   { id:4,label: '赵六', value: 'zhaoliu' }\r\n ])\r\n \r\n // 供应商责任人选项\r\n const supplierManagerOptions = ref([])\r\n \r\n // 供应商机构名变化处理\r\n const onSupplierOrgChange = (value) => {\r\n   formData.value.supplier_manager = ''\r\n   // 根据供应商机构名获取对应的责任人列表\r\n   if (value === '华为技术有限公司') {\r\n     supplierManagerOptions.value = [\r\n       { label: '华为-张经理', value: 'huawei-zhang' },\r\n       { label: '华为-李经理', value: 'huawei-li' }\r\n     ]\r\n   } else if (value === '浪潮集团有限公司') {\r\n     supplierManagerOptions.value = [\r\n       { label: '浪潮-王经理', value: 'inspur-wang' },\r\n       { label: '浪潮-赵经理', value: 'inspur-zhao' }\r\n     ]\r\n   } else {\r\n     supplierManagerOptions.value = []\r\n   }\r\n }\r\n\r\nconst assetStatusOptions = ref([\r\n  { label: '在用', value: 'in_use' },\r\n  { label: '报废', value: 'scrapped' }\r\n])\r\n\r\n// 计算属性\r\nconst dialogVisible = computed({\r\n  get: () => props.visible,\r\n  set: (value) => emit('update:visible', value)\r\n})\r\n\r\nconst formTitle = computed(() => {\r\n  return props.isEdit ? '编辑硬件设施' : '新增硬件设施'\r\n})\r\n\r\n// 移除了不必要的副标题计算属性\r\n\r\nconst supplierContactOptions = computed(() => {\r\n  return supplierContacts.value.map(contact => ({\r\n    label: contact.name,\r\n    value: contact.name\r\n  }))\r\n})\r\n\r\n// 表单验证状态\r\nconst isFormValid = computed(() => {\r\n  return formData.asset_tag && \r\n         formData.model && \r\n         formData.manufacturer && \r\n         formData.serial_number &&\r\n         formData.asset_owner &&\r\n         formData.purchase_date\r\n})\r\n\r\n// 表单验证规则\r\nconst formRules = {\r\n  asset_tag: [\r\n    { required: true, message: '请输入资产编号', trigger: 'blur' },\r\n    { min: 2, max: 50, message: '资产编号长度在 2 到 50 个字符', trigger: 'blur' }\r\n  ],\r\n  model: [\r\n    { required: true, message: '请输入设备型号', trigger: 'blur' },\r\n    { min: 2, max: 100, message: '设备型号长度在 2 到 100 个字符', trigger: 'blur' }\r\n  ],\r\n  manufacturer: [\r\n    { required: true, message: '请选择制造商', trigger: 'change' }\r\n  ],\r\n  serial_number: [\r\n    { required: true, message: '请输入序列号', trigger: 'blur' },\r\n    { min: 2, max: 100, message: '序列号长度在 2 到 100 个字符', trigger: 'blur' }\r\n  ],\r\n  asset_owner: [\r\n    { required: true, message: '请选择资产责任人', trigger: 'change' }\r\n  ],\r\n  purchase_date: [\r\n    { required: true, message: '请选择采购日期', trigger: 'change' }\r\n  ],\r\n  warranty_type: [\r\n    { required: true, message: '请选择保修类型', trigger: 'change' }\r\n  ],\r\n  warranty_date_range: [\r\n    { required: true, message: '请选择保修日期', trigger: 'change' }\r\n  ]\r\n}\r\n\r\n// 方法\r\nconst resetForm = () => {\r\n  Object.keys(formData).forEach(key => {\r\n    if (key === 'monitoring_status') {\r\n      formData[key] = false\r\n    } else if (key === 'warranty_type') {\r\n      formData[key] = 'original'\r\n    } else if (key === 'asset_status') {\r\n      formData[key] = 'in_use'\r\n    } else if (key === 'warranty_date_range') {\r\n      formData[key] = []\r\n    } else {\r\n      formData[key] = ''\r\n    }\r\n  })\r\n  specifications.value = [{ key: '', value: '' }]\r\n  formRef.value?.resetFields()\r\n}\r\n\r\nconst loadFormData = () => {\r\n  if (props.assetData && props.isEdit) {\r\n    Object.keys(formData).forEach(key => {\r\n      if (props.assetData[key] !== undefined) {\r\n        formData[key] = props.assetData[key]\r\n      }\r\n    })\r\n    \r\n    // 处理规格参数\r\n    if (props.assetData.specifications && typeof props.assetData.specifications === 'object') {\r\n      const specs = Object.entries(props.assetData.specifications).map(([key, value]) => ({ key, value }))\r\n      specifications.value = specs.length > 0 ? specs : [{ key: '', value: '' }]\r\n    }\r\n  }\r\n}\r\n\r\nconst loadUsers = async () => {\r\n  if (userOptions.value.length > 0) return\r\n  \r\n  userLoading.value = true\r\n  try {\r\n    const response = await userApi.search({ page_size: 100 })\r\n    userOptions.value = response.data.results || []\r\n  } catch (error) {\r\n    console.error('Load users error:', error)\r\n    message.error('加载用户列表失败')\r\n  } finally {\r\n    userLoading.value = false\r\n  }\r\n}\r\n\r\nconst searchUsers = async (query) => {\r\n  if (!query) return\r\n  \r\n  userLoading.value = true\r\n  try {\r\n    const response = await userApi.search({ search: query, page_size: 50 })\r\n    userOptions.value = response.data.results || []\r\n  } catch (error) {\r\n    console.error('Search users error:', error)\r\n    message.error('搜索用户失败')\r\n  } finally {\r\n    userLoading.value = false\r\n  }\r\n}\r\n\r\nconst loadSuppliers = async () => {\r\n  if (supplierOptions.value.length > 0) return\r\n  \r\n  supplierLoading.value = true\r\n  try {\r\n    const response = await supplierApi.getSimpleList({ page_size: 100 })\r\n    supplierOptions.value = response.data || []\r\n  } catch (error) {\r\n    console.error('Load suppliers error:', error)\r\n    message.error('加载供应商列表失败')\r\n  } finally {\r\n    supplierLoading.value = false\r\n  }\r\n}\r\n\r\nconst searchSuppliers = async (query) => {\r\n  supplierLoading.value = true\r\n  try {\r\n    const params = query ? { search: query, page_size: 50 } : { page_size: 100 }\r\n    const response = await supplierApi.getSimpleList(params)\r\n    supplierOptions.value = response.data || []\r\n  } catch (error) {\r\n    console.error('Search suppliers error:', error)\r\n    message.error('搜索供应商失败')\r\n  } finally {\r\n    supplierLoading.value = false\r\n  }\r\n}\r\n\r\nconst handleSupplierChange = async (supplierId) => {\r\n  supplierContacts.value = []\r\n  \r\n  if (!supplierId) return\r\n  \r\n  try {\r\n    const response = await supplierApi.getContacts(supplierId)\r\n    supplierContacts.value = response.data || []\r\n  } catch (error) {\r\n    console.error('Get supplier contacts error:', error)\r\n    message.error('获取供应商联系人失败')\r\n  }\r\n}\r\n\r\nconst addSpec = () => {\r\n  specifications.value.push({ key: '', value: '' })\r\n}\r\n\r\nconst removeSpec = (index) => {\r\n  if (specifications.value.length > 1) {\r\n    specifications.value.splice(index, 1)\r\n  }\r\n}\r\n\r\nconst filterOption = (input, option) => {\r\n  return option.label.toLowerCase().includes(input.toLowerCase())\r\n}\r\n\r\nconst disabledDate = (current) => {\r\n  // 禁用未来日期\r\n  return current && current > dayjs().endOf('day')\r\n}\r\n\r\nconst validateSpecifications = () => {\r\n  // 新增模式下不需要验证规格参数\r\n  if (!props.isEdit) {\r\n    return true\r\n  }\r\n  \r\n  const validSpecs = specifications.value.filter(spec => spec.key && spec.value)\r\n  if (validSpecs.length === 0) {\r\n    message.warning('请至少添加一个有效的规格参数')\r\n    return false\r\n  }\r\n  return true\r\n}\r\n\r\nconst handleSubmit = async () => {\r\n  try {\r\n    await formRef.value.validate()\r\n    \r\n    if (!validateSpecifications()) {\r\n      return\r\n    }\r\n    \r\n    submitLoading.value = true\r\n    \r\n    // 显示加载提示\r\n    const loadingMessage = message.loading(\r\n      props.isEdit ? '正在更新设备信息...' : '正在创建设备...', \r\n      0\r\n    )\r\n    \r\n    // 处理规格参数（仅在编辑模式下）\r\n    const submitData = { ...formData }\r\n    \r\n    if (props.isEdit) {\r\n      const specs = {}\r\n      specifications.value.forEach(spec => {\r\n        if (spec.key && spec.value) {\r\n          specs[spec.key] = spec.value\r\n        }\r\n      })\r\n      submitData.specifications = specs\r\n    }\r\n    \r\n    if (props.isEdit && props.assetData?.id) {\r\n      await hardwareAssetApi.update(props.assetData.id, submitData)\r\n      loadingMessage()\r\n      message.success('设备信息更新成功！')\r\n    } else {\r\n      await hardwareAssetApi.create(submitData)\r\n      loadingMessage()\r\n      message.success('设备创建成功！')\r\n    }\r\n    \r\n    emit('success')\r\n    handleClose()\r\n  } catch (error) {\r\n    console.error('Submit error:', error)\r\n    \r\n    // 详细的错误处理\r\n    let errorMessage = '操作失败，请重试'\r\n    if (error.response) {\r\n      const { status, data } = error.response\r\n      if (status === 400) {\r\n        if (data && typeof data === 'object') {\r\n          const errorMessages = []\r\n          Object.entries(data).forEach(([field, messages]) => {\r\n            if (Array.isArray(messages)) {\r\n              errorMessages.push(...messages)\r\n            } else {\r\n              errorMessages.push(messages)\r\n            }\r\n          })\r\n          errorMessage = errorMessages.join(', ') || '请检查输入的数据格式'\r\n        } else {\r\n          errorMessage = data?.message || '请检查输入的数据格式'\r\n        }\r\n      } else if (status === 409) {\r\n        errorMessage = '资产编号或序列号已存在，请使用其他值'\r\n      } else if (status === 500) {\r\n        errorMessage = '服务器内部错误，请稍后重试'\r\n      }\r\n    } else if (error.message) {\r\n      errorMessage = error.message\r\n    }\r\n    \r\n    message.error(errorMessage)\r\n  } finally {\r\n    submitLoading.value = false\r\n  }\r\n}\r\n\r\nconst handleSubmitFailed = (errorInfo) => {\r\n  console.log('Form validation failed:', errorInfo)\r\n  message.error('请检查表单填写是否正确')\r\n}\r\n\r\nconst handleClose = () => {\r\n  dialogVisible.value = false\r\n  nextTick(() => {\r\n    resetForm()\r\n  })\r\n}\r\n\r\n// 监听器\r\nwatch(\r\n  () => props.visible,\r\n  (newVal) => {\r\n    if (newVal) {\r\n      nextTick(() => {\r\n        if (props.isEdit) {\r\n          loadFormData()\r\n        } else {\r\n          resetForm()\r\n        }\r\n      })\r\n    }\r\n  }\r\n)\r\n\r\n// 生命周期\r\nonMounted(() => {\r\n  loadUsers()\r\n  loadSuppliers()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n/* 表单容器 - 蓝白主题 */\r\n.form-section {\r\n  margin-bottom: 24px;\r\n  padding: 24px;\r\n  background: #ffffff;\r\n  border-radius: 8px;\r\n  border: 1px solid #e8f4fd;\r\n  box-shadow: 0 2px 8px rgba(24, 144, 255, 0.06);\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.form-section:hover {\r\n  box-shadow: 0 4px 12px rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n/* 标题样式 - 蓝白主题 */\r\n.section-title {\r\n  margin: 0 0 20px 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: #1890ff;\r\n  position: relative;\r\n  padding-left: 12px;\r\n}\r\n\r\n/* 规格参数样式 */\r\n.spec-item {\r\n  margin-bottom: 8px;\r\n  padding: 8px;\r\n  background: #fafafa;\r\n  border-radius: 4px;\r\n  border: 1px solid #f0f0f0;\r\n}\r\n\r\n.spec-item:hover {\r\n  border-color: #d9d9d9;\r\n}\r\n\r\n.section-title::before {\r\n  content: '';\r\n  position: absolute;\r\n  left: 0;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  width: 4px;\r\n  height: 16px;\r\n  background: #1890ff;\r\n  border-radius: 2px;\r\n}\r\n\r\n/* 表单项美化 */\r\n.form-item {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.form-item .ant-form-item-label {\r\n  text-align: left !important;\r\n  font-weight: 600;\r\n  color: #262626;\r\n}\r\n\r\n.form-item .ant-form-item-label > label {\r\n  color: #262626;\r\n  font-weight: 600;\r\n}\r\n\r\n/* 输入框样式 - 蓝白主题 */\r\n.form-item .ant-input,\r\n.form-item .ant-select-selector,\r\n.form-item .ant-picker,\r\n.form-item .ant-input-number {\r\n  border-radius: 6px;\r\n  border: 1px solid #d9d9d9;\r\n  background: #ffffff;\r\n}\r\n\r\n.form-item .ant-input:hover,\r\n.form-item .ant-select-selector:hover,\r\n.form-item .ant-picker:hover,\r\n.form-item .ant-input-number:hover {\r\n  border-color: #40a9ff;\r\n}\r\n\r\n.form-item .ant-input:focus,\r\n.form-item .ant-select-focused .ant-select-selector,\r\n.form-item .ant-picker-focused,\r\n.form-item .ant-input-number-focused {\r\n  border-color: #1890ff;\r\n  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);\r\n}\r\n\r\n/* 底部按钮样式 - 蓝白主题 */\r\n.dialog-footer {\r\n  text-align: right;\r\n  padding: 24px 0;\r\n  background: #ffffff;\r\n}\r\n\r\n.dialog-footer .ant-btn {\r\n  margin-left: 12px;\r\n  border-radius: 6px;\r\n}\r\n\r\n.dialog-footer .ant-btn:first-child {\r\n  border-color: #d9d9d9;\r\n  color: #666;\r\n}\r\n\r\n.dialog-footer .ant-btn:first-child:hover {\r\n  border-color: #40a9ff;\r\n  color: #40a9ff;\r\n}\r\n\r\n.dialog-footer .ant-btn[type=\"primary\"] {\r\n  background: #1890ff;\r\n  border-color: #1890ff;\r\n}\r\n\r\n.dialog-footer .ant-btn[type=\"primary\"]:hover {\r\n  background: #40a9ff;\r\n  border-color: #40a9ff;\r\n}\r\n\r\n/* 响应式优化 */\r\n@media (max-width: 768px) {\r\n  .form-section {\r\n    padding: 20px;\r\n    margin-bottom: 24px;\r\n  }\r\n  \r\n  .section-title {\r\n    font-size: 16px;\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .dialog-footer {\r\n    padding: 20px 0;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}