{"ast":null,"code":"import { ref, reactive, onMounted, computed } from 'vue';\nimport { message } from 'ant-design-vue';\nimport dayjs from 'dayjs';\nimport { IdcardOutlined, ExportOutlined, PlusOutlined, SearchOutlined, ReloadOutlined, EyeOutlined, EditOutlined, DeleteOutlined } from '@ant-design/icons-vue';\nimport { getPositions, getPositionDetail, createPosition, updatePosition, deletePosition, getPositionsByDepartment } from '@/api/organization';\nimport { getDepartments } from '@/api/organization';\n\n// 响应式数据\n\nexport default {\n  __name: 'AdminPositions',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const loading = ref(false);\n    const searchText = ref('');\n    const statusFilter = ref('');\n    const levelFilter = ref('');\n    const departmentFilter = ref('');\n    const modalVisible = ref(false);\n    const detailModalVisible = ref(false);\n    const isEdit = ref(false);\n    const selectedPosition = ref(null);\n    const formRef = ref();\n\n    // 表单数据\n    const formData = reactive({\n      name: '',\n      code: '',\n      department: null,\n      level: '',\n      sort_order: 0,\n      status: 'active',\n      description: '',\n      requirements: ''\n    });\n\n    // 表单验证规则\n    const formRules = {\n      name: [{\n        required: true,\n        message: '请输入职位名称',\n        trigger: 'blur'\n      }],\n      code: [{\n        required: true,\n        message: '请输入职位编码',\n        trigger: 'blur'\n      }],\n      department: [{\n        required: true,\n        message: '请选择所属部门',\n        trigger: 'change'\n      }],\n      level: [{\n        required: true,\n        message: '请选择职位级别',\n        trigger: 'change'\n      }],\n      status: [{\n        required: true,\n        message: '请选择状态',\n        trigger: 'change'\n      }]\n    };\n\n    // 数据\n    const positionList = ref([]);\n    const departmentList = ref([]);\n\n    // 表格列定义\n    const columns = [{\n      title: '职位名称',\n      dataIndex: 'name',\n      key: 'name',\n      width: 200\n    }, {\n      title: '职位编码',\n      dataIndex: 'code',\n      key: 'code',\n      width: 120\n    }, {\n      title: '所属部门',\n      dataIndex: ['department', 'full_name'],\n      key: 'department_full_name',\n      width: 120\n    }, {\n      title: '状态',\n      dataIndex: 'status',\n      key: 'status',\n      width: 100\n    }, {\n      title: '创建时间',\n      dataIndex: 'created_at',\n      key: 'created_at',\n      width: 160,\n      customRender: ({\n        text\n      }) => formatDate(text)\n    }, {\n      title: '操作',\n      key: 'action',\n      width: 150,\n      fixed: 'right'\n    }];\n\n    // 分页配置\n    const pagination = reactive({\n      current: 1,\n      pageSize: 10,\n      total: 0,\n      showSizeChanger: true,\n      showQuickJumper: true,\n      showTotal: (total, range) => `第 ${range[0]}-${range[1]} 条，共 ${total} 条`\n    });\n\n    // 计算属性\n    const modalTitle = computed(() => {\n      return isEdit.value ? '编辑职位' : '新建职位';\n    });\n\n    // 方法\n    const getLevelColor = level => {\n      const colors = {\n        'junior': 'blue',\n        'intermediate': 'orange',\n        'senior': 'red',\n        'expert': 'purple',\n        'manager': 'green',\n        'director': 'gold',\n        'vp': 'magenta',\n        'ceo': 'volcano'\n      };\n      return colors[level] || 'default';\n    };\n    const getLevelText = level => {\n      const texts = {\n        'junior': '初级',\n        'intermediate': '中级',\n        'senior': '高级',\n        'expert': '专家',\n        'manager': '管理',\n        'director': '总监',\n        'vp': '副总',\n        'ceo': '总裁'\n      };\n      return texts[level] || '未知';\n    };\n\n    // 时间格式化函数\n    const formatDate = date => {\n      return date ? dayjs(date).format('YYYY-MM-DD HH:mm:ss') : '-';\n    };\n    const handleSearch = () => {\n      loadPositions();\n    };\n    const handleSearchChange = () => {\n      if (!searchText.value) {\n        loadPositions();\n      }\n    };\n    const handleFilterChange = () => {\n      loadPositions();\n    };\n    const resetFilters = () => {\n      searchText.value = '';\n      statusFilter.value = '';\n      levelFilter.value = '';\n      departmentFilter.value = '';\n      loadPositions();\n    };\n    const handleTableChange = (pag, filters, sorter) => {\n      pagination.current = pag.current;\n      pagination.pageSize = pag.pageSize;\n      loadPositions();\n    };\n    const loadPositions = async () => {\n      loading.value = true;\n      try {\n        const params = {\n          page: pagination.current,\n          page_size: pagination.pageSize\n        };\n        if (searchText.value) {\n          params.search = searchText.value;\n        }\n        if (statusFilter.value && statusFilter.value !== 'all') {\n          params.status = statusFilter.value;\n        }\n        if (levelFilter.value) {\n          params.level = levelFilter.value;\n        }\n        if (departmentFilter.value) {\n          params.department = departmentFilter.value;\n        }\n        const response = await getPositions(params);\n        if (response.status == 200) {\n          const results = response.data.results || [];\n          positionList.value = Array.isArray(results) ? results : [];\n          pagination.total = response.count || response.total || 0;\n          console.log(positionList.value);\n        }\n      } catch (error) {\n        console.error('加载职位列表失败:', error);\n        message.error('加载职位列表失败');\n      } finally {\n        loading.value = false;\n      }\n    };\n    const showAddModal = () => {\n      isEdit.value = false;\n      resetForm();\n      loadDepartments();\n      modalVisible.value = true;\n    };\n    const editPosition = record => {\n      isEdit.value = true;\n      Object.assign(formData, {\n        id: record.id,\n        name: record.name,\n        code: record.code,\n        department: record.department,\n        level: record.level,\n        sort_order: record.sort_order,\n        status: record.status,\n        description: record.description,\n        requirements: record.requirements\n      });\n      modalVisible.value = true;\n    };\n    const viewPosition = record => {\n      selectedPosition.value = record;\n      detailModalVisible.value = true;\n    };\n    const handleDeletePosition = async record => {\n      try {\n        await deletePosition(record.id);\n        message.success('删除成功');\n        loadPositions();\n      } catch (error) {\n        console.error('删除职位失败:', error);\n        message.error('删除失败');\n      }\n    };\n    const handleModalOk = async () => {\n      try {\n        await formRef.value.validate();\n\n        // 准备提交数据，将department转换为department_id\n        const submitData = {\n          ...formData\n        };\n        if (submitData.department) {\n          submitData.department_id = submitData.department;\n          delete submitData.department;\n        }\n        if (isEdit.value) {\n          await updatePosition(submitData.id, submitData);\n          message.success('更新成功');\n        } else {\n          await createPosition(submitData);\n          message.success('创建成功');\n        }\n        modalVisible.value = false;\n        loadPositions();\n      } catch (error) {\n        console.error('保存职位失败:', error);\n\n        // 处理表单验证错误\n        if (error.errorFields) {\n          message.error('请检查表单输入');\n          return;\n        }\n\n        // 处理API返回的错误\n        if (error.response && error.response.data) {\n          const errorData = error.response.data;\n\n          // 处理字段特定错误\n          if (errorData.code && Array.isArray(errorData.code)) {\n            message.error(`职位编码错误: ${errorData.code[0]}`);\n            return;\n          }\n          if (errorData.name && Array.isArray(errorData.name)) {\n            message.error(`职位名称错误: ${errorData.name[0]}`);\n            return;\n          }\n          if (errorData.department && Array.isArray(errorData.department)) {\n            message.error(`所属部门错误: ${errorData.department[0]}`);\n            return;\n          }\n\n          // 处理其他字段错误\n          const firstErrorField = Object.keys(errorData)[0];\n          if (firstErrorField && Array.isArray(errorData[firstErrorField])) {\n            message.error(`${firstErrorField}: ${errorData[firstErrorField][0]}`);\n            return;\n          }\n\n          // 处理通用错误消息\n          if (errorData.detail) {\n            message.error(errorData.detail);\n            return;\n          }\n          if (errorData.message) {\n            message.error(errorData.message);\n            return;\n          }\n        }\n\n        // 默认错误消息\n        message.error(isEdit.value ? '更新失败' : '创建失败');\n      }\n    };\n    const handleModalCancel = () => {\n      modalVisible.value = false;\n      resetForm();\n    };\n    const resetForm = () => {\n      Object.assign(formData, {\n        name: '',\n        code: '',\n        department: null,\n        level: '',\n        sort_order: 0,\n        status: 'active',\n        description: '',\n        requirements: ''\n      });\n      if (formRef.value) {\n        formRef.value.resetFields();\n      }\n    };\n    const exportPositions = () => {\n      // 导出功能实现\n      message.info('导出功能开发中...');\n    };\n    const getCurrentCategoryName = () => {\n      return '职位管理';\n    };\n    const refreshData = () => {\n      loadDepartments();\n      loadPositions();\n    };\n\n    // 加载部门列表\n    const loadDepartments = async () => {\n      try {\n        const response = await getDepartments();\n        console.log(response);\n        if (response.status == 200) {\n          const departments = response.data.results || [];\n          departmentList.value = Array.isArray(departments) ? departments : [];\n        }\n      } catch (error) {\n        console.error('加载部门列表失败:', error);\n      }\n    };\n\n    // 生命周期\n    onMounted(() => {\n      loadDepartments();\n      loadPositions();\n    });\n    const __returned__ = {\n      loading,\n      searchText,\n      statusFilter,\n      levelFilter,\n      departmentFilter,\n      modalVisible,\n      detailModalVisible,\n      isEdit,\n      selectedPosition,\n      formRef,\n      formData,\n      formRules,\n      positionList,\n      departmentList,\n      columns,\n      pagination,\n      modalTitle,\n      getLevelColor,\n      getLevelText,\n      formatDate,\n      handleSearch,\n      handleSearchChange,\n      handleFilterChange,\n      resetFilters,\n      handleTableChange,\n      loadPositions,\n      showAddModal,\n      editPosition,\n      viewPosition,\n      handleDeletePosition,\n      handleModalOk,\n      handleModalCancel,\n      resetForm,\n      exportPositions,\n      getCurrentCategoryName,\n      refreshData,\n      loadDepartments,\n      ref,\n      reactive,\n      onMounted,\n      computed,\n      get message() {\n        return message;\n      },\n      get dayjs() {\n        return dayjs;\n      },\n      get IdcardOutlined() {\n        return IdcardOutlined;\n      },\n      get ExportOutlined() {\n        return ExportOutlined;\n      },\n      get PlusOutlined() {\n        return PlusOutlined;\n      },\n      get SearchOutlined() {\n        return SearchOutlined;\n      },\n      get ReloadOutlined() {\n        return ReloadOutlined;\n      },\n      get EyeOutlined() {\n        return EyeOutlined;\n      },\n      get EditOutlined() {\n        return EditOutlined;\n      },\n      get DeleteOutlined() {\n        return DeleteOutlined;\n      },\n      get getPositions() {\n        return getPositions;\n      },\n      get getPositionDetail() {\n        return getPositionDetail;\n      },\n      get createPosition() {\n        return createPosition;\n      },\n      get updatePosition() {\n        return updatePosition;\n      },\n      get deletePosition() {\n        return deletePosition;\n      },\n      get getPositionsByDepartment() {\n        return getPositionsByDepartment;\n      },\n      get getDepartments() {\n        return getDepartments;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","computed","message","dayjs","IdcardOutlined","ExportOutlined","PlusOutlined","SearchOutlined","ReloadOutlined","EyeOutlined","EditOutlined","DeleteOutlined","getPositions","getPositionDetail","createPosition","updatePosition","deletePosition","getPositionsByDepartment","getDepartments","loading","searchText","statusFilter","levelFilter","departmentFilter","modalVisible","detailModalVisible","isEdit","selectedPosition","formRef","formData","name","code","department","level","sort_order","status","description","requirements","formRules","required","trigger","positionList","departmentList","columns","title","dataIndex","key","width","customRender","text","formatDate","fixed","pagination","current","pageSize","total","showSizeChanger","showQuickJumper","showTotal","range","modalTitle","value","getLevelColor","colors","getLevelText","texts","date","format","handleSearch","loadPositions","handleSearchChange","handleFilterChange","resetFilters","handleTableChange","pag","filters","sorter","params","page","page_size","search","response","results","data","Array","isArray","count","console","log","error","showAddModal","resetForm","loadDepartments","editPosition","record","Object","assign","id","viewPosition","handleDeletePosition","success","handleModalOk","validate","submitData","department_id","errorFields","errorData","firstErrorField","keys","detail","handleModalCancel","resetFields","exportPositions","info","getCurrentCategoryName","refreshData","departments"],"sources":["E:/A_project/yuanchi/AIops/frontend/src/views/admin/AdminPositions.vue"],"sourcesContent":["<template>\r\n  <div class=\"admin-positions admin-page\">\r\n    <!-- 页面标题区域 -->\r\n    <div class=\"page-header\">\r\n      <div class=\"header-content\">\r\n        <h1 class=\"page-title\">\r\n          <IdcardOutlined />\r\n          职位管理\r\n        </h1>\r\n        <p class=\"page-description\">管理组织架构中的职位信息</p>\r\n      </div>\r\n      <div class=\"header-actions\">\r\n        <a-space>\r\n          <a-tooltip title=\"导出职位列表为Excel文件\" placement=\"bottom\">\r\n            <a-button @click=\"exportPositions\">\r\n              <ExportOutlined />\r\n              导出职位\r\n            </a-button>\r\n          </a-tooltip>\r\n          <a-tooltip title=\"创建新的职位\" placement=\"bottom\">\r\n            <a-button type=\"primary\" @click=\"showAddModal\">\r\n              <PlusOutlined />\r\n              新建职位\r\n            </a-button>\r\n          </a-tooltip>\r\n        </a-space>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 职位管理内容区域 -->\r\n    <div class=\"positions-content admin-content full-width\">\r\n        <a-card>\r\n          <template #title>\r\n            {{ getCurrentCategoryName() }}\r\n          </template>\r\n          <template #extra>\r\n            <a-space>\r\n              <a-select\r\n                v-model:value=\"departmentFilter\"\r\n                placeholder=\"选择部门\"\r\n                style=\"width: 150px\"\r\n                allow-clear\r\n                @change=\"handleFilterChange\"\r\n              >\r\n                <a-select-option value=\"\">全部部门</a-select-option>\r\n                <a-select-option v-for=\"dept in departmentList\" :key=\"dept.id\" :value=\"dept.id\">\r\n                  {{ dept.name }}\r\n                </a-select-option>\r\n              </a-select>\r\n              <a-input-search\r\n                v-model:value=\"searchText\"\r\n                placeholder=\"搜索职位...\"\r\n                style=\"width: 200px\"\r\n                @search=\"handleSearch\"\r\n                @change=\"handleSearch\"\r\n              />\r\n              <a-select\r\n                v-model:value=\"statusFilter\"\r\n                placeholder=\"状态筛选\"\r\n                style=\"width: 120px\"\r\n                @change=\"handleFilterChange\"\r\n              >\r\n                <a-select-option value=\"\">全部状态</a-select-option>\r\n                <a-select-option value=\"active\">启用</a-select-option>\r\n                <a-select-option value=\"inactive\">禁用</a-select-option>\r\n              </a-select>\r\n              <a-tooltip title=\"刷新职位列表数据\" placement=\"bottom\">\r\n                <a-button @click=\"refreshData\">\r\n                  <ReloadOutlined />\r\n                </a-button>\r\n              </a-tooltip>\r\n            </a-space>\r\n          </template>\r\n\r\n          <!-- 职位表格 -->\r\n          <a-table\r\n            :columns=\"columns\"\r\n            :data-source=\"positionList\"\r\n            :loading=\"loading\"\r\n            :pagination=\"pagination\"\r\n            row-key=\"id\"\r\n            @change=\"handleTableChange\"\r\n          >\r\n            <template #bodyCell=\"{ column, record }\">\r\n              <!-- 职位名称列 -->\r\n              <template v-if=\"column.key === 'name'\">\r\n                <div class=\"position-name\">\r\n                  <IdcardOutlined class=\"position-icon\" />\r\n                  <span class=\"name-text\">{{ record.name }}</span>\r\n                  <a-tag v-if=\"record.level\" :color=\"getLevelColor(record.level)\" size=\"small\">\r\n                    {{ getLevelText(record.level) }}\r\n                  </a-tag>\r\n                </div>\r\n              </template>\r\n\r\n              <!-- 状态列 -->\r\n              <template v-else-if=\"column.key === 'status'\">\r\n                <a-tag :color=\"record.status === 'active' ? 'green' : 'red'\">\r\n                  {{ record.status === 'active' ? '启用' : '禁用' }}\r\n                </a-tag>\r\n              </template>\r\n\r\n\r\n\r\n              <!-- 操作列 -->\r\n              <template v-else-if=\"column.key === 'action'\">\r\n              <a-space>\r\n                <a-tooltip title=\"查看详情\">\r\n                  <a-button type=\"text\" size=\"small\" @click=\"viewPosition(record)\">\r\n                    <EyeOutlined />\r\n                  </a-button>\r\n                </a-tooltip>\r\n                <a-tooltip title=\"编辑职位\">\r\n                  <a-button type=\"text\" size=\"small\" @click=\"editPosition(record)\">\r\n                    <EditOutlined />\r\n                  </a-button>\r\n                </a-tooltip>\r\n                <a-popconfirm\r\n                  title=\"确定要删除这个职位吗？\"\r\n                  @confirm=\"handleDeletePosition(record)\"\r\n                >\r\n                  <a-tooltip title=\"删除职位\">\r\n                    <a-button type=\"text\" size=\"small\" danger>\r\n                      <DeleteOutlined />\r\n                    </a-button>\r\n                  </a-tooltip>\r\n                </a-popconfirm>\r\n              </a-space>\r\n               </template>\r\n            </template>\r\n          </a-table>\r\n        </a-card>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 新建/编辑职位弹窗 -->\r\n    <a-modal\r\n      v-model:open=\"modalVisible\"\r\n      :title=\"modalTitle\"\r\n      :width=\"600\"\r\n      @ok=\"handleModalOk\"\r\n      @cancel=\"handleModalCancel\"\r\n    >\r\n      <a-form\r\n        ref=\"formRef\"\r\n        :model=\"formData\"\r\n        :rules=\"formRules\"\r\n        layout=\"vertical\"\r\n      >\r\n        <a-row :gutter=\"16\">\r\n          <a-col :span=\"12\">\r\n            <a-form-item label=\"职位名称\" name=\"name\">\r\n              <a-input v-model:value=\"formData.name\" placeholder=\"请输入职位名称\" />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"12\">\r\n            <a-form-item label=\"职位编码\" name=\"code\">\r\n              <a-input v-model:value=\"formData.code\" placeholder=\"请输入职位编码\" />\r\n            </a-form-item>\r\n          </a-col>\r\n        </a-row>\r\n        \r\n        <a-row :gutter=\"16\">\r\n          <a-col :span=\"12\">\r\n            <a-form-item label=\"所属部门\" name=\"department\">\r\n              <a-select\r\n                v-model:value=\"formData.department\"\r\n                placeholder=\"请选择所属部门\"\r\n                allow-clear\r\n              >\r\n                <a-select-option v-for=\"dept in departmentList\" :key=\"dept.id\" :value=\"dept.id\">\r\n                  {{ dept.name }}\r\n                </a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"12\">\r\n            <a-form-item label=\"职位级别\" name=\"level\">\r\n              <a-select v-model:value=\"formData.level\" placeholder=\"请选择职位级别\">\r\n                <a-select-option value=\"junior\">初级</a-select-option>\r\n                <a-select-option value=\"intermediate\">中级</a-select-option>\r\n                <a-select-option value=\"senior\">高级</a-select-option>\r\n                <a-select-option value=\"expert\">专家</a-select-option>\r\n                <a-select-option value=\"manager\">管理</a-select-option>\r\n                <a-select-option value=\"director\">总监</a-select-option>\r\n                <a-select-option value=\"vp\">副总</a-select-option>\r\n                <a-select-option value=\"ceo\">总裁</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n        </a-row>\r\n\r\n\r\n\r\n        <a-row :gutter=\"16\">\r\n          <a-col :span=\"12\">\r\n            <a-form-item label=\"排序\" name=\"sort_order\">\r\n              <a-input-number\r\n                v-model:value=\"formData.sort_order\"\r\n                :min=\"0\"\r\n                :max=\"999\"\r\n                placeholder=\"排序号\"\r\n                style=\"width: 100%\"\r\n              />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"12\">\r\n            <a-form-item label=\"状态\" name=\"status\">\r\n              <a-select v-model:value=\"formData.status\" placeholder=\"请选择状态\">\r\n                <a-select-option value=\"active\">启用</a-select-option>\r\n                <a-select-option value=\"inactive\">禁用</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n        </a-row>\r\n\r\n        <a-form-item label=\"职位描述\" name=\"description\">\r\n          <a-textarea\r\n            v-model:value=\"formData.description\"\r\n            placeholder=\"请输入职位描述\"\r\n            :rows=\"3\"\r\n          />\r\n        </a-form-item>\r\n\r\n        <a-form-item label=\"职位要求\" name=\"requirements\">\r\n          <a-textarea\r\n            v-model:value=\"formData.requirements\"\r\n            placeholder=\"请输入职位要求\"\r\n            :rows=\"3\"\r\n          />\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-modal>\r\n\r\n    <!-- 职位详情弹窗 -->\r\n    <a-modal\r\n      v-model:open=\"detailModalVisible\"\r\n      title=\"职位详情\"\r\n      :width=\"800\"\r\n      :footer=\"null\"\r\n    >\r\n      <div v-if=\"selectedPosition\" class=\"position-detail\">\r\n        <a-descriptions :column=\"2\" bordered>\r\n          <a-descriptions-item label=\"职位名称\">\r\n            {{ selectedPosition.name }}\r\n          </a-descriptions-item>\r\n          <a-descriptions-item label=\"职位编码\">\r\n            {{ selectedPosition.code }}\r\n          </a-descriptions-item>\r\n          <a-descriptions-item label=\"所属部门\">\r\n            {{ selectedPosition.department?.full_name || '未设置' }}\r\n          </a-descriptions-item>\r\n          <a-descriptions-item label=\"职位级别\">\r\n            <a-tag :color=\"getLevelColor(selectedPosition.level)\">\r\n              {{ getLevelText(selectedPosition.level) }}\r\n            </a-tag>\r\n          </a-descriptions-item>\r\n\r\n          <a-descriptions-item label=\"状态\">\r\n            <a-tag :color=\"selectedPosition.status === 'active' ? 'green' : 'red'\">\r\n              {{ selectedPosition.status === 'active' ? '启用' : '禁用' }}\r\n            </a-tag>\r\n          </a-descriptions-item>\r\n          <a-descriptions-item label=\"创建时间\" :span=\"2\">\r\n            {{ formatDate(selectedPosition.created_at) }}\r\n          </a-descriptions-item>\r\n          <a-descriptions-item label=\"职位描述\" :span=\"2\">\r\n            {{ selectedPosition.description || '无' }}\r\n          </a-descriptions-item>\r\n          <a-descriptions-item label=\"职位要求\" :span=\"2\">\r\n            <div v-if=\"selectedPosition.requirements\" class=\"requirements-text\">\r\n              {{ selectedPosition.requirements }}\r\n            </div>\r\n            <span v-else>无</span>\r\n          </a-descriptions-item>\r\n        </a-descriptions>\r\n      </div>\r\n    </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, computed } from 'vue';\r\nimport { message } from 'ant-design-vue';\r\nimport dayjs from 'dayjs';\r\nimport {\r\n  IdcardOutlined,\r\n  ExportOutlined,\r\n  PlusOutlined,\r\n  SearchOutlined,\r\n  ReloadOutlined,\r\n  EyeOutlined,\r\n  EditOutlined,\r\n  DeleteOutlined\r\n} from '@ant-design/icons-vue';\r\nimport {\r\n  getPositions,\r\n  getPositionDetail,\r\n  createPosition,\r\n  updatePosition,\r\n  deletePosition,\r\n  getPositionsByDepartment\r\n} from '@/api/organization';\r\nimport { getDepartments } from '@/api/organization';\r\n\r\n// 响应式数据\r\nconst loading = ref(false);\r\nconst searchText = ref('');\r\nconst statusFilter = ref('');\r\nconst levelFilter = ref('');\r\nconst departmentFilter = ref('');\r\n\r\nconst modalVisible = ref(false);\r\nconst detailModalVisible = ref(false);\r\nconst isEdit = ref(false);\r\nconst selectedPosition = ref(null);\r\nconst formRef = ref();\r\n\r\n// 表单数据\r\nconst formData = reactive({\r\n  name: '',\r\n  code: '',\r\n  department: null,\r\n  level: '',\r\n  sort_order: 0,\r\n  status: 'active',\r\n  description: '',\r\n  requirements: ''\r\n});\r\n\r\n// 表单验证规则\r\nconst formRules = {\r\n  name: [{ required: true, message: '请输入职位名称', trigger: 'blur' }],\r\n  code: [{ required: true, message: '请输入职位编码', trigger: 'blur' }],\r\n  department: [{ required: true, message: '请选择所属部门', trigger: 'change' }],\r\n  level: [{ required: true, message: '请选择职位级别', trigger: 'change' }],\r\n  status: [{ required: true, message: '请选择状态', trigger: 'change' }]\r\n};\r\n\r\n// 数据\r\nconst positionList = ref([]);\r\nconst departmentList = ref([]);\r\n\r\n\r\n\r\n// 表格列定义\r\nconst columns = [\r\n  {\r\n    title: '职位名称',\r\n    dataIndex: 'name',\r\n    key: 'name',\r\n    width: 200\r\n  },\r\n  {\r\n    title: '职位编码',\r\n    dataIndex: 'code',\r\n    key: 'code',\r\n    width: 120\r\n  },\r\n  {\r\n    title: '所属部门',\r\n    dataIndex: ['department', 'full_name'],\r\n    key: 'department_full_name',\r\n    width: 120\r\n  },\r\n\r\n  {\r\n    title: '状态',\r\n    dataIndex: 'status',\r\n    key: 'status',\r\n    width: 100\r\n  },\r\n  {\r\n    title: '创建时间',\r\n    dataIndex: 'created_at',\r\n    key: 'created_at',\r\n    width: 160,\r\n    customRender: ({ text }) => formatDate(text)\r\n  },\r\n  {\r\n    title: '操作',\r\n    key: 'action',\r\n    width: 150,\r\n    fixed: 'right'\r\n  }\r\n];\r\n\r\n// 分页配置\r\nconst pagination = reactive({\r\n  current: 1,\r\n  pageSize: 10,\r\n  total: 0,\r\n  showSizeChanger: true,\r\n  showQuickJumper: true,\r\n  showTotal: (total, range) => `第 ${range[0]}-${range[1]} 条，共 ${total} 条`\r\n});\r\n\r\n// 计算属性\r\nconst modalTitle = computed(() => {\r\n  return isEdit.value ? '编辑职位' : '新建职位';\r\n});\r\n\r\n// 方法\r\nconst getLevelColor = (level) => {\r\n  const colors = {\r\n    'junior': 'blue',\r\n    'intermediate': 'orange',\r\n    'senior': 'red',\r\n    'expert': 'purple',\r\n    'manager': 'green',\r\n    'director': 'gold',\r\n    'vp': 'magenta',\r\n    'ceo': 'volcano'\r\n  };\r\n  return colors[level] || 'default';\r\n};\r\n\r\nconst getLevelText = (level) => {\r\n  const texts = {\r\n    'junior': '初级',\r\n    'intermediate': '中级',\r\n    'senior': '高级',\r\n    'expert': '专家',\r\n    'manager': '管理',\r\n    'director': '总监',\r\n    'vp': '副总',\r\n    'ceo': '总裁'\r\n  };\r\n  return texts[level] || '未知';\r\n};\r\n\r\n\r\n// 时间格式化函数\r\nconst formatDate = (date) => {\r\n  return date ? dayjs(date).format('YYYY-MM-DD HH:mm:ss') : '-';\r\n};\r\n\r\nconst handleSearch = () => {\r\n  loadPositions();\r\n};\r\n\r\nconst handleSearchChange = () => {\r\n  if (!searchText.value) {\r\n    loadPositions();\r\n  }\r\n};\r\n\r\nconst handleFilterChange = () => {\r\n  loadPositions();\r\n};\r\n\r\nconst resetFilters = () => {\r\n  searchText.value = '';\r\n  statusFilter.value = '';\r\n  levelFilter.value = '';\r\n  departmentFilter.value = '';\r\n  loadPositions();\r\n};\r\n\r\nconst handleTableChange = (pag, filters, sorter) => {\r\n  pagination.current = pag.current;\r\n  pagination.pageSize = pag.pageSize;\r\n  loadPositions();\r\n};\r\n\r\nconst loadPositions = async () => {\r\n  loading.value = true;\r\n  try {\r\n    const params = {\r\n      page: pagination.current,\r\n      page_size: pagination.pageSize\r\n    };\r\n    \r\n    if (searchText.value) {\r\n      params.search = searchText.value;\r\n    }\r\n    if (statusFilter.value && statusFilter.value !== 'all') {\r\n      params.status = statusFilter.value;\r\n    }\r\n    if (levelFilter.value) {\r\n      params.level = levelFilter.value;\r\n    }\r\n    if (departmentFilter.value) {\r\n      params.department = departmentFilter.value;\r\n    }\r\n    \r\n    const response = await getPositions(params);\r\n    if (response.status == 200){\r\n      const results = response.data.results || [];\r\n      positionList.value = Array.isArray(results) ? results : [];\r\n      pagination.total = response.count || response.total || 0;\r\n      console.log(positionList.value)\r\n    }\r\n  } catch (error) {\r\n    console.error('加载职位列表失败:', error);\r\n    message.error('加载职位列表失败');\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nconst showAddModal = () => {\r\n  isEdit.value = false;\r\n  resetForm();\r\n  loadDepartments();\r\n  modalVisible.value = true;\r\n};\r\n\r\nconst editPosition = (record) => {\r\n  isEdit.value = true;\r\n  Object.assign(formData, {\r\n    id: record.id,\r\n    name: record.name,\r\n    code: record.code,\r\n    department: record.department,\r\n    level: record.level,\r\n    sort_order: record.sort_order,\r\n    status: record.status,\r\n    description: record.description,\r\n    requirements: record.requirements\r\n  });\r\n  modalVisible.value = true;\r\n};\r\n\r\nconst viewPosition = (record) => {\r\n  selectedPosition.value = record;\r\n  detailModalVisible.value = true;\r\n};\r\n\r\nconst handleDeletePosition = async (record) => {\r\n  try {\r\n    await deletePosition(record.id);\r\n    message.success('删除成功');\r\n    loadPositions();\r\n  } catch (error) {\r\n    console.error('删除职位失败:', error);\r\n    message.error('删除失败');\r\n  }\r\n};\r\n\r\nconst handleModalOk = async () => {\r\n  try {\r\n    await formRef.value.validate();\r\n    \r\n    // 准备提交数据，将department转换为department_id\r\n    const submitData = { ...formData };\r\n    if (submitData.department) {\r\n      submitData.department_id = submitData.department;\r\n      delete submitData.department;\r\n    }\r\n    \r\n    if (isEdit.value) {\r\n      await updatePosition(submitData.id, submitData);\r\n      message.success('更新成功');\r\n    } else {\r\n      await createPosition(submitData);\r\n      message.success('创建成功');\r\n    }\r\n    \r\n    modalVisible.value = false;\r\n    loadPositions();\r\n  } catch (error) {\r\n    console.error('保存职位失败:', error);\r\n    \r\n    // 处理表单验证错误\r\n    if (error.errorFields) {\r\n      message.error('请检查表单输入');\r\n      return;\r\n    }\r\n    \r\n    // 处理API返回的错误\r\n    if (error.response && error.response.data) {\r\n      const errorData = error.response.data;\r\n      \r\n      // 处理字段特定错误\r\n      if (errorData.code && Array.isArray(errorData.code)) {\r\n        message.error(`职位编码错误: ${errorData.code[0]}`);\r\n        return;\r\n      }\r\n      \r\n      if (errorData.name && Array.isArray(errorData.name)) {\r\n        message.error(`职位名称错误: ${errorData.name[0]}`);\r\n        return;\r\n      }\r\n      \r\n      if (errorData.department && Array.isArray(errorData.department)) {\r\n        message.error(`所属部门错误: ${errorData.department[0]}`);\r\n        return;\r\n      }\r\n      \r\n      // 处理其他字段错误\r\n      const firstErrorField = Object.keys(errorData)[0];\r\n      if (firstErrorField && Array.isArray(errorData[firstErrorField])) {\r\n        message.error(`${firstErrorField}: ${errorData[firstErrorField][0]}`);\r\n        return;\r\n      }\r\n      \r\n      // 处理通用错误消息\r\n      if (errorData.detail) {\r\n        message.error(errorData.detail);\r\n        return;\r\n      }\r\n      \r\n      if (errorData.message) {\r\n        message.error(errorData.message);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    // 默认错误消息\r\n    message.error(isEdit.value ? '更新失败' : '创建失败');\r\n  }\r\n};\r\n\r\nconst handleModalCancel = () => {\r\n  modalVisible.value = false;\r\n  resetForm();\r\n};\r\n\r\nconst resetForm = () => {\r\n  Object.assign(formData, {\r\n    name: '',\r\n    code: '',\r\n    department: null,\r\n    level: '',\r\n    sort_order: 0,\r\n    status: 'active',\r\n    description: '',\r\n    requirements: ''\r\n  });\r\n  if (formRef.value) {\r\n    formRef.value.resetFields();\r\n  }\r\n};\r\n\r\nconst exportPositions = () => {\r\n  // 导出功能实现\r\n  message.info('导出功能开发中...');\r\n};\r\n\r\nconst getCurrentCategoryName = () => {\r\n  return '职位管理';\r\n};\r\n\r\nconst refreshData = () => {\r\n  loadDepartments();\r\n  loadPositions();\r\n};\r\n\r\n// 加载部门列表\r\nconst loadDepartments = async () => {\r\n  try {\r\n    const response = await getDepartments();\r\n    console.log(response)\r\n    if (response.status == 200){\r\n      const departments = response.data.results || [];\r\n      departmentList.value = Array.isArray(departments) ? departments : [];\r\n    }\r\n  } catch (error) {\r\n    console.error('加载部门列表失败:', error);\r\n  }\r\n};\r\n\r\n// 生命周期\r\nonMounted(() => {\r\n  loadDepartments();\r\n  loadPositions();\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n@import '@/assets/admin-common.css';\r\n\r\n.positions-content.full-width {\r\n  flex: 1;\r\n  width: 100%;\r\n  height: calc(100vh - 200px);\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.positions-content.full-width .ant-card {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.positions-content.full-width .ant-card-body {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0;\r\n}\r\n\r\n.positions-content.full-width .ant-table-wrapper {\r\n  flex: 1;\r\n  height: 100%;\r\n}\r\n\r\n.positions-content.full-width .ant-table {\r\n  height: 100%;\r\n}\r\n\r\n.positions-content.full-width .ant-table-tbody {\r\n  height: calc(100% - 55px);\r\n  overflow-y: auto;\r\n}\r\n\r\n/* 职位管理页面特有的样式 */\r\n.position-name {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.position-icon {\r\n  color: #1890ff;\r\n}\r\n\r\n.name-text {\r\n  font-weight: 500;\r\n}\r\n\r\n.salary-range {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.salary-text {\r\n  font-weight: 500;\r\n  color: #52c41a;\r\n}\r\n\r\n.no-salary {\r\n  color: #999;\r\n  font-style: italic;\r\n}\r\n\r\n.position-detail {\r\n  padding: 16px 0;\r\n}\r\n\r\n.requirements-text {\r\n  white-space: pre-wrap;\r\n  line-height: 1.6;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}