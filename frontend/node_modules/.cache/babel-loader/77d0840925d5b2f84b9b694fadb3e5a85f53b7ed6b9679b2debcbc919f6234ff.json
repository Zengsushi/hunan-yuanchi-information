{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"ip-list-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" IPè¡¨æ ¼ç»„ä»¶ \"), _createVNode($setup[\"IPTable\"], {\n    dataSource: $setup.ipData,\n    loading: $setup.loading,\n    pagination: $setup.pagination,\n    selectedRowKeys: $setup.selectedRowKeys,\n    searchKeyword: $setup.searchKeyword,\n    ipStatus: $setup.ipStatus,\n    ipType: $setup.ipType,\n    totalCount: $setup.statistics.total,\n    activeCount: $setup.statistics.active,\n    availableCount: $setup.statistics.available,\n    onlineCount: $setup.statistics.online,\n    onSelectChange: $setup.onSelectChange,\n    onSelectAll: $setup.onSelectAll,\n    onTableChange: $setup.handleTableChange,\n    onView: $setup.handleView,\n    onEdit: $setup.handleEdit,\n    onDelete: $setup.handleDelete,\n    onPing: $setup.handlePing,\n    onToggleMonitoring: $setup.handleToggleMonitoring,\n    onBatchDelete: $setup.handleBatchDelete,\n    onBatchToggleMonitoring: $setup.handleBatchToggleMonitoring,\n    onClearSelection: $setup.clearSelection,\n    onAdd: $setup.handleAdd,\n    onScan: $setup.handleScan,\n    onExport: $setup.handleExport,\n    onHeaderBatchPing: $setup.handleBatchPing,\n    onListManagement: $setup.handleListManagement,\n    onSearch: $setup.handleSearch,\n    onReset: $setup.handleReset,\n    onSearchInput: $setup.handleSearchInput,\n    onStatusChange: $setup.handleStatusChange,\n    onTypeChange: $setup.handleTypeChange,\n    batchDeleting: $setup.batchDeleting,\n    batchMonitoringToggling: $setup.batchMonitoringToggling\n  }, null, 8 /* PROPS */, [\"dataSource\", \"loading\", \"pagination\", \"selectedRowKeys\", \"searchKeyword\", \"ipStatus\", \"ipType\", \"totalCount\", \"activeCount\", \"availableCount\", \"onlineCount\", \"batchDeleting\", \"batchMonitoringToggling\"]), _createCommentVNode(\" ç›‘æ§æ“ä½œç»„ä»¶ \"), _createVNode($setup[\"MonitoringActions\"], {\n    selectedIP: $setup.selectedIP,\n    detailModalVisible: $setup.detailModalVisible,\n    scanModalVisible: $setup.scanModalVisible,\n    batchPingState: $setup.batchPingState,\n    taskResultModalVisible: $setup.taskResultModalVisible,\n    scanFormData: $setup.scanFormData,\n    scanRules: $setup.scanRules,\n    selectedTask: $setup.selectedTask,\n    taskResults: $setup.taskResults,\n    resultLoading: $setup.resultLoading,\n    resultColumns: $setup.resultColumns,\n    onCloseDetailModal: _cache[0] || (_cache[0] = $event => $setup.detailModalVisible = false),\n    onCloseScanModal: $setup.handleScanCancel,\n    onScanConfirm: $setup.handleScanConfirm,\n    onCloseBatchPing: $setup.closeBatchPingModal,\n    onStartBatchPing: $setup.startBatchPingTest,\n    onCloseTaskResult: _cache[1] || (_cache[1] = $event => $setup.taskResultModalVisible = false)\n  }, null, 8 /* PROPS */, [\"selectedIP\", \"detailModalVisible\", \"scanModalVisible\", \"batchPingState\", \"taskResultModalVisible\", \"scanFormData\", \"selectedTask\", \"taskResults\", \"resultLoading\"]), _createCommentVNode(\" æ¨¡æ¿é€‰æ‹©æŠ½å±‰ç»„ä»¶ \"), _createVNode($setup[\"TemplateDrawer\"], {\n    visible: $setup.templateDrawerVisible,\n    \"onUpdate:visible\": _cache[2] || (_cache[2] = $event => $setup.templateDrawerVisible = $event),\n    selectedTemplateIds: $setup.selectedTemplateIds,\n    \"onUpdate:selectedTemplateIds\": _cache[3] || (_cache[3] = $event => $setup.selectedTemplateIds = $event),\n    loading: $setup.templateLoading,\n    selectedIP: $setup.selectedIP,\n    onConfirm: $setup.handleCreateMonitoring,\n    onClose: $setup.handleCloseTemplateDrawer\n  }, null, 8 /* PROPS */, [\"visible\", \"selectedTemplateIds\", \"loading\", \"selectedIP\"])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createCommentVNode","_createVNode","$setup","dataSource","ipData","loading","pagination","selectedRowKeys","searchKeyword","ipStatus","ipType","totalCount","statistics","total","activeCount","active","availableCount","available","onlineCount","online","onSelectChange","onSelectAll","onTableChange","handleTableChange","onView","handleView","onEdit","handleEdit","onDelete","handleDelete","onPing","handlePing","onToggleMonitoring","handleToggleMonitoring","onBatchDelete","handleBatchDelete","onBatchToggleMonitoring","handleBatchToggleMonitoring","onClearSelection","clearSelection","onAdd","handleAdd","onScan","handleScan","onExport","handleExport","onHeaderBatchPing","handleBatchPing","onListManagement","handleListManagement","onSearch","handleSearch","onReset","handleReset","onSearchInput","handleSearchInput","onStatusChange","handleStatusChange","onTypeChange","handleTypeChange","batchDeleting","batchMonitoringToggling","selectedIP","detailModalVisible","scanModalVisible","batchPingState","taskResultModalVisible","scanFormData","scanRules","selectedTask","taskResults","resultLoading","resultColumns","onCloseDetailModal","_cache","$event","onCloseScanModal","handleScanCancel","onScanConfirm","handleScanConfirm","onCloseBatchPing","closeBatchPingModal","onStartBatchPing","startBatchPingTest","onCloseTaskResult","visible","templateDrawerVisible","selectedTemplateIds","templateLoading","onConfirm","handleCreateMonitoring","onClose","handleCloseTemplateDrawer"],"sources":["E:\\A_project\\yuanchi\\AIops\\frontend\\src\\views\\business\\IPList.vue"],"sourcesContent":["<template>\r\n  <div class=\"ip-list-container\">\r\n\r\n\r\n    <!-- IPè¡¨æ ¼ç»„ä»¶ -->\r\n    <IPTable\r\n      :dataSource=\"ipData\"\r\n      :loading=\"loading\"\r\n      :pagination=\"pagination\"\r\n      :selectedRowKeys=\"selectedRowKeys\"\r\n      :searchKeyword=\"searchKeyword\"\r\n      :ipStatus=\"ipStatus\"\r\n      :ipType=\"ipType\"\r\n      :totalCount=\"statistics.total\"\r\n      :activeCount=\"statistics.active\"\r\n      :availableCount=\"statistics.available\"\r\n      :onlineCount=\"statistics.online\"\r\n      @select-change=\"onSelectChange\"\r\n      @select-all=\"onSelectAll\"\r\n      @table-change=\"handleTableChange\"\r\n      @view=\"handleView\"\r\n      @edit=\"handleEdit\"\r\n      @delete=\"handleDelete\"\r\n      @ping=\"handlePing\"\r\n      @toggle-monitoring=\"handleToggleMonitoring\"\r\n      @batch-delete=\"handleBatchDelete\"\r\n      @batch-toggle-monitoring=\"handleBatchToggleMonitoring\"\r\n      @clear-selection=\"clearSelection\"\r\n      @add=\"handleAdd\"\r\n      @scan=\"handleScan\"\r\n      @export=\"handleExport\"\r\n      @header-batch-ping=\"handleBatchPing\"\r\n      @list-management=\"handleListManagement\"\r\n      @search=\"handleSearch\"\r\n      @reset=\"handleReset\"\r\n      @search-input=\"handleSearchInput\"\r\n      @status-change=\"handleStatusChange\"\r\n      @type-change=\"handleTypeChange\"\r\n      :batchDeleting=\"batchDeleting\"\r\n      :batchMonitoringToggling=\"batchMonitoringToggling\"\r\n    />\r\n\r\n    <!-- ç›‘æ§æ“ä½œç»„ä»¶ -->\r\n    <MonitoringActions\r\n      :selectedIP=\"selectedIP\"\r\n      :detailModalVisible=\"detailModalVisible\"\r\n      :scanModalVisible=\"scanModalVisible\"\r\n      :batchPingState=\"batchPingState\"\r\n      :taskResultModalVisible=\"taskResultModalVisible\"\r\n      :scanFormData=\"scanFormData\"\r\n      :scanRules=\"scanRules\"\r\n      :selectedTask=\"selectedTask\"\r\n      :taskResults=\"taskResults\"\r\n      :resultLoading=\"resultLoading\"\r\n      :resultColumns=\"resultColumns\"\r\n      @close-detail-modal=\"detailModalVisible = false\"\r\n      @close-scan-modal=\"handleScanCancel\"\r\n      @scan-confirm=\"handleScanConfirm\"\r\n      @close-batch-ping=\"closeBatchPingModal\"\r\n      @start-batch-ping=\"startBatchPingTest\"\r\n      @close-task-result=\"taskResultModalVisible = false\"\r\n    />\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    <!-- æ¨¡æ¿é€‰æ‹©æŠ½å±‰ç»„ä»¶ -->\r\n    <TemplateDrawer \r\n      v-model:visible=\"templateDrawerVisible\"\r\n      v-model:selectedTemplateIds=\"selectedTemplateIds\"\r\n      :loading=\"templateLoading\"\r\n      :selectedIP=\"selectedIP\"\r\n      @confirm=\"handleCreateMonitoring\"\r\n      @close=\"handleCloseTemplateDrawer\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, onMounted, onUnmounted, watch, onBeforeUnmount, nextTick, h, createVNode } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { message, Modal } from 'ant-design-vue';\r\nimport { ipAPI } from '@/api';\r\nimport { suppressResizeObserverError } from '@/utils/errorHandler';\r\nimport * as Vue from 'vue';\r\nimport * as antdvIcons from '@ant-design/icons-vue';\r\n\r\n// å¯¼å…¥æ‹†åˆ†çš„ç»„ä»¶\r\nimport IPTable from '@/components/business/IPTable.vue';\r\nimport MonitoringActions from '@/components/business/MonitoringActions.vue';\r\nimport TemplateDrawer from '@/components/business/TemplateDrawer.vue';\r\nimport { \r\n  ExclamationCircleOutlined,\r\n} from '@ant-design/icons-vue';\r\n\r\n// è·¯ç”±å®ä¾‹\r\nconst router = useRouter();\r\n\r\n// æœç´¢æ¡ä»¶\r\nconst searchKeyword = ref('');\r\nconst ipStatus = ref('');\r\nconst ipType = ref('');\r\n\r\n// IPæ•°æ®çŠ¶æ€ - ç¡®ä¿å§‹ç»ˆæ˜¯æ•°ç»„\r\nconst ipData = ref([]);\r\nconst loading = ref(false);\r\n\r\n// æ‰¹é‡æ“ä½œç›¸å…³çŠ¶æ€\r\nconst selectedRowKeys = ref([]);\r\nconst batchDeleting = ref(false);\r\nconst batchMonitoringToggling = ref(false);\r\n\r\n// æ¨¡æ¿é€‰æ‹©æŠ½å±‰ç›¸å…³çŠ¶æ€\r\nconst templateDrawerVisible = ref(false);\r\nconst zabbixTemplates = ref([]);\r\nconst selectedTemplateIds = ref([]);\r\nconst templateLoading = ref(false);\r\nconst templateSearchKeyword = ref('');\r\nconst monitoringCreating = ref(false);\r\nconst selectedCategory = ref(''); // å½“å‰é€‰ä¸­çš„åˆ†ç±»\r\nconst expandedCategories = ref({}); // å±•å¼€çš„åˆ†ç±»\r\n\r\n// é˜²å¾¡æ€§æ£€æŸ¥ï¼Œç¡®ä¿ipDataå§‹ç»ˆæ˜¯æ•°ç»„\r\nconst setIPData = (data) => {\r\n  if (Array.isArray(data)) {\r\n    // ä¸ºæ¯ä¸ªIPè®°å½•è®¾ç½®ä¿æŠ¤çŠ¶æ€ä¿¡æ¯\r\n    const processedData = data.map(ip => {\r\n      // ç¡®ä¿ä¿æŠ¤çŠ¶æ€å­—æ®µå­˜åœ¨\r\n      if (ip.is_protected === undefined) {\r\n        ip.is_protected = ip.is_auto_discovered || false;\r\n      }\r\n      \r\n      // è®¾ç½®ä¿æŠ¤åŸå› \r\n      if (!ip.protection_reason && ip.is_auto_discovered) {\r\n        ip.protection_reason = 'è‡ªåŠ¨å‘ç°çš„IPåœ°å€';\r\n      }\r\n      \r\n      // è®¾ç½®å¯ç¼–è¾‘å­—æ®µåˆ—è¡¨\r\n      if (ip.is_auto_discovered) {\r\n        ip.editable_fields = ['description', 'status'];\r\n      } else {\r\n        ip.editable_fields = 'all';\r\n      }\r\n      \r\n      return ip;\r\n    });\r\n    \r\n    ipData.value = processedData;\r\n  } else {\r\n    console.warn('å°è¯•è®¾ç½®éæ•°ç»„æ•°æ®åˆ°ipData:', data);\r\n    ipData.value = [];\r\n  }\r\n};\r\n\r\n// ç»Ÿè®¡è®¡ç®—å±æ€§ - æ·»åŠ é˜²å¾¡æ€§æ£€æŸ¥\r\nconst activeCount = computed(() => {\r\n  if (!Array.isArray(ipData.value)) {\r\n    console.warn('ipDataä¸æ˜¯æ•°ç»„ï¼Œè¿”å›0');\r\n    return 0;\r\n  }\r\n  return ipData.value.filter(ip => ip.status === 'active').length;\r\n});\r\n\r\nconst availableCount = computed(() => {\r\n  if (!Array.isArray(ipData.value)) {\r\n    console.warn('ipDataä¸æ˜¯æ•°ç»„ï¼Œè¿”å›0');\r\n    return 0;\r\n  }\r\n  return ipData.value.filter(ip => ip.status === 'available').length;\r\n});\r\n\r\nconst onlineCount = computed(() => {\r\n  if (!Array.isArray(ipData.value)) {\r\n    console.warn('ipDataä¸æ˜¯æ•°ç»„ï¼Œè¿”å›0');\r\n    return 0;\r\n  }\r\n  return ipData.value.filter(ip => ip.ping_status === 'online' || ip.pingStatus === 'online').length;\r\n});\r\n\r\n// ç»Ÿè®¡å¯¹è±¡\r\nconst statistics = computed(() => ({\r\n  total: ipData.value.length || 0,\r\n  active: activeCount.value,\r\n  available: availableCount.value,\r\n  online: onlineCount.value\r\n}));\r\n\r\n// è®¡ç®—å±æ€§ - æ‰«æç›¸å…³\r\nconst needsKey = computed(() => {\r\n  const type = scanFormData.checkType;\r\n  // Zabbix agent, SNMPv1, SNMPv2, SNMPv3 éœ€è¦key\r\n  return type === 9 || type === 10 || type === 11 || type === 13;\r\n});\r\n\r\nconst isSNMPType = computed(() => {\r\n  const type = scanFormData.checkType;\r\n  return type === 10 || type === 11 || type === 13;\r\n});\r\n\r\nconst needsAuth = computed(() => {\r\n  return scanFormData.checkType === 13 && (scanFormData.snmpv3Config.securityLevel === '1' || scanFormData.snmpv3Config.securityLevel === '2');\r\n});\r\n\r\nconst needsPriv = computed(() => {\r\n  return scanFormData.checkType === 13 && scanFormData.snmpv3Config.securityLevel === '2';\r\n});\r\n\r\nconst getKeyPlaceholder = () => {\r\n  const type = scanFormData.checkType;\r\n  if (type === 9) {\r\n    return 'ä¾‹å¦‚ï¼šsystem.uname';\r\n  } else if (type === 10 || type === 11 || type === 13) {\r\n    return 'ä¾‹å¦‚ï¼š1.3.6.1.2.1.1.1.0';\r\n  }\r\n  return 'è¯·è¾“å…¥æ£€æŸ¥é”®å€¼';\r\n};\r\n\r\n\r\n\r\n// å·¥å…·å‡½æ•°\r\nconst getStatusText = (status) => {\r\n  const textMap = {\r\n    'active': 'åœ¨ç”¨',\r\n    'available': 'å¯ç”¨',\r\n    'reserved': 'é¢„ç•™',\r\n    'conflict': 'å†²çª'\r\n  };\r\n  return textMap[status] || status;\r\n};\r\n\r\nconst getTypeText = (type) => {\r\n  const typeMap = {\r\n    'static': 'é™æ€IP',\r\n    'dynamic': 'åŠ¨æ€IP',\r\n    'gateway': 'ç½‘å…³',\r\n    'dns': 'DNSæœåŠ¡å™¨'\r\n  };\r\n  return typeMap[type] || type;\r\n};\r\n\r\nconst formatDate = (date) => {\r\n  if (!date) return null;\r\n  return new Date(date).toLocaleString('zh-CN');\r\n};\r\n\r\n// å¼¹çª—çŠ¶æ€\r\nconst detailModalVisible = ref(false);\r\nconst editModalVisible = ref(false);\r\nconst scanModalVisible = ref(false);\r\nconst scanTaskModalVisible = ref(false);\r\nconst taskDetailModalVisible = ref(false);\r\nconst taskResultModalVisible = ref(false);\r\nconst selectedIP = ref(null);\r\nconst editingIP = ref(null);\r\nconst selectedTask = ref(null);\r\n\r\n// æ‰«æä»»åŠ¡æŸ¥è¯¢ç›¸å…³\r\nconst scanTasks = ref([]);\r\nconst taskResults = ref([]);\r\nconst taskLoading = ref(false);\r\nconst resultLoading = ref(false);\r\nconst taskStatusFilter = ref('');\r\nconst taskDateRange = ref([]);\r\nconst taskNameFilter = ref('');\r\nconst taskPagination = reactive({\r\n  current: 1,\r\n  pageSize: 20,\r\n  total: 0,\r\n  showSizeChanger: true,\r\n  showQuickJumper: true,\r\n  showTotal: (total, range) => `ç¬¬ ${range[0]}-${range[1]} æ¡ï¼Œå…± ${total} æ¡`\r\n});\r\n\r\n// è¡¨å•ç›¸å…³\r\nconst formRef = ref();\r\nconst scanFormRef = ref();\r\nconst formData = reactive({\r\n  ipAddress: '',\r\n  hostname: '',\r\n  status: 'available',\r\n  type: 'static',\r\n  macAddress: '',\r\n  device: '',\r\n  subnet: '',\r\n  description: ''\r\n});\r\n\r\n// æ‰«æé…ç½®æ•°æ®\r\nconst scanFormData = reactive({\r\n  ipRanges: '192.168.1.0/24', // IPèŒƒå›´\r\n  checkType: 12, // é»˜è®¤ICMP ping\r\n  ports: '0',\r\n  key: '',\r\n  // Pythonæ‰«æå™¨æ–°å‚æ•°\r\n  maxConcurrent: 100, // æœ€å¤§å¹¶å‘æ•°\r\n  timeout: 3.0, // è¿æ¥è¶…æ—¶æ—¶é—´\r\n  pingTimeout: 1.0, // Pingè¶…æ—¶æ—¶é—´\r\n  // ä¿ç•™çš„Zabbixç›¸å…³å‚æ•°(ä»…ç”¨äºå…¼å®¹æ€§)\r\n  snmpCommunity: 'public',\r\n  snmpv3Config: {\r\n    securityLevel: '0',\r\n    securityName: '',\r\n    contextName: '',\r\n    authProtocol: 0,\r\n    authPassphrase: '',\r\n    privProtocol: 0,\r\n    privPassphrase: ''\r\n  },\r\n  uniqueCheck: 0,\r\n  hostSource: 1,\r\n  nameSource: 0\r\n});\r\n\r\n\r\n\r\n// è¡¨å•éªŒè¯è§„åˆ™\r\nconst rules = {\r\n  ipAddress: [\r\n    { required: true, message: 'è¯·è¾“å…¥IPåœ°å€' },\r\n    { pattern: /^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$/, message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„IPåœ°å€' }\r\n  ],\r\n  status: [{ required: true, message: 'è¯·é€‰æ‹©IPçŠ¶æ€' }],\r\n  type: [{ required: true, message: 'è¯·é€‰æ‹©IPç±»å‹' }]\r\n};\r\n\r\n// æ‰«æé…ç½®éªŒè¯è§„åˆ™\r\nconst scanRules = {\r\n  ipRanges: [\r\n    { required: true, message: 'è¯·è¾“å…¥æ‰«æIPèŒƒå›´' },\r\n    { \r\n      validator: (rule, value) => {\r\n        if (!value) return Promise.reject('è¯·è¾“å…¥IPèŒƒå›´');\r\n        \r\n        const ranges = value.split('\\n').filter(range => range.trim());\r\n        for (const range of ranges) {\r\n          const trimmedRange = range.trim();\r\n          // éªŒè¯å•ä¸ªIP\r\n          const singleIpPattern = /^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$/;\r\n          // éªŒè¯IPèŒƒå›´\r\n          const rangePattern = /^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}-(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$/;\r\n          // éªŒè¯CIDR\r\n          const cidrPattern = /^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\/[0-9]{1,2}$/;\r\n          // éªŒè¯ç®€åŒ–èŒƒå›´æ ¼å¼ (192.168.1.1-100)\r\n          const simpleRangePattern = /^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}-[0-9]{1,3}$/;\r\n          \r\n          if (!singleIpPattern.test(trimmedRange) && \r\n              !rangePattern.test(trimmedRange) && \r\n              !cidrPattern.test(trimmedRange) &&\r\n              !simpleRangePattern.test(trimmedRange)) {\r\n            return Promise.reject(`æ— æ•ˆçš„IPèŒƒå›´æ ¼å¼: ${trimmedRange}`);\r\n          }\r\n        }\r\n        return Promise.resolve();\r\n      }\r\n    }\r\n  ],\r\n  checkType: [{ required: true, message: 'è¯·é€‰æ‹©æ£€æŸ¥ç±»å‹' }],\r\n  maxConcurrent: [\r\n    { type: 'number', min: 1, max: 200, message: 'å¹¶å‘æ•°å¿…é¡»åœ¨1-200ä¹‹é—´' }\r\n  ],\r\n  timeout: [\r\n    { type: 'number', min: 1, max: 30, message: 'è¶…æ—¶æ—¶é—´å¿…é¡»åœ¨1-30ç§’ä¹‹é—´' }\r\n  ],\r\n  pingTimeout: [\r\n    { type: 'number', min: 0.5, max: 10, message: 'Pingè¶…æ—¶æ—¶é—´å¿…é¡»åœ¨0.5-10ç§’ä¹‹é—´' }\r\n  ]\r\n};\r\n\r\n\r\n\r\n// åˆ†é¡µé…ç½®\r\nconst pagination = reactive({\r\n  current: 1,\r\n  pageSize: 20,\r\n  total: 0,\r\n  pageSizeOptions: ['10', '20', '50', '100'],\r\n  showSizeChanger: true,\r\n  showQuickJumper: true,\r\n  showTotal: (total) => `å…± ${total} æ¡è®°å½•`,\r\n});\r\n\r\n// åŠ è½½IPåˆ—è¡¨æ•°æ®\r\nconst loadIPList = async () => {\r\n  loading.value = true;\r\n  try {\r\n    const params = {\r\n      page: pagination.current,\r\n      page_size: pagination.pageSize  // ä½¿ç”¨Djangoæ ‡å‡†çš„page_sizeå‚æ•°å\r\n    };\r\n    \r\n    // æ·»åŠ æœç´¢æ¡ä»¶\r\n    if (searchKeyword.value && searchKeyword.value.trim()) {\r\n      params.search = searchKeyword.value.trim();\r\n    }\r\n    if (ipStatus.value) {\r\n      params.status = ipStatus.value;\r\n    }\r\n    if (ipType.value) {\r\n      params.type = ipType.value;\r\n    }\r\n    \r\n    console.log('æ­£åœ¨è·å–IPåˆ—è¡¨ï¼Œå‚æ•°:', params);\r\n    console.log('å½“å‰åˆ†é¡µçŠ¶æ€:', {\r\n      current: pagination.current,\r\n      pageSize: pagination.pageSize,\r\n      total: pagination.total\r\n    });\r\n    \r\n    const response = await ipAPI.getIPList(params);\r\n    \r\n    console.log('APIå“åº”:', response);\r\n    \r\n    if (response && response.data) {\r\n      // ç‰¹æ®Šæ£€æŸ¥ï¼šå¦‚æœè¿”å›çš„æ˜¯URLè·¯å¾„åˆ—è¡¨ï¼Œè¯´æ˜APIè·¯å¾„é”™è¯¯\r\n      if (response.data.records && response.data['scan-tasks']) {\r\n        console.error('APIè·¯å¾„é”™è¯¯ï¼šè¿”å›çš„æ˜¯å¯ç”¨è·¯å¾„åˆ—è¡¨ï¼Œè€Œä¸æ˜¯æ•°æ®:', response.data);\r\n        message.error('è·å–IPåˆ—è¡¨å¤±è´¥: APIè·¯å¾„é”™è¯¯ï¼Œè¯·æ£€æŸ¥åç«¯é…ç½®');\r\n        setIPData([]);\r\n        pagination.total = 0;\r\n        return;\r\n      }\r\n      \r\n      // æ£€æŸ¥æ˜¯å¦æ˜¯ç»Ÿä¸€å“åº”æ ¼å¼ï¼ˆåŒ…å«codeå­—æ®µï¼‰\r\n      if (response.data.code !== undefined) {\r\n        // ç»Ÿä¸€å“åº”æ ¼å¼\r\n        if (response.data.code === 200) {\r\n          const data = response.data.data;\r\n          // ç¡®ä¿è·å–çš„æ•°æ®æ˜¯æ•°ç»„\r\n          let resultData = [];\r\n          if (data && data.results && Array.isArray(data.results)) {\r\n            resultData = data.results;\r\n          } else if (Array.isArray(data)) {\r\n            resultData = data;\r\n          } else {\r\n            console.warn('APIè¿”å›çš„æ•°æ®ä¸æ˜¯æ•°ç»„æ ¼å¼:', data);\r\n            resultData = [];\r\n          }\r\n          \r\n          setIPData(resultData);\r\n          pagination.total = data.count || data.total || resultData.length;\r\n          console.log('æˆåŠŸè·å–IPåˆ—è¡¨ï¼ˆç»Ÿä¸€æ ¼å¼ï¼‰:', ipData.value);\r\n          message.success('IPåˆ—è¡¨æ•°æ®å·²æ›´æ–°', 1);\r\n        } else {\r\n          console.error('APIè¿”å›é”™è¯¯ä»£ç :', response.data.code, 'é”™è¯¯ä¿¡æ¯:', response.data.message);\r\n          message.error(`è·å–IPåˆ—è¡¨å¤±è´¥: ${response.data.message}`);\r\n          setIPData([]);\r\n          pagination.total = 0;\r\n        }\r\n      } else {\r\n        // DRFæ ‡å‡†å“åº”æ ¼å¼ï¼ˆç›´æ¥åŒ…å«countã€resultså­—æ®µï¼‰\r\n        console.log('æ£€æµ‹åˆ°DRFæ ‡å‡†å“åº”æ ¼å¼');\r\n        // ç¡®ä¿è·å–çš„æ•°æ®æ˜¯æ•°ç»„\r\n        let resultData = [];\r\n        if (response.data.results && Array.isArray(response.data.results)) {\r\n          resultData = response.data.results;\r\n        } else if (Array.isArray(response.data)) {\r\n          resultData = response.data;\r\n        } else {\r\n          console.warn('APIè¿”å›çš„æ•°æ®ä¸æ˜¯æ•°ç»„æ ¼å¼:', response.data);\r\n          resultData = [];\r\n        }\r\n        \r\n        setIPData(resultData);\r\n        pagination.total = response.data.count || response.data.total || resultData.length;\r\n        console.log('æˆåŠŸè·å–IPåˆ—è¡¨ï¼ˆDRFæ ¼å¼ï¼‰:', ipData.value);\r\n        message.success('IPåˆ—è¡¨æ•°æ®å·²æ›´æ–°', 1);\r\n      }\r\n    } else {\r\n      console.error('æ— æ•ˆçš„APIå“åº”:', response);\r\n      message.error('è·å–IPåˆ—è¡¨å¤±è´¥: æ— æ•ˆçš„å“åº”æ•°æ®');\r\n      setIPData([]);\r\n      pagination.total = 0;\r\n    }\r\n  } catch (error) {\r\n    console.error('åŠ è½½IPåˆ—è¡¨å¤±è´¥:', error);\r\n    console.error('é”™è¯¯è¯¦æƒ…:', {\r\n      message: error.message,\r\n      response: error.response,\r\n      request: error.request\r\n    });\r\n    \r\n    let errorMessage = 'è·å–IPåˆ—è¡¨å¤±è´¥';\r\n    if (error.response) {\r\n      // æœåŠ¡å™¨å“åº”é”™è¯¯\r\n      errorMessage += `: HTTP ${error.response.status}`;\r\n      if (error.response.data && error.response.data.message) {\r\n        errorMessage += ` - ${error.response.data.message}`;\r\n      }\r\n    } else if (error.request) {\r\n      // è¯·æ±‚å‘é€ä½†æ— å“åº”\r\n      errorMessage += ': ç½‘ç»œè¿æ¥å¤±è´¥æˆ–æœåŠ¡å™¨æ— å“åº”';\r\n    } else {\r\n      // è¯·æ±‚è®¾ç½®é”™è¯¯\r\n      errorMessage += `: ${error.message}`;\r\n    }\r\n    \r\n    message.error(errorMessage);\r\n    \r\n    // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºç©ºæ•°æ®è€Œä¸æ˜¯æ¨¡æ‹Ÿæ•°æ®\r\n    setIPData([]);\r\n    pagination.total = 0;\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n\r\nconst columns = [\r\n  {\r\n    title: 'IPåœ°å€',\r\n    dataIndex: 'ip_address', // æ•°æ®åº“å­—æ®µå\r\n    key: 'ipAddress',\r\n    width: 70,\r\n    fixed: 'left'\r\n  },\r\n  {\r\n    title: 'æ¥æº',\r\n    dataIndex: 'is_auto_discovered',\r\n    key: 'source',\r\n    width: 100\r\n  },\r\n  {\r\n    title: 'PingçŠ¶æ€',\r\n    dataIndex: 'ping_status', // æ•°æ®åº“å­—æ®µå\r\n    key: 'pingStatus',\r\n    width: 80\r\n  },\r\n  {\r\n    title: 'ç›‘æ§çŠ¶æ€',\r\n    dataIndex: 'monitoring_enabled',\r\n    key: 'monitoringStatus',\r\n    width: 90\r\n  },\r\n  {\r\n    title: 'IPç±»å‹',\r\n    dataIndex: 'type',\r\n    key: 'type',\r\n    width: 80\r\n  },\r\n  {\r\n    title: 'MACåœ°å€',\r\n    dataIndex: 'mac_address', // æ•°æ®åº“å­—æ®µå\r\n    key: 'macAddress',\r\n    width: 150\r\n  },\r\n  {\r\n    title: 'å…³è”èµ„äº§',\r\n    dataIndex: 'device',\r\n    key: 'device',\r\n    width: 150\r\n  },\r\n  {\r\n    title: 'æ‰€å±ç½‘æ®µ',\r\n    dataIndex: 'subnet',\r\n    key: 'subnet',\r\n    width: 140\r\n  },\r\n  {\r\n    title: 'æœ€ååœ¨çº¿æ—¶é—´',\r\n    dataIndex: 'last_seen', // æ•°æ®åº“å­—æ®µå\r\n    key: 'lastSeen',\r\n    width: 160\r\n  },\r\n  {\r\n    title: 'æ“ä½œ',\r\n    key: 'operation',\r\n    fixed: 'right',\r\n    width: 280\r\n  }\r\n];\r\n\r\n// æ‰«æä»»åŠ¡è¡¨æ ¼åˆ—å®šä¹‰\r\n\r\n// æ‰«æç»“æœè¡¨æ ¼åˆ—å®šä¹‰\r\nconst resultColumns = [\r\n  {\r\n    title: 'IPåœ°å€',\r\n    dataIndex: 'ip_address',\r\n    key: 'ip_address',\r\n    width: 90,\r\n  },\r\n  {\r\n    title: 'ä¸»æœºå',\r\n    dataIndex: 'hostname',\r\n    key: 'hostname',\r\n    ellipsis: true\r\n  },\r\n  {\r\n    title: 'MACåœ°å€',\r\n    dataIndex: 'mac_address',\r\n    key: 'mac_address'\r\n  },\r\n  {\r\n    title: 'çŠ¶æ€',\r\n    dataIndex: 'status',\r\n    key: 'status'\r\n  },\r\n  {\r\n    title: 'å“åº”æ—¶é—´',\r\n    dataIndex: 'response_time',\r\n    key: 'response_time'\r\n  },\r\n  {\r\n    title: 'å‘ç°æ—¶é—´',\r\n    dataIndex: 'created_at',\r\n    key: 'created_at'\r\n  }\r\n];\r\n\r\n// äº‹ä»¶å¤„ç†å‡½æ•°\r\n// æ‰¹é‡pingçŠ¶æ€ç®¡ç†\r\nconst batchPingState = reactive({\r\n  isVisible: false,\r\n  phase: 'confirm', // confirm, testing, result\r\n  stats: {\r\n    total: 0,\r\n    currentOnline: 0,\r\n    currentOffline: 0,\r\n    testResult: null\r\n  },\r\n  testing: {\r\n    progress: 0,\r\n    currentIP: '',\r\n    startTime: null\r\n  }\r\n});\r\n\r\nconst handleBatchPing = async () => {\r\n  try {\r\n    // è·å–å½“å‰é¡µé¢çš„æ‰€æœ‰IP ID\r\n    const allIpIds = ipData.value.map(ip => ip.id).filter(id => id);\r\n    \r\n    if (allIpIds.length === 0) {\r\n      message.warning('æ²¡æœ‰å¯ä»¥pingçš„IPè®°å½•');\r\n      return;\r\n    }\r\n    \r\n    // åˆå§‹åŒ–çŠ¶æ€\r\n    batchPingState.stats.total = allIpIds.length;\r\n    batchPingState.stats.currentOnline = ipData.value.filter(ip => ip.ping_status === 'online' || ip.pingStatus === 'online').length;\r\n    batchPingState.stats.currentOffline = allIpIds.length - batchPingState.stats.currentOnline;\r\n    batchPingState.phase = 'confirm';\r\n    batchPingState.isVisible = true;\r\n    \r\n  } catch (error) {\r\n    console.error('åˆå§‹åŒ–æ‰¹é‡pingå¤±è´¥:', error);\r\n    message.error('åˆå§‹åŒ–æ‰¹é‡pingå¤±è´¥');\r\n  }\r\n};\r\n\r\n// å¼€å§‹pingæµ‹è¯•\r\nconst startBatchPingTest = async () => {\r\n  try {\r\n    const allIpIds = ipData.value.map(ip => ip.id).filter(id => id);\r\n    \r\n    // åˆ‡æ¢åˆ°æµ‹è¯•é˜¶æ®µ\r\n    batchPingState.phase = 'testing';\r\n    batchPingState.testing.startTime = new Date();\r\n    batchPingState.testing.progress = 0;\r\n    \r\n    loading.value = true;\r\n    \r\n    // è°ƒç”¨æ‰¹é‡ping API\r\n    const response = await ipAPI.batchPingIPs(allIpIds);\r\n    \r\n    if (response.data && response.data.code === 200) {\r\n      const batchData = response.data.data;\r\n      const summary = batchData.summary;\r\n      \r\n      // æ›´æ–°æœ¬åœ°æ•°æ®\r\n      const resultsMap = new Map();\r\n      batchData.results.forEach(result => {\r\n        resultsMap.set(result.ip_id, result);\r\n      });\r\n      \r\n      // æ›´æ–°ipDataä¸­çš„è®°å½•\r\n      ipData.value.forEach(ip => {\r\n        const result = resultsMap.get(ip.id);\r\n        if (result) {\r\n          ip.ping_status = result.status;\r\n          ip.pingStatus = result.status; // å…¼å®¹å­—æ®µ\r\n          if (result.is_online) {\r\n            ip.last_seen = new Date().toISOString();\r\n            ip.lastSeen = new Date().toISOString(); // å…¼å®¹å­—æ®µ\r\n          }\r\n        }\r\n      });\r\n      \r\n      // è®¾ç½®æµ‹è¯•ç»“æœå¹¶åˆ‡æ¢åˆ°ç»“æœé˜¶æ®µ\r\n      batchPingState.stats.testResult = summary;\r\n      batchPingState.phase = 'result';\r\n      \r\n    } else {\r\n      message.error(`æ‰¹é‡pingæµ‹è¯•å¤±è´¥: ${response.data?.message || 'æœªçŸ¥é”™è¯¯'}`);\r\n      batchPingState.isVisible = false;\r\n    }\r\n  } catch (error) {\r\n    console.error('æ‰¹é‡pingæµ‹è¯•å¤±è´¥:', error);\r\n    let errorMessage = 'æ‰¹é‡pingæµ‹è¯•å¤±è´¥';\r\n    if (error.response && error.response.data) {\r\n      errorMessage += `: ${error.response.data.message || error.response.data.error || 'ç½‘ç»œé”™è¯¯'}`;\r\n    } else if (error.message) {\r\n      errorMessage += `: ${error.message}`;\r\n    }\r\n    message.error(errorMessage);\r\n    batchPingState.isVisible = false;\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n// å…³é—­æ‰¹é‡pingå¼¹çª—\r\nconst closeBatchPingModal = () => {\r\n  batchPingState.isVisible = false;\r\n  batchPingState.phase = 'confirm';\r\n  batchPingState.stats.testResult = null;\r\n  batchPingState.testing.progress = 0;\r\n};\r\n\r\n// è¡Œé€‰æ‹©ç®¡ç†\r\nconst onSelectChange = (newSelectedRowKeys) => {\r\n  console.log('é€‰ä¸­çš„è¡Œ keys:', newSelectedRowKeys);\r\n  selectedRowKeys.value = newSelectedRowKeys;\r\n};\r\n\r\nconst onSelectAll = (selected, selectedRows, changeRows) => {\r\n  console.log('å…¨é€‰/åé€‰:', { selected, selectedRows: selectedRows.length, changeRows: changeRows.length });\r\n};\r\n\r\nconst clearSelection = () => {\r\n  selectedRowKeys.value = [];\r\n};\r\n\r\n// æ‰¹é‡åˆ é™¤\r\nconst handleBatchDelete = async () => {\r\n  if (selectedRowKeys.value.length === 0) {\r\n    message.warning('è¯·é€‰æ‹©è¦åˆ é™¤çš„IPåœ°å€');\r\n    return;\r\n  }\r\n\r\n  try {\r\n    Modal.confirm({\r\n      title: 'æ‰¹é‡åˆ é™¤ç¡®è®¤',\r\n      content: `æ‚¨å°†åˆ é™¤ ${selectedRowKeys.value.length} ä¸ªIPåœ°å€ï¼Œæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`,\r\n      okText: 'ç¡®è®¤åˆ é™¤',\r\n      okType: 'danger',\r\n      cancelText: 'å–æ¶ˆ',\r\n      onOk: async () => {\r\n        batchDeleting.value = true;\r\n        try {\r\n          const response = await ipAPI.batchDeleteIPs(selectedRowKeys.value);\r\n          \r\n          if (response.data && response.data.code === 200) {\r\n            const result = response.data.data;\r\n            message.success(`æ‰¹é‡åˆ é™¤æˆåŠŸï¼åˆ é™¤: ${result.deleted_count} ä¸ªï¼Œå¤±è´¥: ${result.failed_count} ä¸ª`, 1);\r\n            \r\n            // æ¸…ç©ºé€‰ä¸­çŠ¶æ€\r\n            clearSelection();\r\n            \r\n            // åˆ·æ–°åˆ—è¡¨\r\n            await loadIPList();\r\n          } else {\r\n            message.error(`æ‰¹é‡åˆ é™¤å¤±è´¥: ${response.data?.message || 'æœªçŸ¥é”™è¯¯'}`);\r\n          }\r\n        } catch (error) {\r\n          console.error('æ‰¹é‡åˆ é™¤å¤±è´¥:', error);\r\n          message.error(`æ‰¹é‡åˆ é™¤å¤±è´¥: ${error.message}`);\r\n        } finally {\r\n          batchDeleting.value = false;\r\n        }\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('æ‰¹é‡åˆ é™¤æ“ä½œå¤±è´¥:', error);\r\n    message.error('æ‰¹é‡åˆ é™¤æ“ä½œå¤±è´¥');\r\n  }\r\n};\r\n\r\n// æ‰¹é‡åˆ‡æ¢ç›‘æ§çŠ¶æ€\r\nconst handleBatchToggleMonitoring = async (enableMonitoring) => {\r\n  if (selectedRowKeys.value.length === 0) {\r\n    message.warning('è¯·é€‰æ‹©è¦æ“ä½œçš„IPåœ°å€');\r\n    return;\r\n  }\r\n\r\n  const actionText = enableMonitoring ? 'å¯ç”¨ç›‘æ§' : 'ç¦ç”¨ç›‘æ§';\r\n  \r\n  try {\r\n    Modal.confirm({\r\n      title: `æ‰¹é‡${actionText}`,\r\n      content: `æ‚¨å°†å¯¹ ${selectedRowKeys.value.length} ä¸ªIPåœ°å€${actionText}ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ`,\r\n      okText: `ç¡®è®¤${actionText}`,\r\n      cancelText: 'å–æ¶ˆ',\r\n      onOk: async () => {\r\n        batchMonitoringToggling.value = true;\r\n        try {\r\n          const response = await ipAPI.batchToggleMonitoring(selectedRowKeys.value, enableMonitoring);\r\n          \r\n          if (response.data && response.data.code === 200) {\r\n            const result = response.data.data;\r\n            message.success(`æ‰¹é‡${actionText}æˆåŠŸï¼æˆåŠŸ: ${result.success_count} ä¸ªï¼Œå¤±è´¥: ${result.failed_count} ä¸ª`, 1);\r\n            \r\n            // æ›´æ–°æœ¬åœ°æ•°æ®\r\n            ipData.value.forEach(ip => {\r\n              if (selectedRowKeys.value.includes(ip.id)) {\r\n                ip.monitoring_enabled = enableMonitoring;\r\n              }\r\n            });\r\n            \r\n            // æ¸…ç©ºé€‰ä¸­çŠ¶æ€\r\n            clearSelection();\r\n          } else {\r\n            message.error(`æ‰¹é‡${actionText}å¤±è´¥: ${response.data?.message || 'æœªçŸ¥é”™è¯¯'}`);\r\n          }\r\n        } catch (error) {\r\n          console.error(`æ‰¹é‡${actionText}å¤±è´¥:`, error);\r\n          message.error(`æ‰¹é‡${actionText}å¤±è´¥: ${error.message}`);\r\n        } finally {\r\n          batchMonitoringToggling.value = false;\r\n        }\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error(`æ‰¹é‡${actionText}æ“ä½œå¤±è´¥:`, error);\r\n    message.error(`æ‰¹é‡${actionText}æ“ä½œå¤±è´¥`);\r\n  }\r\n};\r\n\r\n// å•ä¸ªç›‘æ§çŠ¶æ€åˆ‡æ¢\r\nconst handleToggleMonitoring = async (record, enableMonitoring) => {\r\n  if (enableMonitoring) {\r\n    // å¯ç”¨ç›‘æ§æ—¶æ˜¾ç¤ºæ¨¡æ¿é€‰æ‹©æŠ½å±‰\r\n    selectedIP.value = record;\r\n    await loadZabbixTemplates(record.id);\r\n    templateDrawerVisible.value = true;\r\n  } else {\r\n    // ç›´æ¥ç¦ç”¨ç›‘æ§\r\n    await toggleMonitoringStatus(record, false);\r\n  }\r\n};\r\n\r\n// åˆ‡æ¢ç›‘æ§çŠ¶æ€çš„å®é™…æ–¹æ³•\r\nconst toggleMonitoringStatus = async (record, enableMonitoring) => {\r\n  const actionText = enableMonitoring ? 'å¯ç”¨ç›‘æ§' : 'ç¦ç”¨ç›‘æ§';\r\n  \r\n  // è®¾ç½®å•ä¸ªè®°å½•çš„åŠ è½½çŠ¶æ€\r\n  record.monitoringToggling = true;\r\n  \r\n  try {\r\n    const response = await ipAPI.toggleMonitoring(record.id, enableMonitoring);\r\n    \r\n    if (response.data && response.data.code === 200) {\r\n      // æ›´æ–°æœ¬åœ°æ•°æ®\r\n      record.monitoring_enabled = enableMonitoring;\r\n      message.success(`${record.ip_address || record.ipAddress} ${actionText}æˆåŠŸ`, 1);\r\n    } else {\r\n      message.error(`${actionText}å¤±è´¥: ${response.data?.message || 'æœªçŸ¥é”™è¯¯'}`);\r\n    }\r\n  } catch (error) {\r\n    console.error(`${actionText}å¤±è´¥:`, error);\r\n    message.error(`${actionText}å¤±è´¥: ${error.message}`);\r\n  } finally {\r\n    record.monitoringToggling = false;\r\n  }\r\n};\r\n\r\n// åŠ è½½Zabbixæ¨¡æ¿åˆ—è¡¨\r\nconst loadZabbixTemplates = async (ipId) => {\r\n  templateLoading.value = true;\r\n  try {\r\n    const response = await ipAPI.getZabbixTemplates(ipId, templateSearchKeyword.value);\r\n    \r\n    if (response.data && response.data.code === 200) {\r\n      zabbixTemplates.value = response.data.data.templates || [];\r\n      \r\n      // åˆå§‹åŒ–å±•å¼€çŠ¶æ€ï¼Œé»˜è®¤å±•å¼€æ‰€æœ‰åˆ†ç±»\r\n      nextTick(() => {\r\n        try {\r\n          const categories = Object.keys(groupedTemplates.value || {});\r\n          categories.forEach(category => {\r\n            const categoryStr = String(category);\r\n            expandedCategories.value[categoryStr] = true;\r\n          });\r\n        } catch (error) {\r\n          console.warn('åˆå§‹åŒ–å±•å¼€çŠ¶æ€é”™è¯¯:', error);\r\n        }\r\n      });\r\n      \r\n      console.log('æˆåŠŸåŠ è½½æ¨¡æ¿åˆ—è¡¨:', zabbixTemplates.value.length, 'ä¸ªæ¨¡æ¿');\r\n    } else {\r\n      // æ£€æŸ¥æ˜¯å¦æ˜¯Zabbixè¿æ¥é—®é¢˜\r\n      if (response.data && response.data.message && response.data.message.includes('Zabbix APIè¿æ¥ä¸å¯ç”¨')) {\r\n        // æ˜¾ç¤ºè¯¦ç»†çš„è¯Šæ–­ä¿¡æ¯\r\n        const errorMessage = 'âš ï¸ ZabbixæœåŠ¡å™¨è¿æ¥å¤±è´¥';\r\n        const suggestions = [\r\n          'è¯·æ£€æŸ¥ZabbixæœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ',\r\n          'éªŒè¯ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®',\r\n          'æ£€æŸ¥Zabbix APIé…ç½®æ˜¯å¦æ­£ç¡®'\r\n        ];\r\n        \r\n        Modal.error({\r\n          title: 'æ— æ³•åŠ è½½ç›‘æ§æ¨¡æ¿',\r\n          content: h('div', [\r\n            h('p', { style: 'margin-bottom: 16px;' }, errorMessage),\r\n            h('div', { style: 'background: #f5f5f5; padding: 12px; border-radius: 6px;' }, [\r\n              h('p', { style: 'margin: 0 0 8px 0; font-weight: 600;' }, 'è§£å†³å»ºè®®ï¼š'),\r\n              h('ul', { style: 'margin: 0; padding-left: 20px;' }, \r\n                suggestions.map(suggestion => \r\n                  h('li', { style: 'margin-bottom: 4px;' }, suggestion)\r\n                )\r\n              )\r\n            ])\r\n          ]),\r\n          width: 500\r\n        });\r\n      } else {\r\n        message.error(`åŠ è½½æ¨¡æ¿åˆ—è¡¨å¤±è´¥: ${response.data?.message || 'æœªçŸ¥é”™è¯¯'}`);\r\n      }\r\n      \r\n      zabbixTemplates.value = [];\r\n    }\r\n  } catch (error) {\r\n    console.error('åŠ è½½æ¨¡æ¿åˆ—è¡¨å¤±è´¥:', error);\r\n    \r\n    // æ£€æŸ¥æ˜¯å¦æ˜¯ç½‘ç»œè¿æ¥é—®é¢˜\r\n    if (error.message && (error.message.includes('Network Error') || error.message.includes('timeout'))) {\r\n      Modal.error({\r\n        title: 'ç½‘ç»œè¿æ¥å¤±è´¥',\r\n        content: 'æ— æ³•è¿æ¥åˆ°åç«¯æœåŠ¡å™¨ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒæœåŠ¡å™¨çŠ¶æ€ã€‚'\r\n      });\r\n    } else {\r\n      message.error(`åŠ è½½æ¨¡æ¿åˆ—è¡¨å¤±è´¥: ${error.message}`);\r\n    }\r\n    \r\n    zabbixTemplates.value = [];\r\n  } finally {\r\n    templateLoading.value = false;\r\n  }\r\n};\r\n\r\n// æœç´¢æ¨¡æ¿\r\nconst handleTemplateSearch = async () => {\r\n  if (selectedIP.value) {\r\n    await loadZabbixTemplates(selectedIP.value.id);\r\n  }\r\n};\r\n\r\n// æ¨¡æ¿é€‰æ‹©å˜åŒ– - ç¡®ä¿ç±»å‹å®‰å…¨\r\nconst handleTemplateSelect = (templateIds) => {\r\n  try {\r\n    // ç¡®ä¿ templateIds æ˜¯æ•°ç»„å¹¶ä¸”æ‰€æœ‰å…ƒç´ éƒ½æ˜¯å­—ç¬¦ä¸²\r\n    if (Array.isArray(templateIds)) {\r\n      selectedTemplateIds.value = templateIds.map(id => {\r\n        if (id === null || id === undefined) return '';\r\n        return String(id);\r\n      });\r\n    } else {\r\n      selectedTemplateIds.value = [];\r\n    }\r\n    console.log('å·²é€‰æ‹©æ¨¡æ¿:', selectedTemplateIds.value);\r\n  } catch (error) {\r\n    console.error('å¤„ç†æ¨¡æ¿é€‰æ‹©æ—¶å‡ºé”™:', error);\r\n    selectedTemplateIds.value = [];\r\n  }\r\n};\r\n\r\n// åˆ›å»ºç›‘æ§ä¸»æœº\r\nconst handleCreateMonitoring = async () => {\r\n  if (!selectedIP.value) {\r\n    message.error('è¯·å…ˆé€‰æ‹©IPåœ°å€');\r\n    return;\r\n  }\r\n  \r\n  if (selectedTemplateIds.value.length === 0) {\r\n    message.error('è¯·é€‰æ‹©è‡³å°‘ä¸€ä¸ªç›‘æ§æ¨¡æ¿');\r\n    return;\r\n  }\r\n  \r\n  monitoringCreating.value = true;\r\n  \r\n  try {\r\n    const monitoringData = {\r\n      template_ids: selectedTemplateIds.value,\r\n      host_name: selectedIP.value.hostname || selectedIP.value.ip_address || selectedIP.value.ipAddress,\r\n      group_ids: [] // ä½¿ç”¨é»˜è®¤ä¸»æœºç»„\r\n    };\r\n    \r\n    const response = await ipAPI.createMonitoring(selectedIP.value.id, monitoringData);\r\n    \r\n    if (response.data && response.data.code === 200) {\r\n      const result = response.data.data;\r\n      \r\n      message.success({\r\n        content: `ç›‘æ§ä¸»æœºåˆ›å»ºæˆåŠŸï¼\\nä¸»æœºå: ${result.host_name}\\nIP: ${result.ip_address}\\næ¨¡æ¿æ•°é‡: ${result.template_count}`,\r\n        duration: 5\r\n      });\r\n      \r\n      // æ›´æ–°æœ¬åœ°IPè®°å½•çš„ç›‘æ§çŠ¶æ€\r\n      selectedIP.value.monitoring_enabled = true;\r\n      \r\n      // å…³é—­æŠ½å±‰\r\n      templateDrawerVisible.value = false;\r\n      \r\n      // æ¸…ç©ºé€‰ä¸­çš„æ¨¡æ¿\r\n      selectedTemplateIds.value = [];\r\n      \r\n    } else {\r\n      message.error(`åˆ›å»ºç›‘æ§ä¸»æœºå¤±è´¥: ${response.data?.message || 'æœªçŸ¥é”™è¯¯'}`);\r\n    }\r\n  } catch (error) {\r\n    console.error('åˆ›å»ºç›‘æ§ä¸»æœºå¤±è´¥:', error);\r\n    message.error(`åˆ›å»ºç›‘æ§ä¸»æœºå¤±è´¥: ${error.message}`);\r\n  } finally {\r\n    monitoringCreating.value = false;\r\n  }\r\n};\r\n\r\n// å…³é—­æ¨¡æ¿æŠ½å±‰\r\n// å®‰å…¨è·å–æ¨¡æ¿çš„å”¯ä¸€key\r\nconst getTemplateKey = (template) => {\r\n  try {\r\n    if (!template) return Math.random().toString();\r\n    if (template.templateid) return String(template.templateid);\r\n    if (template.id) return String(template.id);\r\n    return Math.random().toString();\r\n  } catch (error) {\r\n    console.error('è·å–æ¨¡æ¿keyå¤±è´¥:', error);\r\n    return Math.random().toString();\r\n  }\r\n};\r\n\r\n// å®‰å…¨è·å–æ¨¡æ¿çš„value\r\nconst getTemplateValue = (template) => {\r\n  try {\r\n    if (!template) return '';\r\n    if (template.templateid) return String(template.templateid);\r\n    if (template.id) return String(template.id);\r\n    return '';\r\n  } catch (error) {\r\n    console.error('è·å–æ¨¡æ¿valueå¤±è´¥:', error);\r\n    return '';\r\n  }\r\n};\r\n\r\nconst handleCloseTemplateDrawer = () => {\r\n  templateDrawerVisible.value = false;\r\n  selectedTemplateIds.value = [];\r\n  templateSearchKeyword.value = '';\r\n  selectedCategory.value = '';\r\n  expandedCategories.value = {};\r\n  selectedIP.value = null;\r\n};\r\n\r\n// æ¨¡æ¿æ•°æ®å®‰å…¨éªŒè¯å‡½æ•°\r\nconst validateTemplateData = (template) => {\r\n  try {\r\n    if (!template || typeof template !== 'object') {\r\n      console.warn('æ¨¡æ¿ä¸æ˜¯æœ‰æ•ˆå¯¹è±¡:', template);\r\n      return null;\r\n    }\r\n    \r\n    // å®‰å…¨åœ°è·å–æ‰€æœ‰å­—æ®µ\r\n    const safeTemplate = {\r\n      templateid: safeString(template.templateid || template.id || `temp_${Date.now()}`),\r\n      name: safeString(template.name || 'æœªçŸ¥æ¨¡æ¿'),\r\n      description: safeString(template.description || ''),\r\n      category: safeString(template.category || 'ğŸ“ å…¶ä»–'),\r\n      items_count: Number(template.items_count) || 0,\r\n      triggers_count: Number(template.triggers_count) || 0,\r\n      macros_count: Number(template.macros_count) || 0,\r\n      groups: Array.isArray(template.groups) ? template.groups.map(group => ({\r\n        groupid: safeString(group.groupid || group.id || ''),\r\n        name: safeString(group.name || 'æœªçŸ¥ç»„')\r\n      })) : [],\r\n      icon: safeString(template.icon || 'setting')\r\n    };\r\n    \r\n    // éªŒè¯å¿…éœ€å­—æ®µ\r\n    if (!safeTemplate.templateid || !safeTemplate.name) {\r\n      console.warn('æ¨¡æ¿ç¼ºå°‘å¿…éœ€å­—æ®µ:', safeTemplate);\r\n      return null;\r\n    }\r\n    \r\n    return safeTemplate;\r\n  } catch (error) {\r\n    console.error('éªŒè¯æ¨¡æ¿æ—¶å‡ºé”™:', error, template);\r\n    return null;\r\n  }\r\n};\r\n\r\n// æŒ‰åˆ†ç±»ç»„ç»‡æ¨¡æ¿ - å¢å¼ºç±»å‹å®‰å…¨\r\nconst groupedTemplates = computed(() => {\r\n  const groups = {};\r\n  \r\n  try {\r\n    if (!Array.isArray(zabbixTemplates.value)) {\r\n      console.warn('zabbixTemplatesä¸æ˜¯æ•°ç»„:', zabbixTemplates.value);\r\n      return groups;\r\n    }\r\n    \r\n    zabbixTemplates.value.forEach((template) => {\r\n      const safeTemplate = validateTemplateData(template);\r\n      if (!safeTemplate) {\r\n        return; // è·³è¿‡æ— æ•ˆæ¨¡æ¿\r\n      }\r\n      \r\n      const category = safeTemplate.category;\r\n      if (!groups[category]) {\r\n        groups[category] = [];\r\n      }\r\n      \r\n      groups[category].push(safeTemplate);\r\n    });\r\n    \r\n    // å¯¹æ¯ä¸ªåˆ†ç±»çš„æ¨¡æ¿æŒ‰åç§°æ’åº\r\n    Object.keys(groups).forEach(category => {\r\n      try {\r\n        groups[category].sort((a, b) => {\r\n          const nameA = safeString(a.name || '');\r\n          const nameB = safeString(b.name || '');\r\n          return nameA.localeCompare(nameB);\r\n        });\r\n      } catch (sortError) {\r\n        console.warn(`æ’åºåˆ†ç±»${category}æ—¶å‡ºé”™:`, sortError);\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('groupedTemplatesè®¡ç®—å‡ºé”™:', error);\r\n  }\r\n  \r\n  return groups;\r\n});\r\n\r\n// åˆ†ç±»å›¾æ ‡æ˜ å°„ - å¢å¼ºç±»å‹å®‰å…¨\r\nconst getCategoryIcon = (category) => {\r\n  try {\r\n    const categoryStr = safeCategoryToString(category);\r\n    const iconMap = {\r\n      'ğŸ’» æ“ä½œç³»ç»Ÿ': 'DesktopOutlined',\r\n      'ğŸ—„ æ•°æ®åº“': 'DatabaseOutlined', \r\n      'ğŸŒ WebæœåŠ¡å™¨': 'GlobalOutlined',\r\n      'ğŸ“¦ å®¹å™¨å¹³å°': 'ContainerOutlined',\r\n      'ğŸŒ ç½‘ç»œè®¾å¤‡': 'RouterOutlined',\r\n      'â˜ï¸ è™šæ‹ŸåŒ–': 'CloudOutlined',\r\n      'ğŸ“Š ç½‘ç»œç›‘æ§': 'WifiOutlined',\r\n      'â˜ï¸ äº‘æœåŠ¡': 'CloudServerOutlined',\r\n      'ğŸš€ åº”ç”¨æœåŠ¡': 'CodeOutlined',\r\n      'ğŸ“¬ æ¶ˆæ¯é˜Ÿåˆ—': 'MessageOutlined',\r\n      'âš¡ ç¼“å­˜ç³»ç»Ÿ': 'ThunderboltOutlined',\r\n      'ğŸ’¾ å­˜å‚¨ç³»ç»Ÿ': 'HddOutlined',\r\n      'ğŸ”’ å®‰å…¨ç›‘æ§': 'SafetyOutlined',\r\n      'ğŸŒ¡ï¸ IoTè®¾å¤‡': 'NodeIndexOutlined',\r\n      'ğŸ“ å…¶ä»–': 'SettingOutlined'\r\n    };\r\n    \r\n    return iconMap[categoryStr] || 'SettingOutlined';\r\n  } catch (error) {\r\n    console.warn('getCategoryIconå¤„ç†é”™è¯¯:', error, category);\r\n    return 'SettingOutlined';\r\n  }\r\n};\r\n\r\n// åˆ†ç±»ç»Ÿè®¡ä¿¡æ¯ - å¢å¼ºç±»å‹å®‰å…¨\r\nconst categoryStats = computed(() => {\r\n  const stats = {};\r\n  \r\n  try {\r\n    if (!groupedTemplates.value || typeof groupedTemplates.value !== 'object') {\r\n      return stats;\r\n    }\r\n    \r\n    Object.entries(groupedTemplates.value).forEach(([category, templates]) => {\r\n      try {\r\n        const categoryKey = safeCategoryToString(category);\r\n        if (!Array.isArray(templates)) {\r\n          console.warn(`åˆ†ç±»${categoryKey}çš„æ¨¡æ¿ä¸æ˜¯æ•°ç»„:`, templates);\r\n          stats[categoryKey] = { count: 0, selected: 0 };\r\n          return;\r\n        }\r\n        \r\n        const selectedIds = Array.isArray(selectedTemplateIds.value) ? selectedTemplateIds.value : [];\r\n        \r\n        stats[categoryKey] = {\r\n          count: Number(templates.length) || 0,\r\n          selected: templates.filter(t => {\r\n            try {\r\n              const templateId = safeString(t.templateid || t.id || '');\r\n              return selectedIds.includes(templateId);\r\n            } catch (filterError) {\r\n              console.warn('è¿‡æ»¤æ¨¡æ¿æ—¶å‡ºé”™:', filterError, t);\r\n              return false;\r\n            }\r\n          }).length\r\n        };\r\n      } catch (categoryError) {\r\n        console.warn(`å¤„ç†åˆ†ç±»${category}ç»Ÿè®¡æ—¶å‡ºé”™:`, categoryError);\r\n        stats[safeCategoryToString(category)] = { count: 0, selected: 0 };\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('categoryStatsè®¡ç®—å‡ºé”™:', error);\r\n  }\r\n  \r\n  return stats;\r\n});\r\n\r\n// ç­›é€‰åçš„æ¨¡æ¿ - å¢å¼ºç±»å‹å®‰å…¨\r\nconst filteredTemplates = computed(() => {\r\n  try {\r\n    let result = groupedTemplates.value || {};\r\n    \r\n    // åˆ†ç±»ç­›é€‰\r\n    if (selectedCategory.value) {\r\n      const categoryStr = safeString(selectedCategory.value);\r\n      result = {\r\n        [categoryStr]: result[categoryStr] || []\r\n      };\r\n    }\r\n    \r\n    return result;\r\n  } catch (error) {\r\n    console.error('filteredTemplatesè®¡ç®—å‡ºé”™:', error);\r\n    return {};\r\n  }\r\n});\r\n\r\n// å®‰å…¨çš„åˆ†ç±»æ˜¾ç¤ºåç§°å‡½æ•°\r\nconst safeCategoryDisplayName = (category) => {\r\n  try {\r\n    return safeCategoryToString(category);\r\n  } catch (error) {\r\n    console.error('safeCategoryDisplayNameå¤„ç†é”™è¯¯:', error, category);\r\n    return 'ğŸ“ å…¶ä»–';\r\n  }\r\n};\r\n\r\n// åˆ‡æ¢åˆ†ç±»ç­›é€‰ - ç¡®ä¿ç±»å‹å®‰å…¨\r\nconst toggleCategoryFilter = (category) => {\r\n  try {\r\n    const categoryStr = safeCategoryToString(category);\r\n    if (selectedCategory.value === categoryStr) {\r\n      selectedCategory.value = '';\r\n    } else {\r\n      selectedCategory.value = categoryStr;\r\n    }\r\n  } catch (error) {\r\n    console.warn('toggleCategoryFilterå¤„ç†é”™è¯¯:', error, category);\r\n    selectedCategory.value = '';\r\n  }\r\n};\r\n\r\n// æ¸…é™¤åˆ†ç±»ç­›é€‰\r\nconst clearCategoryFilter = () => {\r\n  selectedCategory.value = '';\r\n};\r\n\r\n// åˆ‡æ¢åˆ†ç±»å±•å¼€çŠ¶æ€ - ä½¿ç”¨å®‰å…¨çš„ç±»å‹è½¬æ¢\r\nconst toggleCategoryExpand = (category) => {\r\n  try {\r\n    const categoryStr = safeCategoryToString(category);\r\n    expandedCategories.value[categoryStr] = !expandedCategories.value[categoryStr];\r\n  } catch (error) {\r\n    console.warn('toggleCategoryExpandå¤„ç†é”™è¯¯:', error, category);\r\n  }\r\n};\r\n\r\n// å®‰å…¨æ£€æŸ¥åˆ†ç±»æ˜¯å¦å±•å¼€ - é¿å…å¯¹è±¡ç±»å‹è½¬æ¢é”™è¯¯\r\nconst isCategoryExpanded = (category) => {\r\n  // æ£€æŸ¥æ˜¯å¯¹è±¡è¿˜æ˜¯å­—ç¬¦ä¸²\r\n  if (typeof category === 'object') {\r\n    try {\r\n      return isCategoryExpanded(JSON.stringify(category));\r\n    } catch (jsonError) {\r\n      console.warn('å¯¹è±¡è½¬å­—ç¬¦ä¸²å¤±è´¥:', jsonError);\r\n      return true; // é»˜è®¤å±•å¼€\r\n    }\r\n  }\r\n\r\n  try {\r\n    if (category === null || category === undefined) {\r\n      return true;\r\n    }\r\n    const categoryStr = safeCategoryToString(category);\r\n    // é»˜è®¤å±•å¼€æ‰€æœ‰åˆ†ç±»ï¼Œé™¤éæ˜ç¡®è®¾ç½®ä¸ºfalse\r\n    return expandedCategories.value[categoryStr] !== false;\r\n  } catch (error) {\r\n    console.warn('isCategoryExpandedå¤„ç†é”™è¯¯:', error, category);\r\n    return true; // é»˜è®¤å±•å¼€\r\n  }\r\n};\r\n\r\n// å®‰å…¨çš„åˆ†ç±»è½¬å­—ç¬¦ä¸²å‡½æ•° - æ ¹æ®è§„èŒƒå¤„ç†å„ç§ç±»å‹\r\nconst safeCategoryToString = (category) => {\r\n  try {\r\n    if (category === null || category === undefined) {\r\n      return 'ğŸ“ å…¶ä»–';\r\n    }\r\n    \r\n    if (typeof category === 'string') {\r\n      return category.trim() || 'ğŸ“ å…¶ä»–';\r\n    }\r\n    \r\n    if (typeof category === 'object') {\r\n      // å¦‚æœæ˜¯å¯¹è±¡ï¼Œå°è¯•æå–æœ‰æ•ˆå±æ€§\r\n      if (category.name && typeof category.name === 'string') {\r\n        return category.name.trim();\r\n      }\r\n      if (category.title && typeof category.title === 'string') {\r\n        return category.title.trim();\r\n      }\r\n      if (category.label && typeof category.label === 'string') {\r\n        return category.label.trim();\r\n      }\r\n      \r\n      // å°è¯•ä½¿ç”¨JSON.stringifyå®‰å…¨åœ°è½¬æ¢å¯¹è±¡\r\n      try {\r\n        const jsonStr = JSON.stringify(category);\r\n        if (jsonStr && jsonStr !== '[object Object]') {\r\n          return jsonStr;\r\n        }\r\n      } catch (jsonError) {\r\n        // JSONè½¬æ¢å¤±è´¥æ—¶ç»§ç»­å¤„ç†\r\n        console.warn('JSONè½¬æ¢å¤±è´¥:', jsonError);\r\n      }\r\n      \r\n      // å¯¹è±¡è½¬æ¢å¤±è´¥æ—¶çš„å®‰å…¨å¤„ç†\r\n      console.warn('åˆ†ç±»æ˜¯å¯¹è±¡ä½†ç¼ºå°‘æœ‰æ•ˆå­—æ®µ:', category);\r\n      return 'ğŸ“ å…¶ä»–';\r\n    }\r\n    \r\n    // å…¶ä»–ç±»å‹çš„å®‰å…¨è½¬æ¢\r\n    const stringResult = String(category);\r\n    // æ£€æŸ¥æ˜¯å¦æ˜¯æœ‰æ•ˆçš„å­—ç¬¦ä¸²è¡¨ç¤º\r\n    if (stringResult && stringResult !== '[object Object]') {\r\n      return stringResult.trim() || 'ğŸ“ å…¶ä»–';\r\n    } else {\r\n      return 'ğŸ“ å…¶ä»–';\r\n    }\r\n  } catch (error) {\r\n    console.error('safeCategoryToStringå¤„ç†é”™è¯¯:', error, category);\r\n    return 'ğŸ“ å…¶ä»–';\r\n  }\r\n};\r\n\r\n// å®‰å…¨çš„å­—ç¬¦ä¸²è½¬æ¢å‡½æ•° - å¢å¼ºç‰ˆï¼Œé˜²æ­¢\"Cannot convert object to primitive value\"é”™è¯¯\r\nconst safeString = (value) => {\r\n  try {\r\n    // å¤„ç†null/undefined\r\n    if (value == null) {\r\n      return '';\r\n    }\r\n    \r\n    // å¤„ç†åŸºæœ¬ç±»å‹\r\n    switch (typeof value) {\r\n      case 'string':\r\n        return value;\r\n      case 'number':\r\n      case 'boolean':\r\n      case 'bigint':\r\n        return String(value);\r\n      case 'symbol':\r\n        return value.toString();\r\n    }\r\n    \r\n    // å¤„ç†å¯¹è±¡ç±»å‹\r\n    if (typeof value === 'object') {\r\n      // ä¼˜å…ˆæ£€æŸ¥å¸¸è§å¯¹è±¡ç±»å‹\r\n      if (value instanceof Date) {\r\n        return value.toISOString();\r\n      }\r\n      \r\n      if (value instanceof Error) {\r\n        return value.message || value.name || 'Error';\r\n      }\r\n      \r\n      // å°è¯•è·å–å¯¹è±¡çš„å¸¸è§å­—ç¬¦ä¸²å±æ€§\r\n      const stringProps = ['name', 'title', 'label', 'text', 'message', 'value'];\r\n      for (const prop of stringProps) {\r\n        if (typeof value[prop] === 'string') {\r\n          return value[prop];\r\n        }\r\n      }\r\n      \r\n      // å®‰å…¨åœ°ä½¿ç”¨JSON.stringify\r\n      try {\r\n        const jsonStr = JSON.stringify(value, (key, val) => {\r\n          if (typeof val === 'object' && val !== null) {\r\n            return Object.prototype.toString.call(val);\r\n          }\r\n          return val;\r\n        });\r\n        if (jsonStr && jsonStr !== '{}' && jsonStr !== '[]') {\r\n          return jsonStr;\r\n        }\r\n      } catch (jsonError) {\r\n        console.warn('JSON.stringify failed:', jsonError);\r\n      }\r\n      \r\n      // æœ€åå°è¯•è°ƒç”¨toString()\r\n      try {\r\n        const toStringResult = Object.prototype.toString.call(value);\r\n        if (toStringResult !== '[object Object]') {\r\n          return toStringResult;\r\n        }\r\n      } catch (toStringError) {\r\n        console.warn('toString call failed:', toStringError);\r\n      }\r\n      \r\n      return '[object]';\r\n    }\r\n    \r\n    // å…¶ä»–æœªçŸ¥ç±»å‹\r\n    return String(value);\r\n  } catch (error) {\r\n    console.error('safeStringå¤„ç†é”™è¯¯:', error, value);\r\n    return '';\r\n  }\r\n};\r\n\r\n// è·å–æ¨¡æ¿å›¾æ ‡ - æ ¹æ®å†…å­˜è§„èŒƒå¢å¼ºç±»å‹å®‰å…¨å’Œé”™è¯¯å¤„ç†\r\nconst getTemplateIcon = (template) => {\r\n  try {\r\n    // åŸºç¡€éªŒè¯\r\n    if (!template || typeof template !== 'object') {\r\n      console.warn('getTemplateIcon: æ¨¡æ¿å¯¹è±¡æ— æ•ˆ', template);\r\n      return 'SettingOutlined';\r\n    }\r\n    \r\n    if (!template.icon) {\r\n      return 'SettingOutlined';\r\n    }\r\n    \r\n    // å®‰å…¨å¤„ç†å›¾æ ‡åç§° - ç¡®ä¿å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹\r\n    let iconName;\r\n    try {\r\n      if (typeof template.icon === 'string') {\r\n        iconName = template.icon.trim();\r\n      } else if (typeof template.icon === 'object' && template.icon !== null) {\r\n        // å¦‚æœæ˜¯å¯¹è±¡ï¼Œå°è¯•è·å–æœ‰æ•ˆçš„å­—ç¬¦ä¸²å±æ€§\r\n        if (template.icon.name && typeof template.icon.name === 'string') {\r\n          iconName = template.icon.name.trim();\r\n        } else if (template.icon.type && typeof template.icon.type === 'string') {\r\n          iconName = template.icon.type.trim();\r\n        } else {\r\n          // å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶çš„å®‰å…¨å¤„ç†\r\n          try {\r\n            const objStr = JSON.stringify(template.icon);\r\n            console.warn('getTemplateIcon: å›¾æ ‡æ˜¯å¯¹è±¡ï¼Œå°è¯•JSONè½¬æ¢', template.icon, objStr);\r\n            iconName = 'setting'; // ä½¿ç”¨é»˜è®¤å€¼\r\n          } catch (jsonError) {\r\n            console.error('getTemplateIcon: JSONè½¬æ¢å¤±è´¥', jsonError);\r\n            iconName = 'setting';\r\n          }\r\n        }\r\n      } else if (template.icon === null || template.icon === undefined) {\r\n        iconName = 'setting';\r\n      } else {\r\n        // å…¶ä»–ç±»å‹çš„å®‰å…¨è½¬æ¢\r\n        iconName = String(template.icon).trim();\r\n      }\r\n    } catch (typeError) {\r\n      console.error('getTemplateIcon: ç±»å‹å¤„ç†é”™è¯¯', typeError, template.icon);\r\n      iconName = 'setting';\r\n    }\r\n    \r\n    // éªŒè¯å›¾æ ‡åç§°\r\n    if (!iconName || iconName === '[object Object]' || iconName.length === 0) {\r\n      console.warn('getTemplateIcon: æ— æ•ˆçš„å›¾æ ‡åç§°', iconName, template);\r\n      return 'SettingOutlined';\r\n    }\r\n    \r\n    // å¦‚æœå·²ç»åŒ…å«Outlinedåç¼€ï¼Œç›´æ¥è¿”å›\r\n    if (iconName.endsWith('Outlined')) {\r\n      return iconName;\r\n    }\r\n    \r\n    // ç‰¹æ®Šå›¾æ ‡åç§°æ˜ å°„\r\n    const iconMap = {\r\n      'global': 'GlobalOutlined',\r\n      'database': 'DatabaseOutlined',\r\n      'server': 'ServerOutlined',\r\n      'network': 'RouterOutlined',\r\n      'cloud': 'CloudOutlined',\r\n      'container': 'ContainerOutlined',\r\n      'security': 'SafetyOutlined',\r\n      'storage': 'HddOutlined',\r\n      'monitor': 'DashboardOutlined',\r\n      'setting': 'SettingOutlined'\r\n    };\r\n    \r\n    // æ£€æŸ¥æ˜¯å¦æœ‰ç›´æ¥æ˜ å°„\r\n    const lowerIconName = iconName.toLowerCase();\r\n    if (iconMap[lowerIconName]) {\r\n      return iconMap[lowerIconName];\r\n    }\r\n    \r\n    // å¤„ç†é¦–å­—æ¯å¤§å†™å¹¶æ·»åŠ Outlinedåç¼€\r\n    try {\r\n      const capitalizedIcon = iconName.charAt(0).toUpperCase() + iconName.slice(1);\r\n      const finalIconName = `${capitalizedIcon}Outlined`;\r\n      \r\n      // éªŒè¯å›¾æ ‡æ˜¯å¦å­˜åœ¨äºAnt Designå›¾æ ‡åº“ä¸­\r\n      const availableIcons = [\r\n        'GlobalOutlined', 'DatabaseOutlined', 'DesktopOutlined', 'RouterOutlined',\r\n        'CloudOutlined', 'ContainerOutlined', 'SafetyOutlined', 'HddOutlined',\r\n        'CodeOutlined', 'MessageOutlined', 'ThunderboltOutlined', 'NodeIndexOutlined',\r\n        'SettingOutlined', 'DashboardOutlined', 'ServerOutlined', 'WifiOutlined'\r\n      ];\r\n      \r\n      if (availableIcons.includes(finalIconName)) {\r\n        return finalIconName;\r\n      }\r\n    } catch (processError) {\r\n      console.error('getTemplateIcon: å›¾æ ‡åç§°å¤„ç†é”™è¯¯', processError, iconName);\r\n    }\r\n    \r\n    // å¦‚æœå›¾æ ‡ä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤å›¾æ ‡\r\n    return 'SettingOutlined';\r\n  } catch (error) {\r\n    console.error('getTemplateIconå¤„ç†ä¸¥é‡é”™è¯¯:', error, template);\r\n    return 'SettingOutlined';\r\n  }\r\n};\r\n\r\nconst handleSearch = async () => {\r\n  pagination.current = 1;\r\n  await loadIPList();\r\n};\r\n\r\nconst handleReset = async () => {\r\n  searchKeyword.value = '';\r\n  ipStatus.value = '';\r\n  ipType.value = '';\r\n  pagination.current = 1;\r\n  await loadIPList();\r\n};\r\n\r\nconst handleSearchInput = (value) => {\r\n  searchKeyword.value = value;\r\n};\r\n\r\nconst handleStatusChange = (value) => {\r\n  ipStatus.value = value;\r\n};\r\n\r\nconst handleTableChange = async (paginationInfo, filters, sorter) => {\r\n  console.log('handleTableChange è¢«è°ƒç”¨:', {\r\n    paginationInfo, \r\n    å½“å‰åˆ†é¡µçŠ¶æ€: {\r\n      current: pagination.current,\r\n      pageSize: pagination.pageSize\r\n    }\r\n  });\r\n  \r\n  pagination.current = paginationInfo.current;\r\n  pagination.pageSize = paginationInfo.pageSize;\r\n  \r\n  console.log('æ›´æ–°åçš„åˆ†é¡µçŠ¶æ€:', {\r\n    current: pagination.current,\r\n    pageSize: pagination.pageSize\r\n  });\r\n  \r\n  // æ›´æ–° URL å‚æ•°\r\n  const currentUrl = new URL(window.location);\r\n  currentUrl.searchParams.set('page', pagination.current.toString());\r\n  currentUrl.searchParams.set('page_size', pagination.pageSize.toString());\r\n  window.history.replaceState({}, '', currentUrl.toString());\r\n  console.log('å·²æ›´æ–° URL:', currentUrl.toString());\r\n  \r\n  await loadIPList();\r\n};\r\n\r\nconst handleAdd = () => {\r\n  router.push({ name: 'ipAdd' });\r\n};\r\n\r\nconst handleView = (record) => {\r\n  selectedIP.value = record;\r\n  detailModalVisible.value = true;\r\n};\r\n\r\nconst handleEdit = (record) => {\r\n  // æ£€æŸ¥IPæ˜¯å¦å—ä¿æŠ¤\r\n  if (record.is_protected || record.is_auto_discovered) {\r\n    message.warning({\r\n      content: `ä¸èƒ½ç¼–è¾‘æ­¤IPåœ°å€ï¼š${record.ip_address || record.ipAddress}\\nåŸå› ï¼š${record.protection_reason || 'è‡ªåŠ¨å‘ç°çš„IPåœ°å€ä¸å…è®¸ç¼–è¾‘'}\\nå¯ç¼–è¾‘å­—æ®µï¼š${Array.isArray(record.editable_fields) ? record.editable_fields.join(', ') : 'å¤‡æ³¨ã€çŠ¶æ€'}`,\r\n      duration: 5\r\n    });\r\n    return;\r\n  }\r\n  \r\n  editingIP.value = record;\r\n  Object.assign(formData, record);\r\n  editModalVisible.value = true;\r\n};\r\n\r\nconst handleDelete = async (record) => {\r\n  try {\r\n    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€\r\n    const loadingMessage = message.loading('æ­£åœ¨æ£€æŸ¥åˆ é™¤å½±å“...', 0);\r\n    \r\n    try {\r\n      // æ£€æŸ¥åˆ é™¤å½±å“\r\n      const impactResponse = await ipAPI.checkDeletionImpact(record.id);\r\n      loadingMessage();\r\n      \r\n      if (impactResponse.data && impactResponse.data.code === 200) {\r\n        const impactData = impactResponse.data.data;\r\n        \r\n        // æ„å»ºè¯¦ç»†çš„ç¡®è®¤å¯¹è¯æ¡†å†…å®¹\r\n        const confirmContent = await new Promise((resolve) => {\r\n          const { createVNode } = Vue;\r\n          const { ExclamationCircleOutlined, WarningOutlined } = antdvIcons;\r\n          \r\n          const warningItems = impactData.deletion_warnings.map(warning => \r\n            createVNode('li', { style: 'margin: 4px 0; color: #ff4d4f;' }, warning)\r\n          );\r\n          \r\n          // å¦‚æœæ˜¯è‡ªåŠ¨å‘ç°çš„IPï¼Œæ·»åŠ ç‰¹æ®Šè­¦å‘Š\r\n          if (impactData.is_auto_discovered) {\r\n            warningItems.unshift(\r\n              createVNode('li', { \r\n                style: 'margin: 4px 0; color: #ff4d4f; font-weight: bold; background: #fff2f0; padding: 8px; border-radius: 4px; border-left: 4px solid #ff4d4f;' \r\n              }, 'âš ï¸ è­¦å‘Šï¼šæ­¤IPä¸ºZabbixè‡ªåŠ¨å‘ç°ï¼Œåˆ é™¤åå¯èƒ½å½±å“ç›‘æ§ç³»ç»Ÿï¼')\r\n            );\r\n          }\r\n          \r\n          const content = createVNode('div', {}, [\r\n            createVNode('p', { style: 'font-weight: bold; margin-bottom: 12px; color: #ff4d4f;' }, \r\n              impactData.is_auto_discovered ? \r\n              `âš ï¸ åˆ é™¤è‡ªåŠ¨å‘ç°çš„IPåœ°å€: ${impactData.ip_address}` : \r\n              `ç¡®è®¤åˆ é™¤ IPåœ°å€: ${impactData.ip_address}`\r\n            ),\r\n            \r\n            // åŸºæœ¬ä¿¡æ¯\r\n            createVNode('div', { style: 'margin-bottom: 12px; padding: 8px; background: #f5f5f5; border-radius: 4px;' }, [\r\n              createVNode('p', { style: 'margin: 0; font-size: 12px; color: #666;' }, `ä¸»æœºå: ${impactData.hostname || 'æœªè®¾ç½®'}`),\r\n              createVNode('p', { style: 'margin: 0; font-size: 12px; color: #666;' }, `æ¥æº: ${impactData.is_auto_discovered ? 'Zabbixè‡ªåŠ¨å‘ç°' : 'æ‰‹åŠ¨åˆ›å»º'}`),\r\n              impactData.zabbix_drule_id ? createVNode('p', { style: 'margin: 0; font-size: 12px; color: #666;' }, `Zabbixè§„åˆ™ID: ${impactData.zabbix_drule_id}`) : null\r\n            ]),\r\n            \r\n            // å½±å“ç»Ÿè®¡\r\n            createVNode('div', { style: 'margin-bottom: 12px;' }, [\r\n              createVNode('p', { style: 'margin: 0; font-weight: bold; color: #fa8c16;' }, 'åˆ é™¤å½±å“èŒƒå›´:'),\r\n              impactData.scan_results_count > 0 ? \r\n                createVNode('p', { style: 'margin: 4px 0; color: #ff4d4f;' }, `Â· æ‰«æç»“æœ: ${impactData.scan_results_count} æ¡è®°å½•`) : null,\r\n              impactData.related_tasks.length > 0 ? \r\n                createVNode('p', { style: 'margin: 4px 0; color: #ff4d4f;' }, `Â· ç›¸å…³ä»»åŠ¡: ${impactData.related_tasks.length} ä¸ª`) : null,\r\n              impactData.will_cleanup_zabbix ? \r\n                createVNode('p', { style: 'margin: 4px 0; color: #ff4d4f;' }, 'Â· Zabbixç›‘æ§æ•°æ®: å°†å°è¯•æ¸…ç†') : null\r\n            ]),\r\n            \r\n            // è­¦å‘Šåˆ—è¡¨\r\n            createVNode('div', {}, [\r\n              createVNode('p', { style: 'margin: 8px 0 4px 0; font-weight: bold; color: #ff4d4f;' }, [\r\n                createVNode(WarningOutlined, { style: 'margin-right: 4px;' }),\r\n                'è­¦å‘Šä¿¡æ¯:'\r\n              ]),\r\n              createVNode('ul', { style: 'margin: 0; padding-left: 16px; max-height: 200px; overflow-y: auto;' }, warningItems)\r\n            ]),\r\n            \r\n            createVNode('p', { style: 'margin-top: 12px; font-weight: bold; color: #ff4d4f; text-align: center;' }, 'æ­¤æ“ä½œä¸å¯æ¢å¤ï¼')\r\n          ]);\r\n          \r\n          resolve(content);\r\n        });\r\n        \r\n        // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†\r\n        await new Promise((resolve, reject) => {\r\n          const modal = Modal.confirm({\r\n            title: impactData.is_auto_discovered ? 'åˆ é™¤è‡ªåŠ¨å‘ç°çš„IPåœ°å€åŠç›¸å…³æ•°æ®' : 'åˆ é™¤IPåœ°å€åŠç›¸å…³æ•°æ®',\r\n            content: confirmContent,\r\n            width: 600,\r\n            okText: 'ç¡®è®¤åˆ é™¤',\r\n            okType: 'danger',\r\n            cancelText: 'å–æ¶ˆ',\r\n            icon: createVNode(ExclamationCircleOutlined, { style: 'color: #ff4d4f;' }),\r\n            onOk: () => resolve(true),\r\n            onCancel: () => reject(new Error('User cancelled'))\r\n          });\r\n        });\r\n        \r\n      } else {\r\n        loadingMessage();\r\n        throw new Error('è·å–åˆ é™¤å½±å“ä¿¡æ¯å¤±è´¥');\r\n      }\r\n      \r\n    } catch (impactError) {\r\n      loadingMessage();\r\n      console.warn('æ£€æŸ¥åˆ é™¤å½±å“å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ç¡®è®¤å¯¹è¯æ¡†:', impactError);\r\n      \r\n      // å¦‚æœæ£€æŸ¥å½±å“å¤±è´¥ï¼Œä½¿ç”¨ç®€å•çš„ç¡®è®¤å¯¹è¯æ¡†\r\n      await new Promise((resolve, reject) => {\r\n        const modal = Modal.confirm({\r\n          title: 'ç¡®è®¤åˆ é™¤IP',\r\n          content: `ç¡®å®šè¦åˆ é™¤IPåœ°å€ \"${record.ipAddress || record.ip_address}\" å—ï¼Ÿ\\n\\nè­¦å‘Šï¼šæ­¤æ“ä½œå°†åˆ é™¤IPè®°å½•åŠæ‰€æœ‰ç›¸å…³æ•°æ®ï¼ˆåŒ…æ‹¬æ‰«æç»“æœã€Zabbixç›‘æ§æ•°æ®ç­‰ï¼‰ï¼Œè¯¥æ“ä½œä¸å¯æ¢å¤ï¼`,\r\n          okText: 'ç¡®è®¤åˆ é™¤',\r\n          okType: 'danger',\r\n          cancelText: 'å–æ¶ˆ',\r\n          onOk: () => resolve(true),\r\n          onCancel: () => reject(new Error('User cancelled'))\r\n        });\r\n      });\r\n    }\r\n    \r\n    // æ‰§è¡Œåˆ é™¤æ“ä½œ\r\n    const deleteMessage = message.loading('æ­£åœ¨åˆ é™¤IPåŠç›¸å…³æ•°æ®...', 0);\r\n    \r\n    try {\r\n      const response = await ipAPI.deleteIP(record.id);\r\n      deleteMessage();\r\n      \r\n      if (response.data && response.data.code === 200) {\r\n        const cleanupData = response.data.data;\r\n        \r\n        // æ„å»ºæˆåŠŸæ¶ˆæ¯\r\n        let successMessage = `IPåœ°å€ \"${cleanupData.ip_address}\" å·²æˆåŠŸåˆ é™¤`;\r\n        \r\n        const cleanupDetails = [];\r\n        if (cleanupData.scan_results_deleted > 0) {\r\n          cleanupDetails.push(`æ‰«æç»“æœ: ${cleanupData.scan_results_deleted}æ¡`);\r\n        }\r\n        if (cleanupData.zabbix_cleanup && cleanupData.zabbix_cleanup.success) {\r\n          if (cleanupData.zabbix_cleanup.hosts && cleanupData.zabbix_cleanup.hosts.length > 0) {\r\n            const deletedCount = cleanupData.zabbix_cleanup.hosts.filter(h => h.deleted).length;\r\n            cleanupDetails.push(`Zabbixä¸»æœº: ${deletedCount}ä¸ª`);\r\n          }\r\n        }\r\n        \r\n        if (cleanupDetails.length > 0) {\r\n          successMessage += `\\nåŒæ—¶æ¸…ç†äº†ï¼š${cleanupDetails.join('ã€')}`;\r\n        }\r\n        \r\n        message.success({\r\n          content: successMessage,\r\n          duration: 6\r\n        });\r\n        \r\n        // ç›´æ¥ä»åˆ—è¡¨ä¸­ç§»é™¤å·²åˆ é™¤çš„IPï¼Œè€Œä¸æ˜¯åˆ·æ–°æ•´ä¸ªåˆ—è¡¨\r\n        ipData.value = ipData.value.filter(ip => ip.id !== record.id);\r\n        pagination.total = ipData.value.length;\r\n      } else {\r\n        message.error('åˆ é™¤IPåœ°å€å¤±è´¥');\r\n      }\r\n    } catch (deleteError) {\r\n      deleteMessage();\r\n      throw deleteError;\r\n    }\r\n    \r\n  } catch (error) {\r\n    if (error.message !== 'User cancelled') {\r\n      console.error('åˆ é™¤IPåœ°å€å¤±è´¥:', error);\r\n      message.error(`åˆ é™¤IPåœ°å€å¤±è´¥: ${error.response?.data?.message || error.message}`);\r\n    }\r\n  }\r\n};\r\n\r\nconst handlePing = async (record) => {\r\n  record.pinging = true;\r\n  try {\r\n    // è°ƒç”¨åç«¯ping API\r\n    const response = await ipAPI.pingIP(record.id);\r\n    \r\n    if (response.data && response.data.code === 200) {\r\n      const pingData = response.data.data;\r\n      // æ›´æ–°è®°å½•çš„pingçŠ¶æ€\r\n      record.ping_status = pingData.status;\r\n      record.pingStatus = pingData.status; // å…¼å®¹å­—æ®µ\r\n      record.last_seen = pingData.last_seen;\r\n      record.lastSeen = pingData.last_seen; // å…¼å®¹å­—æ®µ\r\n      \r\n      const statusText = pingData.is_online ? 'åœ¨çº¿' : 'ç¦»çº¿';\r\n      const responseTimeText = pingData.response_time ? ` (${pingData.response_time}ms)` : '';\r\n      \r\n      message.success(`Ping ${record.ip_address || record.ipAddress} å®Œæˆ: ${statusText}${responseTimeText}`, 1);\r\n    } else {\r\n      message.error(`Pingå¤±è´¥: ${response.data?.message || 'æœªçŸ¥é”™è¯¯'}`);\r\n    }\r\n  } catch (error) {\r\n    console.error('Pingæµ‹è¯•å¤±è´¥:', error);\r\n    let errorMessage = 'Pingå¤±è´¥';\r\n    if (error.response && error.response.data) {\r\n      errorMessage += `: ${error.response.data.message || error.response.data.error || 'ç½‘ç»œé”™è¯¯'}`;\r\n    } else if (error.message) {\r\n      errorMessage += `: ${error.message}`;\r\n    }\r\n    message.error(errorMessage);\r\n  } finally {\r\n    record.pinging = false;\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\nconst handleExport = () => {\r\n  message.info('å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...');\r\n};\r\n\r\nconst handleListManagement = () => {\r\n  message.info('åˆ—è¡¨ç®¡ç†åŠŸèƒ½å¼€å‘ä¸­...');\r\n};\r\n\r\nconst handleScan = () => {\r\n  // é‡ç½®æ‰«æè¡¨å•å¹¶è®¾ç½®å½“å‰é¡µé¢å¯èƒ½çš„IPèŒƒå›´\r\n  resetScanForm();\r\n  \r\n  // å¦‚æœæœ‰æœç´¢å…³é”®è¯ï¼Œå°è¯•æ™ºèƒ½è®¾ç½®IPèŒƒå›´\r\n  if (searchKeyword.value) {\r\n    const keyword = searchKeyword.value.trim();\r\n    // å¦‚æœæœç´¢å…³é”®è¯æ˜¯IPæ ¼å¼ï¼Œè‡ªåŠ¨è®¾ç½®ä¸ºæ‰«æèŒƒå›´\r\n    const ipPattern = /^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$/;\r\n    if (ipPattern.test(keyword)) {\r\n      // æå–ç½‘æ®µ\r\n      const ipParts = keyword.split('.');\r\n      const networkBase = `${ipParts[0]}.${ipParts[1]}.${ipParts[2]}.0/24`;\r\n      scanFormData.ipRanges = networkBase;\r\n    }\r\n  }\r\n  \r\n  scanModalVisible.value = true;\r\n};\r\n\r\nconst handleScanConfirm = async () => {\r\n  try {\r\n    await scanFormRef.value.validate();\r\n    \r\n    // å¤„ç†IPèŒƒå›´æ•°æ®\r\n    const ipRanges = scanFormData.ipRanges.split('\\n')\r\n      .map(range => range.trim())\r\n      .filter(range => range.length > 0);\r\n    \r\n    // æ„å»ºPythonæ‰«æé…ç½®æ•°æ®ï¼Œå‘é€ç»™åç«¯\r\n    const scanConfig = {\r\n      ipRanges: ipRanges,\r\n      checkType: scanFormData.checkType,\r\n      ports: scanFormData.ports,\r\n      key: scanFormData.key,\r\n      // Pythonæ‰«æå™¨å‚æ•°\r\n      maxConcurrent: scanFormData.maxConcurrent || 100,\r\n      timeout: scanFormData.timeout || 3.0,\r\n      pingTimeout: scanFormData.pingTimeout || 1.0,\r\n      // ä¿ç•™ä¸€äº›å‚æ•°ç”¨äºæœåŠ¡æ£€æµ‹\r\n      snmpCommunity: scanFormData.snmpCommunity,\r\n      snmpv3Config: scanFormData.snmpv3Config\r\n    };\r\n    \r\n    console.log('å‘é€Pythonæ‰«æé…ç½®:', scanConfig);\r\n    \r\n    try {\r\n      // è°ƒç”¨åç«¯Pythonæ‰«æAPI\r\n      const response = await ipAPI.createScanTask(scanConfig);\r\n      \r\n      if (response.data && response.data.code === 200) {\r\n        const taskData = response.data.data;\r\n        \r\n        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯\r\n        const scanEngineText = taskData.scanEngine === 'python' ? 'PythonåŸç”Ÿæ‰«æ' : 'æ‰«æ';\r\n        \r\n        message.success({\r\n          content: `${scanEngineText}ä»»åŠ¡åˆ›å»ºæˆåŠŸï¼\\næ‰«æèŒƒå›´: ${ipRanges.join(', ')}\\næ£€æŸ¥ç±»å‹: ${getCheckTypeName(scanFormData.checkType)}\\nä»»åŠ¡ID: ${taskData.taskId}\\nå¹¶å‘æ•°: ${scanConfig.maxConcurrent}\\nè¶…æ—¶é…ç½®: è¿æ¥${scanConfig.timeout}s, Ping${scanConfig.pingTimeout}s\\nå·²å¯åŠ¨åå°å¼‚æ­¥å¤„ç†ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æ‰«æç½‘ç»œå¹¶ä¿å­˜ç»“æœåˆ°æ•°æ®åº“...`,\r\n          duration: 8\r\n        });\r\n        \r\n        // åˆ·æ–°IPåˆ—è¡¨\r\n        await loadIPList();\r\n        \r\n        // è‡ªåŠ¨æ‰“å¼€ä»»åŠ¡æŸ¥è¯¢é¢æ¿æŸ¥çœ‹è¿›åº¦\r\n        setTimeout(() => {\r\n          handleScanTaskQuery();\r\n        }, 1000);\r\n        \r\n      } else {\r\n        throw new Error(response.data?.message || 'Pythonæ‰«æä»»åŠ¡åˆ›å»ºå¤±è´¥');\r\n      }\r\n    } catch (apiError) {\r\n      console.error('åç«¯Pythonæ‰«æAPIè°ƒç”¨å¤±è´¥:', apiError);\r\n      message.error(`Pythonæ‰«æä»»åŠ¡åˆ›å»ºå¤±è´¥: ${apiError.response?.data?.message || apiError.message}`);\r\n      return;\r\n    }\r\n    \r\n    scanModalVisible.value = false;\r\n    resetScanForm();\r\n  } catch (error) {\r\n    console.error('æ‰«æé…ç½®éªŒè¯å¤±è´¥:', error);\r\n    message.error('è¯·æ£€æŸ¥æ‰«æé…ç½®æ˜¯å¦æ­£ç¡®');\r\n  }\r\n};\r\n\r\n// è·å–æ£€æŸ¥ç±»å‹åç§°\r\nconst getCheckTypeName = (type) => {\r\n  const typeNames = {\r\n    0: 'SSH', 1: 'LDAP', 2: 'SMTP', 3: 'FTP', 4: 'HTTP',\r\n    5: 'POP', 6: 'NNTP', 7: 'IMAP', 8: 'TCP', 9: 'Zabbix agent',\r\n    10: 'SNMPv1', 11: 'SNMPv2', 12: 'ICMP ping', 13: 'SNMPv3',\r\n    14: 'HTTPS', 15: 'Telnet'\r\n  };\r\n  return typeNames[type] || 'æœªçŸ¥ç±»å‹';\r\n};\r\n\r\nconst handleScanCancel = () => {\r\n  scanModalVisible.value = false;\r\n  resetScanForm();\r\n};\r\n\r\nconst handleTypeChange = (value) => {\r\n  // æ ¹æ®ç±»å‹è®¾ç½®é»˜è®¤ç«¯å£\r\n  const defaultPorts = {\r\n    0: '22',      // SSH\r\n    1: '389',     // LDAP\r\n    2: '25',      // SMTP\r\n    3: '21',      // FTP\r\n    4: '80',      // HTTP\r\n    5: '110',     // POP\r\n    6: '119',     // NNTP\r\n    7: '143',     // IMAP\r\n    8: '0',       // TCP\r\n    9: '10050',   // Zabbix agent\r\n    10: '161',    // SNMPv1\r\n    11: '161',    // SNMPv2\r\n    12: '0',      // ICMP (ä¸éœ€è¦ç«¯å£)\r\n    13: '161',    // SNMPv3\r\n    14: '443',    // HTTPS\r\n    15: '23'      // Telnet\r\n  };\r\n  \r\n  scanFormData.ports = defaultPorts[value] || '0';\r\n  \r\n  // æ¸…ç©ºç›¸å…³å­—æ®µ\r\n  scanFormData.key = '';\r\n  if (value !== 10 && value !== 11) {\r\n    scanFormData.snmpCommunity = 'public';\r\n  }\r\n  if (value !== 13) {\r\n    // æ¸…ç©ºSNMPv3é…ç½®\r\n    scanFormData.snmpv3Config.securityLevel = '0';\r\n    scanFormData.snmpv3Config.securityName = '';\r\n    scanFormData.snmpv3Config.contextName = '';\r\n    scanFormData.snmpv3Config.authProtocol = 0;\r\n    scanFormData.snmpv3Config.authPassphrase = '';\r\n    scanFormData.snmpv3Config.privProtocol = 0;\r\n    scanFormData.snmpv3Config.privPassphrase = '';\r\n  }\r\n};\r\n\r\nconst handleSecurityLevelChange = (value) => {\r\n  // æ¸…ç©ºè®¤è¯å’Œéšç§é…ç½®\r\n  if (value === '0') {\r\n    scanFormData.snmpv3Config.authProtocol = 0;\r\n    scanFormData.snmpv3Config.authPassphrase = '';\r\n    scanFormData.snmpv3Config.privProtocol = 0;\r\n    scanFormData.snmpv3Config.privPassphrase = '';\r\n  } else if (value === '1') {\r\n    scanFormData.snmpv3Config.privProtocol = 0;\r\n    scanFormData.snmpv3Config.privPassphrase = '';\r\n  }\r\n};\r\n\r\nconst resetScanForm = () => {\r\n  Object.assign(scanFormData, {\r\n    ipRanges: '192.168.1.0/24',\r\n    checkType: 12,\r\n    ports: '0',\r\n    key: '',\r\n    // Pythonæ‰«æå™¨å‚æ•°\r\n    maxConcurrent: 100,\r\n    timeout: 3.0,\r\n    pingTimeout: 1.0,\r\n    // ä¿ç•™å‚æ•°\r\n    snmpCommunity: 'public',\r\n    snmpv3Config: {\r\n      securityLevel: '0',\r\n      securityName: '',\r\n      contextName: '',\r\n      authProtocol: 0,\r\n      authPassphrase: '',\r\n      privProtocol: 0,\r\n      privPassphrase: ''\r\n    },\r\n    uniqueCheck: 0,\r\n    hostSource: 1,\r\n    nameSource: 0\r\n  });\r\n  scanFormRef.value?.resetFields();\r\n};\r\n\r\n// æ‰«æä»»åŠ¡æŸ¥è¯¢ç›¸å…³å‡½æ•°\r\nconst handleScanTaskQuery = () => {\r\n  scanTaskModalVisible.value = true;\r\n  loadScanTasks();\r\n  \r\n  // å¯åŠ¨å¼‚æ­¥çŠ¶æ€ç›‘æ§\r\n  startAsyncStatusMonitoring();\r\n};\r\n\r\n// å¼‚æ­¥çŠ¶æ€ç›‘æ§\r\nlet statusCheckInterval = null;\r\n\r\n// ç»„ä»¶åˆå§‹åŒ–çŠ¶æ€æ ‡è®°\r\nlet isComponentInitialized = false;\r\nlet isMonitoringActive = false;\r\n\r\nconst startAsyncStatusMonitoring = () => {\r\n  // é˜²æ­¢é‡å¤å¯åŠ¨\r\n  if (isMonitoringActive) {\r\n    console.log('å¼‚æ­¥ç›‘æ§å·²åœ¨è¿è¡Œï¼Œè·³è¿‡é‡å¤å¯åŠ¨');\r\n    return;\r\n  }\r\n  \r\n  // æ¸…ç†æ—§çš„é—´éš”å™¨\r\n  if (statusCheckInterval) {\r\n    clearInterval(statusCheckInterval);\r\n    statusCheckInterval = null;\r\n  }\r\n  \r\n  console.log('å¯åŠ¨å¼‚æ­¥çŠ¶æ€ç›‘æ§...');\r\n  isMonitoringActive = true;\r\n  \r\n  // æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡ä»»åŠ¡çŠ¶æ€ï¼ˆå‡å°‘é¢‘ç‡ï¼‰\r\n  statusCheckInterval = setInterval(async () => {\r\n    if (scanTaskModalVisible.value && isMonitoringActive) {\r\n      await checkRunningTasksStatus();\r\n    } else {\r\n      // å¼¹çª—å…³é—­æ—¶åœæ­¢ç›‘æ§\r\n      stopAsyncStatusMonitoring();\r\n    }\r\n  }, 5000); // ä»3ç§’æ”¹ä¸º5ç§’\r\n};\r\n\r\nconst stopAsyncStatusMonitoring = () => {\r\n  console.log('åœæ­¢å¼‚æ­¥çŠ¶æ€ç›‘æ§...');\r\n  \r\n  // æ ‡è®°ç›‘æ§å·²åœæ­¢\r\n  isMonitoringActive = false;\r\n  \r\n  // æ¸…ç†ä¸»å®šæ—¶å™¨\r\n  if (statusCheckInterval) {\r\n    clearInterval(statusCheckInterval);\r\n    statusCheckInterval = null;\r\n  }\r\n  \r\n  // æ¸…ç†å¯èƒ½å­˜åœ¨çš„å…¶ä»–å®šæ—¶å™¨å¼•ç”¨\r\n  [statusCheckInterval].forEach(timer => {\r\n    if (timer) {\r\n      clearInterval(timer);\r\n    }\r\n  });\r\n  \r\n  // ç­‰å¾…ä¸€ä¸ªå¾®ä»»åŠ¡å‘¨æœŸï¼Œç¡®ä¿æ­£åœ¨è¿è¡Œçš„æ£€æŸ¥å®Œæˆ\r\n  setTimeout(() => {\r\n    console.log('å¼‚æ­¥çŠ¶æ€ç›‘æ§å·²åœæ­¢');\r\n  }, 100);\r\n};\r\n\r\nconst checkRunningTasksStatus = async () => {\r\n  try {\r\n    // æ‰¾åˆ°æ‰€æœ‰è¿è¡Œä¸­çš„ä»»åŠ¡\r\n    const runningTasks = scanTasks.value.filter(task => \r\n      task.status === 'running' || task.status === 'pending'\r\n    );\r\n    \r\n    // å¦‚æœæ²¡æœ‰è¿è¡Œä¸­çš„ä»»åŠ¡ï¼Œåœæ­¢ç›‘æ§\r\n    if (runningTasks.length === 0) {\r\n      stopAsyncStatusMonitoring();\r\n      return;\r\n    }\r\n    \r\n    for (const task of runningTasks) {\r\n      try {\r\n        const response = await ipAPI.getAsyncTaskStatus(task.id);\r\n        if (response.data && response.data.code === 200) {\r\n          const statusData = response.data.data;\r\n          \r\n          // åªæœ‰å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶æ‰æ›´æ–°\r\n          const taskIndex = scanTasks.value.findIndex(t => t.id === task.id);\r\n          if (taskIndex !== -1) {\r\n            const currentTask = scanTasks.value[taskIndex];\r\n            const hasStatusChanged = currentTask.status !== statusData.status;\r\n            const hasProgressChanged = currentTask.progress !== statusData.progress;\r\n            \r\n            if (hasStatusChanged || hasProgressChanged) {\r\n              // ä½¿ç”¨ Vue çš„å“åº”å¼æ›´æ–°ï¼Œå‡å°‘ DOM æ“ä½œ\r\n              Object.assign(scanTasks.value[taskIndex], {\r\n                status: statusData.status,\r\n                progress: statusData.progress,\r\n                result_data: statusData.result_data,\r\n                error_message: statusData.error_message\r\n              });\r\n              \r\n              // å¦‚æœä»»åŠ¡å®Œæˆï¼Œæ˜¾ç¤ºé€šçŸ¥\r\n              if (statusData.status === 'completed' && hasStatusChanged) {\r\n                const resultData = statusData.result_data || {};\r\n                message.success({\r\n                  content: `ä»»åŠ¡ ${task.id} å·²å®Œæˆï¼\\nå‘ç°ä¸»æœº: ${resultData.discovered_hosts || 0} ä¸ª\\næ–°å¢IP: ${resultData.saved_count || 0} ä¸ª\\næ›´æ–°IP: ${resultData.updated_count || 0} ä¸ª`,\r\n                  duration: 5\r\n                });\r\n                \r\n                // å»¶è¿Ÿåˆ·æ–°IPåˆ—è¡¨ï¼Œé¿å…å¹¶å‘æ›´æ–°\r\n                setTimeout(() => {\r\n                  loadIPList();\r\n                }, 1000);\r\n              }\r\n              \r\n              // å¦‚æœä»»åŠ¡å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯\r\n              if (statusData.status === 'failed' && hasStatusChanged) {\r\n                message.error({\r\n                  content: `ä»»åŠ¡ ${task.id} å¤±è´¥ï¼š${statusData.error_message || 'æœªçŸ¥é”™è¯¯'}`,\r\n                  duration: 5\r\n                });\r\n              }\r\n            }\r\n          }\r\n        }\r\n      } catch (error) {\r\n        // é™é»˜å¤„ç†å•ä¸ªä»»åŠ¡æ£€æŸ¥å¤±è´¥\r\n        console.debug(`æ£€æŸ¥ä»»åŠ¡ ${task.id} çŠ¶æ€å¤±è´¥:`, error.message);\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.debug('æ£€æŸ¥è¿è¡Œä»»åŠ¡çŠ¶æ€å¤±è´¥:', error.message);\r\n  }\r\n};\r\n\r\n\r\nconst loadScanTasks = async () => {\r\n  taskLoading.value = true;\r\n  try {\r\n    const params = {\r\n      page: taskPagination.current,\r\n      page_size: taskPagination.pageSize\r\n    };\r\n    \r\n    // æ·»åŠ æŸ¥è¯¢æ¡ä»¶\r\n    if (taskStatusFilter.value && taskStatusFilter.value !== '') {\r\n      params.status = taskStatusFilter.value;\r\n    }\r\n    if (taskNameFilter.value && taskNameFilter.value !== '') {\r\n      params.search = taskNameFilter.value;\r\n    }\r\n    if (taskDateRange.value && Array.isArray(taskDateRange.value) && taskDateRange.value.length === 2) {\r\n      params.created_after = taskDateRange.value[0].toISOString();\r\n      params.created_before = taskDateRange.value[1].toISOString();\r\n    }\r\n    \r\n    console.log('è°ƒç”¨æ‰«æä»»åŠ¡APIï¼Œå‚æ•°:', params);\r\n    \r\n    // è°ƒç”¨åç«¯APIè·å–æ‰«æä»»åŠ¡åˆ—è¡¨\r\n    const response = await ipAPI.getScanTasks(params);\r\n    \r\n    console.log('APIå“åº”:', response);\r\n    \r\n    if (response && response.data) {\r\n      // æ£€æŸ¥æ˜¯å¦æ˜¯ç»Ÿä¸€å“åº”æ ¼å¼ï¼ˆåŒ…å«codeå­—æ®µï¼‰\r\n      if (response.data.code !== undefined) {\r\n        // ç»Ÿä¸€å“åº”æ ¼å¼\r\n        if (response.data.code === 200) {\r\n          const data = response.data.data;\r\n          // è¿‡æ»¤æ‰å·²å–æ¶ˆçš„ä»»åŠ¡\r\n          let tasks = data.results || [];\r\n          tasks = tasks.filter(task => task.status !== 'cancelled');\r\n          scanTasks.value = tasks;\r\n          taskPagination.total = tasks.length; // ä½¿ç”¨è¿‡æ»¤åçš„æ•°é‡\r\n          console.log('æˆåŠŸè·å–æ‰«æä»»åŠ¡ï¼ˆç»Ÿä¸€æ ¼å¼ï¼Œå·²è¿‡æ»¤å–æ¶ˆä»»åŠ¡ï¼‰:', scanTasks.value);\r\n        } else {\r\n          console.error('APIè¿”å›é”™è¯¯ä»£ç :', response.data.code, 'é”™è¯¯ä¿¡æ¯:', response.data.message);\r\n          message.error(`è·å–æ‰«æä»»åŠ¡åˆ—è¡¨å¤±è´¥: ${response.data.message}`);\r\n          scanTasks.value = [];\r\n          taskPagination.total = 0;\r\n        }\r\n      } else {\r\n        // DRFæ ‡å‡†å“åº”æ ¼å¼ï¼ˆç›´æ¥åŒ…å«countã€resultså­—æ®µï¼‰\r\n        console.log('æ£€æµ‹åˆ°DRFæ ‡å‡†å“åº”æ ¼å¼');\r\n        // è¿‡æ»¤æ‰å·²å–æ¶ˆçš„ä»»åŠ¡\r\n        let tasks = response.data.results || [];\r\n        tasks = tasks.filter(task => task.status !== 'cancelled');\r\n        scanTasks.value = tasks;\r\n        taskPagination.total = tasks.length; // ä½¿ç”¨è¿‡æ»¤åçš„æ•°é‡\r\n        console.log('æˆåŠŸè·å–æ‰«æä»»åŠ¡ï¼ˆDRFæ ¼å¼ï¼Œå·²è¿‡æ»¤å–æ¶ˆä»»åŠ¡ï¼‰:', scanTasks.value);\r\n        message.success('è·å–æ‰«æä»»åŠ¡åˆ—è¡¨æˆåŠŸ', 1);\r\n      }\r\n    } else {\r\n      console.error('æ— æ•ˆçš„APIå“åº”:', response);\r\n      message.error('è·å–æ‰«æä»»åŠ¡åˆ—è¡¨å¤±è´¥: æ— æ•ˆçš„å“åº”æ•°æ®');\r\n      scanTasks.value = [];\r\n      taskPagination.total = 0;\r\n    }\r\n  } catch (error) {\r\n    console.error('åŠ è½½æ‰«æä»»åŠ¡å¤±è´¥:', error);\r\n    console.error('é”™è¯¯è¯¦æƒ…:', {\r\n      message: error.message,\r\n      response: error.response,\r\n      request: error.request\r\n    });\r\n    \r\n    let errorMessage = 'åŠ è½½æ‰«æä»»åŠ¡å¤±è´¥';\r\n    if (error.response) {\r\n      // æœåŠ¡å™¨å“åº”é”™è¯¯\r\n      errorMessage += `: HTTP ${error.response.status}`;\r\n      if (error.response.data && error.response.data.message) {\r\n        errorMessage += ` - ${error.response.data.message}`;\r\n      }\r\n    } else if (error.request) {\r\n      // è¯·æ±‚å‘é€ä½†æ— å“åº”\r\n      errorMessage += ': ç½‘ç»œè¿æ¥å¤±è´¥æˆ–æœåŠ¡å™¨æ— å“åº”';\r\n    } else {\r\n      // è¯·æ±‚è®¾ç½®é”™è¯¯\r\n      errorMessage += `: ${error.message}`;\r\n    }\r\n    \r\n    message.error(errorMessage);\r\n    scanTasks.value = [];\r\n    taskPagination.total = 0;\r\n  } finally {\r\n    taskLoading.value = false;\r\n  }\r\n};\r\n\r\nconst handleSearchTasks = () => {\r\n  taskPagination.current = 1;\r\n  loadScanTasks();\r\n};\r\n\r\nconst handleRefreshTasks = () => {\r\n  taskStatusFilter.value = '';\r\n  taskDateRange.value = [];\r\n  taskNameFilter.value = '';\r\n  taskPagination.current = 1;\r\n  loadScanTasks();\r\n};\r\n\r\n\r\nconst handleTaskTableChange = (paginationInfo) => {\r\n  taskPagination.current = paginationInfo.current;\r\n  taskPagination.pageSize = paginationInfo.pageSize;\r\n  loadScanTasks();\r\n};\r\n\r\nconst handleViewTaskDetail = (record) => {\r\n  selectedTask.value = record;\r\n  taskDetailModalVisible.value = true;\r\n};\r\n\r\nconst handleViewTaskResults = async (record) => {\r\n  selectedTask.value = record;\r\n  await loadTaskResults(record.id);\r\n  taskResultModalVisible.value = true;\r\n};\r\n\r\nconst handleCancelTask = async (record) => {\r\n  try {\r\n    // å¦‚æœä»»åŠ¡æ­£åœ¨è¿è¡Œï¼Œå…ˆåœæ­¢å¼‚æ­¥å¤„ç†\r\n    if (record.status === 'running' || record.status === 'pending') {\r\n      try {\r\n        const stopResponse = await ipAPI.stopAsyncTask(record.id);\r\n        if (stopResponse.data && stopResponse.data.code === 200) {\r\n          message.success('å¼‚æ­¥ä»»åŠ¡å·²åœæ­¢', 1);\r\n        }\r\n      } catch (stopError) {\r\n        console.warn('åœæ­¢å¼‚æ­¥ä»»åŠ¡å¤±è´¥:', stopError);\r\n      }\r\n    }\r\n    \r\n    // å–æ¶ˆä»»åŠ¡\r\n    const response = await ipAPI.cancelScanTask(record.id);\r\n    if (response.data && response.data.code === 200) {\r\n      message.success(`ä»»åŠ¡ ${record.task_name || record.id} å·²å–æ¶ˆ`, 1);\r\n      // ç›´æ¥ä»åˆ—è¡¨ä¸­ç§»é™¤å·²å–æ¶ˆçš„ä»»åŠ¡ï¼Œè€Œä¸æ˜¯åˆ·æ–°æ•´ä¸ªåˆ—è¡¨\r\n      scanTasks.value = scanTasks.value.filter(task => task.id !== record.id);\r\n      taskPagination.total = scanTasks.value.length;\r\n    } else {\r\n      message.error('å–æ¶ˆä»»åŠ¡å¤±è´¥');\r\n    }\r\n  } catch (error) {\r\n    console.error('å–æ¶ˆä»»åŠ¡å¤±è´¥:', error);\r\n    message.error(`å–æ¶ˆä»»åŠ¡å¤±è´¥: ${error.response?.data?.message || error.message}`);\r\n  }\r\n};\r\n\r\nconst handleDeleteTask = async (record) => {\r\n  try {\r\n    // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†\r\n    await new Promise((resolve, reject) => {\r\n      const modal = Modal.confirm({\r\n        title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',\r\n        content: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡ \"${record.id}\" å—ï¼Ÿè¯¥æ“ä½œä¸å¯æ¢å¤ï¼`,\r\n        okText: 'ç¡®è®¤åˆ é™¤',\r\n        okType: 'danger',\r\n        cancelText: 'å–æ¶ˆ',\r\n        onOk: () => resolve(true),\r\n        onCancel: () => reject(new Error('User cancelled'))\r\n      });\r\n    });\r\n    \r\n    // è°ƒç”¨åˆ é™¤API\r\n    const response = await ipAPI.deleteScanTask(record.id);\r\n    \r\n    if (response.data && response.data.code === 200) {\r\n      message.success(`ä»»åŠ¡ \"${record.id}\" å·²æˆåŠŸåˆ é™¤`, 1);\r\n      \r\n      // ç›´æ¥ä»åˆ—è¡¨ä¸­ç§»é™¤å·²åˆ é™¤çš„ä»»åŠ¡ï¼Œè€Œä¸æ˜¯åˆ·æ–°æ•´ä¸ªåˆ—è¡¨\r\n      scanTasks.value = scanTasks.value.filter(task => task.id !== record.id);\r\n      taskPagination.total = scanTasks.value.length;\r\n    } else {\r\n      message.error('åˆ é™¤ä»»åŠ¡å¤±è´¥');\r\n    }\r\n  } catch (error) {\r\n    if (error.message !== 'User cancelled') {\r\n      console.error('åˆ é™¤ä»»åŠ¡å¤±è´¥:', error);\r\n      message.error(`åˆ é™¤ä»»åŠ¡å¤±è´¥: ${error.response?.data?.message || error.message}`);\r\n    }\r\n  }\r\n};\r\n\r\nconst loadTaskResults = async (taskId) => {\r\n  resultLoading.value = true;\r\n  try {\r\n    const response = await ipAPI.getScanTaskResults(taskId);\r\n    if (response.data && response.data.code === 200) {\r\n      taskResults.value = response.data.data || [];\r\n    } else {\r\n      message.error('è·å–æ‰«æç»“æœå¤±è´¥');\r\n      taskResults.value = [];\r\n    }\r\n  } catch (error) {\r\n    console.error('åŠ è½½æ‰«æç»“æœå¤±è´¥:', error);\r\n    message.error(`åŠ è½½æ‰«æç»“æœå¤±è´¥: ${error.response?.data?.message || error.message}`);\r\n    taskResults.value = [];\r\n  } finally {\r\n    resultLoading.value = false;\r\n  }\r\n};\r\n\r\n// ä»»åŠ¡çŠ¶æ€ç›¸å…³å·¥å…·å‡½æ•°\r\nconst getTaskStatusColor = (status) => {\r\n  const colorMap = {\r\n    'pending': 'default',\r\n    'running': 'processing',\r\n    'completed': 'success',\r\n    'failed': 'error',\r\n    'cancelled': 'warning'\r\n  };\r\n  return colorMap[status] || 'default';\r\n};\r\n\r\nconst getTaskStatusText = (status) => {\r\n  const textMap = {\r\n    'pending': 'ç­‰å¾…ä¸­',\r\n    'running': 'è¿è¡Œä¸­',\r\n    'completed': 'å·²å®Œæˆ',\r\n    'failed': 'å¤±è´¥',\r\n    'cancelled': 'å·²å–æ¶ˆ'\r\n  };\r\n  return textMap[status] || status;\r\n};\r\n\r\n// åˆ¤æ–­æ˜¯å¦ä¸ºé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡\r\nconst isLongRunningTask = (task) => {\r\n  if (task.status !== 'running') {\r\n    return false;\r\n  }\r\n  \r\n  // æ£€æŸ¥ä»»åŠ¡çš„è¿è¡Œæ—¶é—´ï¼Œå¦‚æœè¶…è¿‡180ç§’ï¼ˆ5åˆ†é’Ÿï¼‰åˆ™è®¤ä¸ºæ˜¯é•¿æ—¶é—´è¿è¡Œ\r\n  if (task.started_at) {\r\n    const startTime = new Date(task.started_at);\r\n    const currentTime = new Date();\r\n    const diffInSeconds = (currentTime - startTime) / 1000;\r\n    return diffInSeconds > 180; // 3åˆ†é’Ÿ\r\n  }\r\n  \r\n  // æ ¹æ®è¿›åº¦åˆ¤æ–­ï¼šå¦‚æœè¿›åº¦å¤§äº30%ä½†ä»åœ¨è¿è¡Œï¼Œå¯èƒ½æ˜¯é•¿æ—¶é—´ä»»åŠ¡\r\n  return task.progress > 30;\r\n};\r\n\r\n// è·å–å–æ¶ˆæŒ‰é’®çš„æ–‡æœ¬\r\nconst getCancelButtonText = (record) => {\r\n  if (record.status === 'running' && isLongRunningTask(record)) {\r\n    return 'åœæ­¢';\r\n  }\r\n  return 'å–æ¶ˆ';\r\n};\r\n\r\n// è·å–å–æ¶ˆæŒ‰é’®çš„æç¤ºä¿¡æ¯\r\nconst getCancelButtonTitle = (record) => {\r\n  if (record.status === 'completed') {\r\n    return 'ä»»åŠ¡å·²å®Œæˆï¼Œæ— æ³•å–æ¶ˆ';\r\n  }\r\n  if (record.status === 'cancelled') {\r\n    return 'ä»»åŠ¡å·²å–æ¶ˆ';\r\n  }\r\n  if (record.status === 'failed') {\r\n    return 'ä»»åŠ¡å·²å¤±è´¥ï¼Œæ— æ³•å–æ¶ˆ';\r\n  }\r\n  if (record.status === 'running') {\r\n    if (isLongRunningTask(record)) {\r\n      return 'åœæ­¢æ­£åœ¨æŒç»­è¿è¡Œçš„ä»»åŠ¡ã€‚ä»»åŠ¡å°†ä¼šç«‹å³åœæ­¢ï¼Œä¸å†æ£€æŸ¥æ–°çš„ä¸»æœºå‘ç°';\r\n    }\r\n    return 'å–æ¶ˆæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡';\r\n  }\r\n  if (record.status === 'pending') {\r\n    return 'å–æ¶ˆç­‰å¾…ä¸­çš„ä»»åŠ¡';\r\n  }\r\n  return 'å–æ¶ˆä»»åŠ¡';\r\n};\r\n\r\n// è·å–åˆ é™¤æŒ‰é’®çš„æç¤ºä¿¡æ¯\r\nconst getDeleteButtonTitle = (record) => {\r\n  if (record.status === 'running') {\r\n    return 'ä»»åŠ¡æ­£åœ¨è¿è¡Œä¸­ï¼Œæ— æ³•åˆ é™¤';\r\n  }\r\n  if (record.status === 'pending') {\r\n    return 'ä»»åŠ¡æ­£åœ¨ç­‰å¾…å¤„ç†ï¼Œæ— æ³•åˆ é™¤';\r\n  }\r\n  return `åˆ é™¤ä»»åŠ¡ ${record.id} çš„è®°å½•ï¼ˆä¸å¯æ¢å¤ï¼‰`;\r\n};\r\n\r\n\r\n\r\n\r\nconst handleRefresh = () => {\r\n  loadIPList();\r\n  message.success('æ•°æ®å·²åˆ·æ–°', 1);\r\n};\r\n\r\nconst handleSave = async () => {\r\n  try {\r\n    await formRef.value.validate();\r\n    \r\n    // è½¬æ¢å­—æ®µåï¼šå‰ç«¯é©¼å³°å‘½åè½¬åç«¯ä¸‹åˆ’çº¿å‘½å\r\n    const submitData = {\r\n      ip_address: formData.ipAddress,\r\n      hostname: formData.hostname,\r\n      status: formData.status,\r\n      type: formData.type,\r\n      mac_address: formData.macAddress,\r\n      device: formData.device,\r\n      subnet: formData.subnet,\r\n      description: formData.description\r\n    };\r\n    \r\n    if (editingIP.value) {\r\n      // ç¼–è¾‘æ¨¡å¼\r\n      await ipAPI.updateIP(editingIP.value.id, submitData);\r\n      message.success('IPä¿¡æ¯æ›´æ–°æˆåŠŸ', 1);\r\n    } else {\r\n      // æ–°å¢æ¨¡å¼\r\n      await ipAPI.createIP(submitData);\r\n      message.success('IPæ·»åŠ æˆåŠŸ', 1);\r\n    }\r\n    \r\n    editModalVisible.value = false;\r\n    resetForm();\r\n    await loadIPList();\r\n  } catch (error) {\r\n    console.error('ä¿å­˜IPå¤±è´¥:', error);\r\n    message.error(`ä¿å­˜å¤±è´¥: ${error.response?.data?.message || error.message}`);\r\n  }\r\n};\r\n\r\nconst handleCancel = () => {\r\n  editModalVisible.value = false;\r\n  resetForm();\r\n};\r\n\r\nconst resetForm = () => {\r\n  Object.assign(formData, {\r\n    ipAddress: '',\r\n    hostname: '',\r\n    status: 'available',\r\n    type: 'static',\r\n    macAddress: '',\r\n    device: '',\r\n    subnet: '',\r\n    description: ''\r\n  });\r\n  formRef.value?.resetFields();\r\n};\r\n\r\n// ç»„ä»¶æŒ‚è½½æ—¶åˆå§‹åŒ–æ•°æ®\r\nonMounted(() => {\r\n  // é˜²æ­¢é‡å¤åˆå§‹åŒ–\r\n  if (isComponentInitialized) {\r\n    console.log('IPåˆ—è¡¨ç»„ä»¶å·²åˆå§‹åŒ–ï¼Œè·³è¿‡é‡å¤åˆå§‹åŒ–');\r\n    return;\r\n  }\r\n  \r\n  console.log('IPåˆ—è¡¨ç»„ä»¶æŒ‚è½½ï¼Œå¼€å§‹åŠ è½½IPæ•°æ®...');\r\n  isComponentInitialized = true;\r\n  \r\n  // ä» URL å‚æ•°ä¸­è¯»å–åˆ†é¡µè®¾ç½®\r\n  const urlParams = new URLSearchParams(window.location.search);\r\n  const pageParam = urlParams.get('page');\r\n  const pageSizeParam = urlParams.get('page_size');\r\n  \r\n  if (pageParam && !isNaN(parseInt(pageParam))) {\r\n    pagination.current = parseInt(pageParam);\r\n    console.log('ä» URL è¯»å–åˆ° page å‚æ•°:', pagination.current);\r\n  }\r\n  \r\n  if (pageSizeParam && !isNaN(parseInt(pageSizeParam))) {\r\n    const requestedPageSize = parseInt(pageSizeParam);\r\n    // æ£€æŸ¥æ˜¯å¦åœ¨å…è®¸çš„é€‰é¡¹ä¸­\r\n    const allowedSizes = [10, 20, 50, 100];\r\n    if (allowedSizes.includes(requestedPageSize)) {\r\n      pagination.pageSize = requestedPageSize;\r\n      console.log('ä» URL è¯»å–åˆ° page_size å‚æ•°:', pagination.pageSize);\r\n    } else {\r\n      console.warn(`URL ä¸­çš„ page_size=${requestedPageSize} ä¸åœ¨å…è®¸èŒƒå›´å†…ï¼Œä½¿ç”¨é»˜è®¤å€¼ ${pagination.pageSize}`);\r\n    }\r\n  }\r\n  \r\n  // å…¨å±€æŠ‘åˆ¶ ResizeObserver é”™è¯¯\r\n  const originalError = console.error;\r\n  console.error = function(...args) {\r\n    if (args[0] && args[0].toString().includes('ResizeObserver loop completed')) {\r\n      return; // å¿½ç•¥ ResizeObserver é”™è¯¯\r\n    }\r\n    originalError.apply(console, args);\r\n  };\r\n  \r\n  // ä½¿ç”¨ç°æœ‰çš„é”™è¯¯æŠ‘åˆ¶å‡½æ•°\r\n  suppressResizeObserverError();\r\n  \r\n  // å»¶è¿ŸåŠ è½½æ•°æ®ï¼Œé¿å…DOMæ¸²æŸ“å†²çª\r\n  nextTick(() => {\r\n    loadIPList();\r\n  });\r\n});\r\n\r\n// ç»„ä»¶å³å°†å¸è½½æ—¶çš„é¢„æ¸…ç†\r\nonBeforeUnmount(() => {\r\n  console.log('IPåˆ—è¡¨ç»„ä»¶å³å°†å¸è½½ï¼Œè¿›è¡Œé¢„æ¸…ç†...');\r\n  \r\n  // ç«‹å³åœæ­¢æ‰€æœ‰ç›‘æ§æ´»åŠ¨\r\n  stopAsyncStatusMonitoring();\r\n  \r\n  // å…³é—­æ‰€æœ‰å¼¹çª—ï¼Œé¿å…æ®‹ç•™çš„DOMå…ƒç´ \r\n  scanTaskModalVisible.value = false;\r\n  taskDetailModalVisible.value = false;\r\n  taskResultModalVisible.value = false;\r\n  editModalVisible.value = false;\r\n  detailModalVisible.value = false;\r\n  scanModalVisible.value = false;\r\n});\r\n\r\n// ç»„ä»¶é”€æ¯æ—¶æ¸…ç†èµ„æº\r\nonUnmounted(() => {\r\n  console.log('IPåˆ—è¡¨ç»„ä»¶é”€æ¯ï¼Œæ¸…ç†ç›‘æ§å®šæ—¶å™¨...');\r\n  \r\n  // 1. åœæ­¢å¼‚æ­¥çŠ¶æ€ç›‘æ§\r\n  stopAsyncStatusMonitoring();\r\n  \r\n  // 2. æ¸…ç†æ‰€æœ‰å¯èƒ½çš„å®šæ—¶å™¨\r\n  if (statusCheckInterval) {\r\n    clearInterval(statusCheckInterval);\r\n    statusCheckInterval = null;\r\n  }\r\n  \r\n  // 3. å¼ºåˆ¶æ¸…ç†æ‰€æœ‰ResizeObserverå®ä¾‹\r\n  try {\r\n    // æŸ¥æ‰¾é¡µé¢ä¸­æ‰€æœ‰çš„ResizeObserverå®ä¾‹å¹¶æ–­å¼€è¿æ¥\r\n    const tableElements = document.querySelectorAll('.modern-table, .ant-table, .ant-progress');\r\n    tableElements.forEach(element => {\r\n      // ç§»é™¤å¯èƒ½çš„è§‚å¯Ÿå™¨\r\n      if (element._resizeObserver) {\r\n        element._resizeObserver.disconnect();\r\n        delete element._resizeObserver;\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.debug('æ¸…ç†ResizeObserveræ—¶å‡ºé”™:', error.message);\r\n  }\r\n  \r\n  // 4. æ¸…ç†ç»„ä»¶çŠ¶æ€\r\n  scanTasks.value = [];\r\n  ipData.value = [];\r\n  taskResults.value = [];\r\n  \r\n  // 5. é‡ç½®åˆå§‹åŒ–çŠ¶æ€æ ‡è®°\r\n  isComponentInitialized = false;\r\n  isMonitoringActive = false;\r\n  \r\n  console.log('IPåˆ—è¡¨ç»„ä»¶èµ„æºæ¸…ç†å®Œæˆ');\r\n});\r\n\r\n// ç›‘å¬æ‰«æä»»åŠ¡å¼¹çª—çŠ¶æ€\r\nwatch(scanTaskModalVisible, (newValue, oldValue) => {\r\n  console.log(`æ‰«æä»»åŠ¡å¼¹çª—çŠ¶æ€å˜åŒ–: ${oldValue} -> ${newValue}`);\r\n  \r\n  if (!newValue) {\r\n    // å¼¹çª—å…³é—­æ—¶åœæ­¢ç›‘æ§\r\n    console.log('å¼¹çª—å…³é—­ï¼Œåœæ­¢å¼‚æ­¥ç›‘æ§');\r\n    stopAsyncStatusMonitoring();\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n/* ç®€æ´è“ç™½èƒŒæ™¯ */\r\n.ip-list-container {\r\n  background: #f8fafc;\r\n  min-height: 100vh;\r\n}\r\n\r\n/* ç®€æ´å¡ç‰‡æ ·å¼ */\r\n.table-card {\r\n  border-radius: 8px;\r\n  border: 1px solid #e2e8f0;\r\n  background: #ffffff;\r\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.table-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 20px 24px;\r\n  background: #ffffff;\r\n  border-bottom: 1px solid #e2e8f0;\r\n}\r\n\r\n.table-title {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  margin: 0;\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n  color: #1e40af;\r\n}\r\n\r\n.table-extra {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n/* ç®€æ´è¡¨æ ¼æ ·å¼ */\r\n:deep(.modern-table) {\r\n  border-radius: 6px;\r\n  overflow: hidden;\r\n  background: #ffffff;\r\n}\r\n\r\n:deep(.modern-table .ant-table-thead > tr > th) {\r\n  background: #f1f5f9;\r\n  border: none;\r\n  color: #374151;\r\n  font-weight: 600;\r\n  font-size: 14px;\r\n  padding: 16px 20px;\r\n  border-bottom: 1px solid #e2e8f0;\r\n}\r\n\r\n:deep(.modern-table .ant-table-tbody > tr > td) {\r\n  border: none;\r\n  padding: 16px 20px;\r\n  border-bottom: 1px solid #f1f5f9;\r\n}\r\n\r\n:deep(.modern-table .ant-table-tbody > tr:hover > td) {\r\n  background: #f8fafc;\r\n}\r\n\r\n:deep(.modern-table .ant-table-tbody > tr:last-child > td) {\r\n  border-bottom: none;\r\n}\r\n\r\n/* ç®€æ´æŒ‰é’®æ ·å¼ */\r\n:deep(.ant-btn-primary) {\r\n  background: #2563eb;\r\n  border: 1px solid #2563eb;\r\n  border-radius: 6px;\r\n  height: 36px;\r\n  font-weight: 500;\r\n}\r\n\r\n:deep(.ant-btn-primary:hover) {\r\n  background: #1d4ed8;\r\n  border-color: #1d4ed8;\r\n}\r\n\r\n:deep(.ant-btn:not(.ant-btn-primary)) {\r\n  border-radius: 6px;\r\n  height: 36px;\r\n\r\n  background: #ffffff;\r\n  font-weight: 500;\r\n}\r\n\r\n:deep(.ant-btn:not(.ant-btn-primary):hover) {\r\n  border-color: #2563eb;\r\n  color: #2563eb;\r\n}\r\n\r\n/* ç®€æ´æ ‡ç­¾æ ·å¼ */\r\n:deep(.ant-tag) {\r\n  border-radius: 4px;\r\n  padding: 2px 8px;\r\n  font-weight: 500;\r\n  border: 1px solid;\r\n  font-size: 12px;\r\n}\r\n\r\n/* çŠ¶æ€æ ‡ç­¾ç®€æ´è‰²å½© */\r\n:deep(.ant-tag-success) {\r\n  background: #dcfce7;\r\n  color: #166534;\r\n  border-color: #bbf7d0;\r\n}\r\n\r\n:deep(.ant-tag-processing) {\r\n  background: #dbeafe;\r\n  color: #1e40af;\r\n  border-color: #93c5fd;\r\n}\r\n\r\n:deep(.ant-tag-warning) {\r\n  background: #fef3c7;\r\n  color: #92400e;\r\n  border-color: #fde68a;\r\n}\r\n\r\n:deep(.ant-tag-error) {\r\n  background: #fee2e2;\r\n  color: #dc2626;\r\n  border-color: #fecaca;\r\n}\r\n\r\n:deep(.ant-tag-default) {\r\n  background: #f3f4f6;\r\n  color: #374151;\r\n  border-color: #d1d5db;\r\n}\r\n\r\n/* ä¿æŠ¤çŠ¶æ€æ ·å¼ */\r\n.protected-button {\r\n  opacity: 0.5;\r\n  cursor: not-allowed !important;\r\n}\r\n\r\n.protected-button:hover {\r\n  background: none !important;\r\n  border-color: transparent !important;\r\n  transform: none !important;\r\n}\r\n\r\n/* ä¿æŠ¤ä¿¡æ¯æç¤º */\r\n.protection-info {\r\n  margin-top: 4px;\r\n  color: #718096;\r\n  font-style: italic;\r\n}\r\n\r\n/* ç»Ÿè®¡å¡ç‰‡æ ·å¼ */\r\n:deep(.ant-statistic) {\r\n  background: rgba(255, 255, 255, 0.1);\r\n  backdrop-filter: blur(10px);\r\n  border-radius: 16px;\r\n  padding: 16px;\r\n  border: 1px solid rgba(255, 255, 255, 0.2);\r\n}\r\n\r\n:deep(.ant-statistic-title) {\r\n  color: #4a5568;\r\n  font-weight: 600;\r\n}\r\n\r\n:deep(.ant-statistic-content) {\r\n  color: #2d3748;\r\n  font-weight: 700;\r\n}\r\n\r\n/* å“åº”å¼è®¾è®¡ */\r\n@media (max-width: 768px) {\r\n  .ip-list-container {\r\n    padding: 16px;\r\n  }\r\n  \r\n  .table-header {\r\n    padding: 16px 20px;\r\n    flex-wrap: wrap;\r\n    gap: 12px;\r\n  }\r\n  \r\n  .table-title {\r\n    font-size: 18px;\r\n  }\r\n  \r\n  .table-extra {\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n  }\r\n  \r\n  :deep(.modern-table .ant-table-thead > tr > th),\r\n  :deep(.modern-table .ant-table-tbody > tr > td) {\r\n    padding: 12px 16px;\r\n  }\r\n}\r\n\r\n/* æ»šåŠ¨æ¡ç¾åŒ– */\r\n:deep(.ant-table-body)::-webkit-scrollbar {\r\n  width: 8px;\r\n  height: 8px;\r\n}\r\n\r\n:deep(.ant-table-body)::-webkit-scrollbar-track {\r\n  background: rgba(255, 255, 255, 0.1);\r\n  border-radius: 4px;\r\n}\r\n\r\n:deep(.ant-table-body)::-webkit-scrollbar-thumb {\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  border-radius: 4px;\r\n}\r\n\r\n:deep(.ant-table-body)::-webkit-scrollbar-thumb:hover {\r\n  background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);\r\n  font-size: 12px;\r\n  line-height: 1.4;\r\n}\r\n\r\n.table-header-text {\r\n  font-weight: 600;\r\n  color: #374151;\r\n}\r\n\r\n/* IPåœ°å€å•å…ƒæ ¼ */\r\n.ip-address-cell {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.ip-info {\r\n  flex: 1;\r\n}\r\n\r\n.ip-address {\r\n  font-family: 'Courier New', monospace;\r\n  font-weight: 600;\r\n  color: #1890ff;\r\n  font-size: 14px;\r\n  margin-bottom: 2px;\r\n}\r\n\r\n.ip-hostname {\r\n  font-size: 12px;\r\n  color: #6b7280;\r\n}\r\n\r\n/* çŠ¶æ€æ ‡ç­¾ */\r\n.status-tag {\r\n  border-radius: 6px;\r\n  font-weight: 500;\r\n  font-size: 12px;\r\n  padding: 4px 8px;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n}\r\n\r\n/* ç±»å‹æ ‡ç­¾ */\r\n.type-tag {\r\n  border-radius: 6px;\r\n  font-weight: 500;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n}\r\n\r\n/* PingçŠ¶æ€ */\r\n.ping-status {\r\n  font-weight: 500;\r\n}\r\n\r\n/* æœ€ååœ¨çº¿æ—¶é—´ */\r\n.last-seen {\r\n  color: #6b7280;\r\n  font-size: 12px;\r\n}\r\n\r\n.no-data {\r\n  color: #9ca3af;\r\n  font-style: italic;\r\n}\r\n\r\n.form-section {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.section-title {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin: 0 0 16px 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: #1890ff;\r\n  padding-bottom: 8px;\r\n  border-bottom: 1px solid #e8f3ff;\r\n}\r\n\r\n.input-hint {\r\n  font-size: 12px;\r\n  color: #8c8c8c;\r\n  margin-top: 4px;\r\n}\r\n\r\n/* æ‰«æå¼¹çª—æ ·å¼ */\r\n:deep(.ant-modal-body) {\r\n  max-height: 600px;\r\n  overflow-y: auto;\r\n}\r\n:deep(.detail-modal .ant-modal-content) {\r\n  border-radius: 8px;\r\n}\r\n\r\n:deep(.edit-modal .ant-modal-content) {\r\n  border-radius: 8px;\r\n}\r\n\r\n/* æŒ‰é’®æ ·å¼ä¼˜åŒ– */\r\n:deep(.ant-btn-primary) {\r\n  background: #1890ff;\r\n  border-color: #1890ff;\r\n  border-radius: 6px;\r\n}\r\n\r\n:deep(.ant-btn-primary:hover) {\r\n  background: #40a9ff;\r\n  border-color: #40a9ff;\r\n}\r\n\r\n:deep(.ant-btn) {\r\n  border-radius: 6px;\r\n}\r\n\r\n/* è¾“å…¥æ¡†æ ·å¼ */\r\n:deep(.ant-input) {\r\n  border-radius: 6px;\r\n  border-color: #e8f3ff;\r\n}\r\n\r\n:deep(.ant-input:focus) {\r\n  border-color: #1890ff;\r\n  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n:deep(.ant-select .ant-select-selector) {\r\n  border-radius: 6px;\r\n  border-color: #e8f3ff;\r\n}\r\n\r\n:deep(.ant-select:not(.ant-select-disabled):hover .ant-select-selector) {\r\n  border-color: #1890ff;\r\n}\r\n\r\n/* å“åº”å¼è®¾è®¡ */\r\n@media (max-width: 1200px) {\r\n  \r\n  .filter-header {\r\n    flex-direction: column;\r\n    gap: 16px;\r\n    align-items: flex-start;\r\n  }\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .ip-list-container {\r\n    padding: 16px;\r\n  }\r\n  \r\n  .filter-content {\r\n    padding: 16px;\r\n  }\r\n  \r\n  .filter-header {\r\n    gap: 12px;\r\n  }\r\n  \r\n  .filter-title {\r\n    font-size: 16px;\r\n  }\r\n  \r\n  .title-icon {\r\n    font-size: 18px;\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .ip-list-container {\r\n    padding: 12px;\r\n  }\r\n  \r\n  .ip-address-cell {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    gap: 8px;\r\n  }\r\n  \r\n  .filter-content {\r\n    padding: 12px;\r\n  }\r\n  \r\n  .filter-actions {\r\n    flex-direction: column;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n/* è¡¨æ ¼å®¹å™¨æ ·å¼ */\r\n.table-container {\r\n  overflow: hidden;\r\n  background: white;\r\n  border-radius: 8px;\r\n}\r\n\r\n/* æ‰¹é‡æ“ä½œå·¥å…·æ  */\r\n.batch-actions {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 16px;\r\n  background: #f0f7ff;\r\n  border: 1px solid #d6e4ff;\r\n  border-radius: 8px;\r\n  margin-bottom: 16px;\r\n  animation: slideDown 0.3s ease;\r\n}\r\n\r\n@keyframes slideDown {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(-10px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n.batch-info {\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 14px;\r\n  color: #1890ff;\r\n  font-weight: 500;\r\n}\r\n\r\n.batch-info strong {\r\n  color: #1890ff;\r\n  margin: 0 4px;\r\n  font-weight: 600;\r\n}\r\n\r\n/* ç›‘æ§çŠ¶æ€æŒ‰é’®æ ·å¼ */\r\n.monitoring-enabled {\r\n  background: #f6ffed !important;\r\n  border-color: #b7eb8f !important;\r\n}\r\n\r\n.monitoring-enabled:hover {\r\n  background: #d9f7be !important;\r\n  border-color: #95de64 !important;\r\n}\r\n\r\n/* ç»Ÿè®¡å¡ç‰‡æ ·å¼ */\r\n.stat-card {\r\n  border-radius: 8px;\r\n  border: 1px solid #e8f3ff;\r\n  background: #ffffff;\r\n  box-shadow: 0 2px 8px rgba(24, 144, 255, 0.08);\r\n  transition: all 0.3s ease;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n/* æ‰¹é‡Pingå¼¹çª—æ ·å¼ - é‡æ–°è®¾è®¡ */\r\n.ping-confirm-phase,\r\n.ping-testing-phase,\r\n.ping-result-phase {\r\n  padding: 8px 0;\r\n}\r\n\r\n/* é˜¶æ®µå¤´éƒ¨ */\r\n.phase-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16px;\r\n  margin-bottom: 24px;\r\n  padding: 20px;\r\n  border-radius: 12px;\r\n  border: 2px solid;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.ping-confirm-phase .phase-header {\r\n  background: linear-gradient(135deg, #f0f7ff 0%, #e8f3ff 100%);\r\n  border-color: #91caff;\r\n}\r\n\r\n.ping-testing-phase .phase-header {\r\n  background: linear-gradient(135deg, #fff7e6 0%, #fff2e8 100%);\r\n  border-color: #ffec8b;\r\n}\r\n\r\n.ping-result-phase .phase-header {\r\n  background: linear-gradient(135deg, #f6ffed 0%, #f0f9e8 100%);\r\n  border-color: #d9f7be;\r\n}\r\n\r\n.phase-icon {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 56px;\r\n  height: 56px;\r\n  border-radius: 50%;\r\n  font-size: 24px;\r\n  position: relative;\r\n}\r\n\r\n.phase-icon.confirm {\r\n  background: rgba(24, 144, 255, 0.1);\r\n  color: #1890ff;\r\n}\r\n\r\n.phase-icon.testing {\r\n  background: rgba(250, 140, 22, 0.1);\r\n  color: #fa8c16;\r\n}\r\n\r\n.phase-icon.success {\r\n  background: rgba(82, 196, 26, 0.1);\r\n  color: #52c41a;\r\n}\r\n\r\n.phase-content {\r\n  flex: 1;\r\n}\r\n\r\n.phase-title {\r\n  margin: 0 0 8px 0;\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n  color: #262626;\r\n}\r\n\r\n.phase-description {\r\n  margin: 0;\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n}\r\n\r\n/* ç»Ÿè®¡ç½‘æ ¼ */\r\n.stats-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: 16px;\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.stat-card {\r\n  text-align: center;\r\n  padding: 20px 16px;\r\n  background: #fafafa;\r\n  border-radius: 8px;\r\n  border: 1px solid #f0f0f0;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.stat-card:hover {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.stat-number {\r\n  font-size: 28px;\r\n  font-weight: bold;\r\n  margin-bottom: 8px;\r\n  line-height: 1;\r\n}\r\n\r\n.stat-number.primary { color: #1890ff; }\r\n.stat-number.success { color: #52c41a; }\r\n.stat-number.error { color: #ff4d4f; }\r\n\r\n.stat-label {\r\n  font-size: 12px;\r\n  color: #8c8c8c;\r\n  text-transform: uppercase;\r\n  font-weight: 500;\r\n  letter-spacing: 0.5px;\r\n}\r\n\r\n/* æµ‹è¯•å‚æ•° */\r\n.test-parameters {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.param-title {\r\n  margin: 0 0 16px 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: #262626;\r\n}\r\n\r\n.param-list {\r\n  background: #f9f9f9;\r\n  border-radius: 8px;\r\n  padding: 16px;\r\n  border: 1px solid #f0f0f0;\r\n}\r\n\r\n.param-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.param-item:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.param-label {\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n}\r\n\r\n.param-value {\r\n  color: #262626;\r\n  font-weight: 500;\r\n  font-size: 14px;\r\n}\r\n\r\n/* æç¤ºä¿¡æ¯ */\r\n.warning-tip,\r\n.tech-tip {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 16px;\r\n  border-radius: 8px;\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.warning-tip {\r\n  background: rgba(250, 140, 22, 0.05);\r\n  border: 1px solid rgba(250, 140, 22, 0.2);\r\n}\r\n\r\n.tech-tip {\r\n  background: rgba(24, 144, 255, 0.05);\r\n  border: 1px solid rgba(24, 144, 255, 0.2);\r\n}\r\n\r\n.tip-icon {\r\n  font-size: 16px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.tip-text {\r\n  font-size: 13px;\r\n  color: #595959;\r\n  line-height: 1.5;\r\n}\r\n\r\n/* æµ‹è¯•ä¸­çš„åŠ¨ç”»å’ŒçŠ¶æ€ */\r\n.loading-spinner {\r\n  width: 24px;\r\n  height: 24px;\r\n  border: 2px solid #f3f3f3;\r\n  border-top: 2px solid #fa8c16;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n  position: absolute;\r\n  top: 16px;\r\n  left: 16px;\r\n}\r\n\r\n.testing-icon {\r\n  margin-left: 4px;\r\n  z-index: 1;\r\n}\r\n\r\n.testing-info {\r\n  background: #f9f9f9;\r\n  border-radius: 8px;\r\n  padding: 16px;\r\n  margin-bottom: 20px;\r\n  border: 1px solid #f0f0f0;\r\n}\r\n\r\n.info-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.info-item:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.info-label {\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n}\r\n\r\n.info-value {\r\n  color: #262626;\r\n  font-weight: 500;\r\n  font-size: 14px;\r\n}\r\n\r\n.info-value.status-active {\r\n  color: #fa8c16;\r\n  animation: pulse 2s infinite;\r\n}\r\n\r\n/* è¿›åº¦æ¡ */\r\n.progress-section {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.progress-bar {\r\n  width: 100%;\r\n  height: 6px;\r\n  background: #f5f5f5;\r\n  border-radius: 3px;\r\n  overflow: hidden;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.progress-fill {\r\n  height: 100%;\r\n  background: linear-gradient(90deg, #1890ff, #40a9ff, #69c0ff, #40a9ff, #1890ff);\r\n  background-size: 200% 100%;\r\n  border-radius: 3px;\r\n  animation: progressFlow 2s ease-in-out infinite;\r\n}\r\n\r\n.progress-text {\r\n  text-align: center;\r\n  font-size: 13px;\r\n  color: #8c8c8c;\r\n  font-style: italic;\r\n}\r\n\r\n/* ç»“æœé˜¶æ®µ */\r\n.success-icon {\r\n  font-size: 32px;\r\n  animation: bounce 0.6s ease-out;\r\n}\r\n\r\n.result-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: 16px;\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.result-card {\r\n  text-align: center;\r\n  padding: 24px 16px;\r\n  background: #fafafa;\r\n  border-radius: 8px;\r\n  border: 1px solid #f0f0f0;\r\n  transition: all 0.3s ease;\r\n  animation: fadeInUp 0.5s ease-out;\r\n}\r\n\r\n.result-card.success {\r\n  border-color: #d9f7be;\r\n  background: #f6ffed;\r\n}\r\n\r\n.result-card.error {\r\n  border-color: #ffccc7;\r\n  background: #fff2f0;\r\n}\r\n\r\n.result-card.primary {\r\n  border-color: #91caff;\r\n  background: #f0f7ff;\r\n}\r\n\r\n.result-card:nth-child(1) { animation-delay: 0.1s; }\r\n.result-card:nth-child(2) { animation-delay: 0.2s; }\r\n.result-card:nth-child(3) { animation-delay: 0.3s; }\r\n\r\n.result-number {\r\n  font-size: 32px;\r\n  font-weight: bold;\r\n  margin-bottom: 8px;\r\n  line-height: 1;\r\n}\r\n\r\n.result-card.success .result-number { color: #52c41a; }\r\n.result-card.error .result-number { color: #ff4d4f; }\r\n.result-card.primary .result-number { color: #1890ff; }\r\n\r\n.result-label {\r\n  font-size: 12px;\r\n  color: #8c8c8c;\r\n  text-transform: uppercase;\r\n  font-weight: 500;\r\n  letter-spacing: 0.5px;\r\n}\r\n\r\n.result-summary {\r\n  text-align: center;\r\n  padding: 16px;\r\n  background: rgba(82, 196, 26, 0.05);\r\n  border-radius: 8px;\r\n  border: 1px solid rgba(82, 196, 26, 0.2);\r\n  margin-bottom: 24px;\r\n  animation: fadeIn 0.5s ease-in 0.4s both;\r\n}\r\n\r\n.summary-item {\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.summary-item:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.summary-item.success-rate .summary-value {\r\n  color: #52c41a;\r\n  font-weight: 600;\r\n  font-size: 16px;\r\n}\r\n\r\n.summary-item.test-time .summary-value {\r\n  color: #8c8c8c;\r\n  font-size: 13px;\r\n}\r\n\r\n.summary-label {\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n}\r\n\r\n/* æŒ‰é’®æ“ä½œåŒºåŸŸ */\r\n.modal-actions {\r\n  text-align: center;\r\n  margin-top: 8px;\r\n}\r\n\r\n/* åŠ¨ç”»å®šä¹‰ */\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n@keyframes pulse {\r\n  0%, 100% { opacity: 1; }\r\n  50% { opacity: 0.6; }\r\n}\r\n\r\n@keyframes progressFlow {\r\n  0% { background-position: 200% 0; }\r\n  100% { background-position: -200% 0; }\r\n}\r\n\r\n@keyframes fadeIn {\r\n  from { opacity: 0; }\r\n  to { opacity: 1; }\r\n}\r\n\r\n@keyframes fadeInUp {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(20px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n@keyframes bounce {\r\n  0%, 20%, 53%, 80%, 100% {\r\n    transform: translate3d(0, 0, 0);\r\n  }\r\n  40%, 43% {\r\n    transform: translate3d(0, -8px, 0);\r\n  }\r\n  70% {\r\n    transform: translate3d(0, -4px, 0);\r\n  }\r\n  90% {\r\n    transform: translate3d(0, -2px, 0);\r\n  }\r\n}\r\n\r\n:deep(.ping-info-header) {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16px;\r\n  margin-bottom: 20px;\r\n  padding: 16px;\r\n  background: linear-gradient(135deg, #f0f7ff 0%, #e8f3ff 100%);\r\n  border-radius: 8px;\r\n  border: 1px solid #d4edda;\r\n}\r\n\r\n:deep(.ping-icon) {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 48px;\r\n  height: 48px;\r\n  background: rgba(24, 144, 255, 0.1);\r\n  border-radius: 50%;\r\n}\r\n\r\n:deep(.ping-title) {\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  color: #1890ff;\r\n  margin: 0;\r\n}\r\n\r\n:deep(.ping-stats) {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n  margin-bottom: 16px;\r\n  padding: 16px;\r\n  background: #fafafa;\r\n  border-radius: 6px;\r\n  border: 1px solid #f0f0f0;\r\n}\r\n\r\n:deep(.stat-item) {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n:deep(.stat-label) {\r\n  font-size: 14px;\r\n  color: #666;\r\n  font-weight: 500;\r\n}\r\n\r\n:deep(.stat-value) {\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  padding: 2px 8px;\r\n  border-radius: 4px;\r\n}\r\n\r\n:deep(.stat-value.primary) {\r\n  color: #1890ff;\r\n  background: rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n:deep(.stat-value.success) {\r\n  color: #52c41a;\r\n  background: rgba(82, 196, 26, 0.1);\r\n}\r\n\r\n:deep(.stat-value.error) {\r\n  color: #ff4d4f;\r\n  background: rgba(255, 77, 79, 0.1);\r\n}\r\n\r\n:deep(.ping-description) {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n:deep(.ping-warning) {\r\n  padding: 12px;\r\n  background: rgba(250, 140, 22, 0.05);\r\n  border: 1px solid rgba(250, 140, 22, 0.2);\r\n  border-radius: 6px;\r\n}\r\n\r\n/* æ‰¹é‡Pingç»“æœå¼¹çª—æ ·å¼ */\r\n:deep(.ping-result-content) {\r\n  padding: 8px 0;\r\n}\r\n\r\n:deep(.result-header) {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16px;\r\n  margin-bottom: 24px;\r\n  padding: 16px;\r\n  background: linear-gradient(135deg, #f6ffed 0%, #f0f9e8 100%);\r\n  border-radius: 8px;\r\n  border: 1px solid #d9f7be;\r\n}\r\n\r\n:deep(.result-icon.success) {\r\n  font-size: 32px;\r\n  color: #52c41a;\r\n}\r\n\r\n:deep(.result-title) {\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  color: #52c41a;\r\n  margin: 0;\r\n}\r\n\r\n:deep(.result-stats) {\r\n  padding: 0;\r\n}\r\n\r\n:deep(.result-grid) {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: 16px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n:deep(.result-item) {\r\n  text-align: center;\r\n  padding: 16px;\r\n  background: #fafafa;\r\n  border-radius: 8px;\r\n  border: 1px solid #f0f0f0;\r\n}\r\n\r\n:deep(.result-number) {\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n:deep(.result-number.success) {\r\n  color: #52c41a;\r\n}\r\n\r\n:deep(.result-number.error) {\r\n  color: #ff4d4f;\r\n}\r\n\r\n:deep(.result-number.primary) {\r\n  color: #1890ff;\r\n}\r\n\r\n:deep(.result-label) {\r\n  font-size: 12px;\r\n  color: #666;\r\n  text-transform: uppercase;\r\n  font-weight: 500;\r\n}\r\n\r\n:deep(.result-summary) {\r\n  text-align: center;\r\n  padding: 16px;\r\n  background: rgba(82, 196, 26, 0.05);\r\n  border-radius: 6px;\r\n  border: 1px solid rgba(82, 196, 26, 0.2);\r\n}\r\n\r\n/* è¿›åº¦æ¶ˆæ¯ç¾åŒ– */\r\n:deep(.ant-message-custom-content) {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n/* å¼¹çª—æŒ‰é’®ç¾åŒ– */\r\n:deep(.ant-modal-confirm .ant-btn-primary) {\r\n  background: linear-gradient(135deg, #1890ff 0%, #40a9ff 100%);\r\n  border: none;\r\n  box-shadow: 0 2px 8px rgba(24, 144, 255, 0.3);\r\n}\r\n\r\n:deep(.ant-modal-confirm .ant-btn-primary:hover) {\r\n  background: linear-gradient(135deg, #40a9ff 0%, #69c0ff 100%);\r\n  box-shadow: 0 4px 12px rgba(24, 144, 255, 0.4);\r\n}\r\n\r\n/* Zabbixæ¨¡æ¿é€‰æ‹©æŠ½å±‰æ ·å¼ */\r\n.template-drawer-content {\r\n  padding: 0;\r\n}\r\n\r\n.ip-info-card {\r\n  margin-bottom: 24px;\r\n  border-radius: 12px;\r\n  border: 1px solid #e8f3ff;\r\n  background: linear-gradient(135deg, #f0f7ff 0%, #e8f3ff 100%);\r\n  box-shadow: 0 2px 8px rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n.ip-info-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.ip-icon {\r\n  font-size: 24px;\r\n  color: #1890ff;\r\n}\r\n\r\n.ip-details h4 {\r\n  margin: 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: #262626;\r\n}\r\n\r\n.ip-details p {\r\n  margin: 0;\r\n  font-size: 12px;\r\n  color: #8c8c8c;\r\n}\r\n\r\n/* æœç´¢å’Œç­›é€‰åŒºåŸŸ */\r\n.template-search-section {\r\n  margin-bottom: 24px;\r\n  padding: 20px;\r\n  background: #fafafa;\r\n  border-radius: 12px;\r\n  border: 1px solid #f0f0f0;\r\n}\r\n\r\n.search-bar {\r\n  margin-bottom: 20px;\r\n  position: relative;\r\n}\r\n\r\n.search-bar .ant-input-search {\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\r\n}\r\n\r\n.search-bar .ant-input-search:hover {\r\n  box-shadow: 0 4px 12px rgba(24, 144, 255, 0.15);\r\n}\r\n\r\n.search-bar .ant-input-search:focus-within {\r\n  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);\r\n}\r\n\r\n.category-filter {\r\n  margin: 16px 0;\r\n  padding-bottom: 8px;\r\n  border-bottom: 1px solid #f0f0f0;\r\n}\r\n.category-filter-tag {\r\n  margin-bottom: 8px;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n  padding: 8px 12px;\r\n  font-size: 13px;\r\n  border-radius: 8px;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  background: #f5f5f5;\r\n  border: 1px solid #f0f0f0;\r\n}\r\n\r\n.category-filter-tag:hover {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\r\n  background: white;\r\n}\r\n\r\n.category-filter-tag-selected {\r\n  background: #1890ff !important;\r\n  color: white !important;\r\n  border-color: #1890ff !important;\r\n}\r\n\r\n.category-filter-tag-selected .category-count {\r\n  color: rgba(255, 255, 255, 0.8) !important;\r\n}\r\n\r\n.category-filter-tag-selected .category-selected {\r\n  background: white !important;\r\n  color: #1890ff !important;\r\n}\r\n\r\n.category-tag-selected {\r\n  background: #1890ff !important;\r\n  color: white !important;\r\n  border-color: #1890ff !important;\r\n}\r\n\r\n.category-filter-icon {\r\n  font-size: 14px;\r\n}\r\n\r\n.category-count {\r\n  font-weight: 600;\r\n  margin-left: 4px;\r\n}\r\n\r\n.category-selected {\r\n  background: rgba(255, 255, 255, 0.3);\r\n  padding: 2px 6px;\r\n  border-radius: 8px;\r\n  font-size: 10px;\r\n  font-weight: 600;\r\n  margin-left: 4px;\r\n}\r\n\r\n.clear-filter-tag {\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n\r\n/* æ¨¡æ¿åˆ—è¡¨ */\r\n.template-list {\r\n  max-height: calc(100vh - 400px);\r\n  overflow-y: auto;\r\n}\r\n\r\n.empty-templates {\r\n  text-align: center;\r\n  padding: 80px 20px;\r\n  animation: fadeIn 0.3s ease;\r\n}\r\n\r\n.empty-templates .ant-empty {\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.empty-templates .ant-empty-image {\r\n  height: 120px;\r\n}\r\n\r\n.empty-templates .ant-empty-description {\r\n  font-size: 15px;\r\n  color: #666;\r\n}\r\n\r\n.empty-templates .ant-btn {\r\n  margin-top: 16px;\r\n  border-radius: 8px;\r\n}\r\n\r\n.template-loading {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  min-height: 300px;\r\n  padding: 40px;\r\n}\r\n\r\n.template-loading-spinner {\r\n  width: 48px;\r\n  height: 48px;\r\n  border: 4px solid #f0f0f0;\r\n  border-top: 4px solid #1890ff;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n@keyframes fadeIn {\r\n  from { opacity: 0; }\r\n  to { opacity: 1; }\r\n}\r\n\r\n.selected-templates-info {\r\n  margin-bottom: 20px;\r\n  animation: slideDown 0.3s ease-out;\r\n}\r\n\r\n.search-results-info {\r\n  margin: 12px 0;\r\n  padding: 12px 16px;\r\n  background: #f6f6f6;\r\n  border-radius: 8px;\r\n  font-size: 14px;\r\n  color: #666;\r\n  animation: fadeIn 0.3s ease;\r\n}\r\n\r\n.search-results-info strong {\r\n  color: #1890ff;\r\n  font-weight: 600;\r\n}\r\n\r\n@keyframes slideDown {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(-10px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n.template-grid {\r\n  animation: fadeIn 0.5s ease;\r\n}\r\n\r\n.template-card {\r\n  animation: fadeInUp 0.4s ease-out;\r\n  animation-fill-mode: both;\r\n}\r\n\r\n@keyframes fadeInUp {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(10px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n/* åˆ†ç±»æ ·å¼ */\r\n.template-category {\r\n  margin-bottom: 20px;\r\n  border: 1px solid #f0f0f0;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  background: white;\r\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);\r\n}\r\n\r\n.category-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 12px 16px;\r\n  background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);\r\n  border-bottom: 1px solid #f0f0f0;\r\n}\r\n\r\n.category-title-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  flex: 1;\r\n}\r\n\r\n.category-title {\r\n  margin: 0;\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  color: #262626;\r\n}\r\n\r\n.category-icon {\r\n  font-size: 16px;\r\n  color: #1890ff;\r\n}\r\n\r\n.category-stats {\r\n  display: flex;\r\n  gap: 8px;\r\n  align-items: center;\r\n}\r\n\r\n.selected-badge {\r\n  margin-left: 8px;\r\n}\r\n\r\n.expand-button {\r\n  color: #666;\r\n  border: none;\r\n  background: transparent;\r\n}\r\n\r\n.expand-button:hover {\r\n  color: #1890ff;\r\n  background: rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n/* æ¨¡æ¿ç½‘æ ¼ */\r\n.template-grid-wrapper {\r\n  padding: 16px;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n}\r\n\r\n.template-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));\r\n  gap: 12px;\r\n  width: 100%;\r\n  max-width: 100%;\r\n  padding: 0;\r\n  justify-content: start;\r\n}\r\n\r\n.template-card-container {\r\n  position: relative;\r\n}\r\n\r\n.template-checkbox {\r\n  width: 100%;\r\n  margin: 0;\r\n}\r\n\r\n:deep(.template-checkbox .ant-checkbox) {\r\n  position: absolute;\r\n  top: 12px;\r\n  right: 12px;\r\n  z-index: 10;\r\n  background: white;\r\n  border-radius: 50%;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.template-card {\r\n  width: 100%;\r\n  max-width: 260px;\r\n  height: 140px;\r\n  border-radius: 8px;\r\n  border: 1px solid #e8e8e8;\r\n  transition: all 0.2s ease;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n  background: #ffffff;\r\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.template-card:hover {\r\n  border-color: #40a9ff;\r\n  box-shadow: 0 12px 24px rgba(24, 144, 255, 0.25);\r\n  transform: translateY(-6px);\r\n}\r\n\r\n.template-card.selected {\r\n  border-color: #40a9ff;\r\n  background: linear-gradient(135deg, #e6f7ff 0%, #d6f0ff 100%);\r\n  box-shadow: 0 12px 28px rgba(24, 144, 255, 0.35);\r\n  transform: translateY(-6px);\r\n}\r\n\r\n.template-card.selected::after {\r\n  content: '';\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  width: 0;\r\n  height: 0;\r\n  border-style: solid;\r\n  border-width: 0 36px 36px 0;\r\n  border-color: transparent #40a9ff transparent transparent;\r\n}\r\n\r\n.template-card.selected::before {\r\n  content: 'âœ“';\r\n  position: absolute;\r\n  top: 6px;\r\n  right: 6px;\r\n  color: white;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  z-index: 2;\r\n}\r\n\r\n:deep(.template-card .ant-card-head) {\r\n  min-height: auto;\r\n  padding: 12px 16px 8px;\r\n  border-bottom: 1px solid #f0f0f0;\r\n  background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);\r\n}\r\n\r\n:deep(.template-card .ant-card-head-title) {\r\n  padding: 0;\r\n}\r\n\r\n:deep(.template-card .ant-card-body) {\r\n  padding: 12px 16px;\r\n  height: calc(100% - 50px);\r\n  overflow: hidden;\r\n}\r\n\r\n.template-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  width: 100%;\r\n  padding: 8px 10px;\r\n  background: #fafafa;\r\n  border-bottom: 1px solid #e8e8e8;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.template-icon {\r\n  font-size: 14px;\r\n  color: #1890ff;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.template-name {\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  color: #262626;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  flex: 1;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.template-card:hover .template-name {\r\n  color: #40a9ff;\r\n}\r\n\r\n.template-content {\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 8px 10px;\r\n  flex: 1;\r\n}\r\n\r\n.template-description {\r\n  font-size: 12px;\r\n  color: #666;\r\n  line-height: 1.4;\r\n  margin-bottom: 8px;\r\n  flex: 1;\r\n  overflow: hidden;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n}\r\n\r\n.template-stats {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin: 6px 0;\r\n  padding: 6px 8px;\r\n  background: #f8f9fa;\r\n  border-radius: 4px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.stat-item {\r\n  text-align: center;\r\n  flex: 1;\r\n}\r\n\r\n.stat-label {\r\n  display: block;\r\n  font-size: 10px;\r\n  color: #666;\r\n  margin-bottom: 1px;\r\n  font-weight: 400;\r\n}\r\n\r\n.stat-value {\r\n  display: block;\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  color: #1890ff;\r\n}\r\n\r\n.template-groups {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 3px;\r\n  align-items: center;\r\n  margin-top: auto;\r\n  padding-top: 4px;\r\n}\r\n\r\n.template-groups .ant-tag {\r\n  font-size: 9px;\r\n  padding: 1px 4px;\r\n  margin: 0;\r\n  border-radius: 8px;\r\n  background: #e6f7ff;\r\n  border: 1px solid #91d5ff;\r\n  color: #1890ff;\r\n  line-height: 1.2;\r\n}\r\n\r\n.template-groups .ant-tag:hover {\r\n  background: linear-gradient(135deg, #e0e0e0 0%, #d0d0d0 100%);\r\n}\r\n\r\n.more-groups {\r\n  font-size: 10px;\r\n  color: #888;\r\n  font-weight: 500;\r\n  background: #f5f5f5;\r\n  padding: 1px 4px;\r\n  border-radius: 8px;\r\n}\r\n\r\n/* æ¨¡æ¿æŠ½å±‰å“åº”å¼è®¾è®¡ */\r\n@media (max-width: 1400px) {\r\n  .template-grid {\r\n    grid-template-columns: repeat(3, 1fr);\r\n    gap: 14px;\r\n  }\r\n}\r\n\r\n@media (max-width: 1200px) {\r\n  .template-grid {\r\n    grid-template-columns: repeat(2, 1fr);\r\n    gap: 12px;\r\n  }\r\n  \r\n  .template-card {\r\n    height: 140px;\r\n  }\r\n  \r\n  .template-header {\r\n    padding: 10px 10px 5px;\r\n  }\r\n  \r\n  .template-name {\r\n    font-size: 13px;\r\n  }\r\n  \r\n  .template-icon {\r\n    font-size: 14px;\r\n  }\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .template-grid {\r\n    grid-template-columns: 1fr;\r\n    gap: 10px;\r\n  }\r\n  \r\n  .template-grid-wrapper {\r\n    padding: 12px;\r\n  }\r\n  \r\n  .template-card {\r\n    height: 120px;\r\n  }\r\n  \r\n  .template-header {\r\n    padding: 8px 8px 4px;\r\n    gap: 6px;\r\n  }\r\n  \r\n  .template-name {\r\n    font-size: 12px;\r\n  }\r\n  \r\n  .template-icon {\r\n    font-size: 12px;\r\n  }\r\n  \r\n  .template-stats {\r\n    margin: 6px 0;\r\n    padding: 6px 0;\r\n  }\r\n  \r\n  .stat-label {\r\n    font-size: 10px;\r\n  }\r\n  \r\n  .stat-value {\r\n    font-size: 12px;\r\n  }\r\n  \r\n  .template-groups {\r\n    margin-top: 6px;\r\n    padding: 0 8px;\r\n    gap: 3px;\r\n  }\r\n  \r\n  .template-groups .ant-tag {\r\n    font-size: 9px;\r\n    padding: 1px 4px;\r\n  }\r\n  \r\n  .more-groups {\r\n    font-size: 9px;\r\n    padding: 1px 3px;\r\n  }\r\n  \r\n  .category-header {\r\n    padding: 10px 12px;\r\n  }\r\n  \r\n  .category-title {\r\n    font-size: 13px;\r\n  }\r\n  \r\n  .category-icon {\r\n    font-size: 14px;\r\n  }\r\n}\r\n\r\n/* å“åº”å¼è®¾è®¡ */\r\n@media (max-width: 1200px) {\r\n  .template-grid {\r\n    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\r\n  }\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .template-grid {\r\n    grid-template-columns: 1fr;\r\n  }\r\n  \r\n  .category-header {\r\n    padding: 12px 16px;\r\n  }\r\n  \r\n  .template-search-section {\r\n    padding: 16px;\r\n  }\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAmB;;uBAA9BC,mBAAA,CAiFM,OAjFNC,UAiFM,GA9EJC,mBAAA,YAAe,EACfC,YAAA,CAmCEC,MAAA;IAlCCC,UAAU,EAAED,MAAA,CAAAE,MAAM;IAClBC,OAAO,EAAEH,MAAA,CAAAG,OAAO;IAChBC,UAAU,EAAEJ,MAAA,CAAAI,UAAU;IACtBC,eAAe,EAAEL,MAAA,CAAAK,eAAe;IAChCC,aAAa,EAAEN,MAAA,CAAAM,aAAa;IAC5BC,QAAQ,EAAEP,MAAA,CAAAO,QAAQ;IAClBC,MAAM,EAAER,MAAA,CAAAQ,MAAM;IACdC,UAAU,EAAET,MAAA,CAAAU,UAAU,CAACC,KAAK;IAC5BC,WAAW,EAAEZ,MAAA,CAAAU,UAAU,CAACG,MAAM;IAC9BC,cAAc,EAAEd,MAAA,CAAAU,UAAU,CAACK,SAAS;IACpCC,WAAW,EAAEhB,MAAA,CAAAU,UAAU,CAACO,MAAM;IAC9BC,cAAa,EAAElB,MAAA,CAAAkB,cAAc;IAC7BC,WAAU,EAAEnB,MAAA,CAAAmB,WAAW;IACvBC,aAAY,EAAEpB,MAAA,CAAAqB,iBAAiB;IAC/BC,MAAI,EAAEtB,MAAA,CAAAuB,UAAU;IAChBC,MAAI,EAAExB,MAAA,CAAAyB,UAAU;IAChBC,QAAM,EAAE1B,MAAA,CAAA2B,YAAY;IACpBC,MAAI,EAAE5B,MAAA,CAAA6B,UAAU;IAChBC,kBAAiB,EAAE9B,MAAA,CAAA+B,sBAAsB;IACzCC,aAAY,EAAEhC,MAAA,CAAAiC,iBAAiB;IAC/BC,uBAAuB,EAAElC,MAAA,CAAAmC,2BAA2B;IACpDC,gBAAe,EAAEpC,MAAA,CAAAqC,cAAc;IAC/BC,KAAG,EAAEtC,MAAA,CAAAuC,SAAS;IACdC,MAAI,EAAExC,MAAA,CAAAyC,UAAU;IAChBC,QAAM,EAAE1C,MAAA,CAAA2C,YAAY;IACpBC,iBAAiB,EAAE5C,MAAA,CAAA6C,eAAe;IAClCC,gBAAe,EAAE9C,MAAA,CAAA+C,oBAAoB;IACrCC,QAAM,EAAEhD,MAAA,CAAAiD,YAAY;IACpBC,OAAK,EAAElD,MAAA,CAAAmD,WAAW;IAClBC,aAAY,EAAEpD,MAAA,CAAAqD,iBAAiB;IAC/BC,cAAa,EAAEtD,MAAA,CAAAuD,kBAAkB;IACjCC,YAAW,EAAExD,MAAA,CAAAyD,gBAAgB;IAC7BC,aAAa,EAAE1D,MAAA,CAAA0D,aAAa;IAC5BC,uBAAuB,EAAE3D,MAAA,CAAA2D;wOAG5B7D,mBAAA,YAAe,EACfC,YAAA,CAkBEC,MAAA;IAjBC4D,UAAU,EAAE5D,MAAA,CAAA4D,UAAU;IACtBC,kBAAkB,EAAE7D,MAAA,CAAA6D,kBAAkB;IACtCC,gBAAgB,EAAE9D,MAAA,CAAA8D,gBAAgB;IAClCC,cAAc,EAAE/D,MAAA,CAAA+D,cAAc;IAC9BC,sBAAsB,EAAEhE,MAAA,CAAAgE,sBAAsB;IAC9CC,YAAY,EAAEjE,MAAA,CAAAiE,YAAY;IAC1BC,SAAS,EAAElE,MAAA,CAAAkE,SAAS;IACpBC,YAAY,EAAEnE,MAAA,CAAAmE,YAAY;IAC1BC,WAAW,EAAEpE,MAAA,CAAAoE,WAAW;IACxBC,aAAa,EAAErE,MAAA,CAAAqE,aAAa;IAC5BC,aAAa,EAAEtE,MAAA,CAAAsE,aAAa;IAC5BC,kBAAkB,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEzE,MAAA,CAAA6D,kBAAkB;IACtCa,gBAAgB,EAAE1E,MAAA,CAAA2E,gBAAgB;IAClCC,aAAY,EAAE5E,MAAA,CAAA6E,iBAAiB;IAC/BC,gBAAgB,EAAE9E,MAAA,CAAA+E,mBAAmB;IACrCC,gBAAgB,EAAEhF,MAAA,CAAAiF,kBAAkB;IACpCC,iBAAiB,EAAAV,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEzE,MAAA,CAAAgE,sBAAsB;iMAa5ClE,mBAAA,cAAiB,EACjBC,YAAA,CAOEC,MAAA;IANQmF,OAAO,EAAEnF,MAAA,CAAAoF,qBAAqB;4DAArBpF,MAAA,CAAAoF,qBAAqB,GAAAX,MAAA;IAC9BY,mBAAmB,EAAErF,MAAA,CAAAqF,mBAAmB;wEAAnBrF,MAAA,CAAAqF,mBAAmB,GAAAZ,MAAA;IAC/CtE,OAAO,EAAEH,MAAA,CAAAsF,eAAe;IACxB1B,UAAU,EAAE5D,MAAA,CAAA4D,UAAU;IACtB2B,SAAO,EAAEvF,MAAA,CAAAwF,sBAAsB;IAC/BC,OAAK,EAAEzF,MAAA,CAAA0F","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}